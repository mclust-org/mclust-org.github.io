<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Variable Selection for Gaussian Model-Based Clustering — clustvarsel • clustvarsel</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Variable Selection for Gaussian Model-Based Clustering — clustvarsel"><meta name="description" content="A function which implements variable selection methodology for model-based clustering which allows to find the (locally) optimal subset of variables in a dataset that have group/cluster information.
A greedy or headlong search can be used, either in a forward-backward or backward-forward direction, with or without sub-sampling at the hierarchical clustering stage for starting  mclust models. By default the algorithm uses a sequential search, but parallelisation is also available."><meta property="og:description" content="A function which implements variable selection methodology for model-based clustering which allows to find the (locally) optimal subset of variables in a dataset that have group/cluster information.
A greedy or headlong search can be used, either in a forward-backward or backward-forward direction, with or without sub-sampling at the hierarchical clustering stage for starting  mclust models. By default the algorithm uses a sequential search, but parallelisation is also available."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clustvarsel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/clustvarsel.html">Vignette</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://mclust-org.github.io"><span class="fa fa-home"></span> mclust-org</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Variable Selection for Gaussian Model-Based Clustering</h1>

      <div class="d-none name"><code>clustvarsel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function which implements variable selection methodology for model-based clustering which allows to find the (locally) optimal subset of variables in a dataset that have group/cluster information.
A greedy or headlong search can be used, either in a forward-backward or backward-forward direction, with or without sub-sampling at the hierarchical clustering stage for starting  <code><a href="https://mclust-org.github.io/mclust/reference/mclust-package.html" class="external-link">mclust</a></code> models. By default the algorithm uses a sequential search, but parallelisation is also available.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">clustvarsel</span><span class="op">(</span><span class="va">data</span>, </span>
<span>            G <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, </span>
<span>            search <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"greedy"</span>, <span class="st">"headlong"</span><span class="op">)</span>,</span>
<span>            direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forward"</span>, <span class="st">"backward"</span><span class="op">)</span>,</span>
<span>            emModels1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"V"</span><span class="op">)</span>, </span>
<span>            emModels2 <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"emModelNames"</span><span class="op">)</span>,</span>
<span>            samp <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            sampsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>            hcModel <span class="op">=</span> <span class="st">"VVV"</span>, </span>
<span>            allow.EEE <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            forcetwo <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            BIC.diff <span class="op">=</span> <span class="fl">0</span>, </span>
<span>            BIC.upper <span class="op">=</span> <span class="fl">0</span>, </span>
<span>            BIC.lower <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, </span>
<span>            itermax <span class="op">=</span> <span class="fl">100</span>, </span>
<span>            parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            fit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>



<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A numeric matrix or data frame where rows correspond to observations and columns correspond to variables. Categorical variables are not allowed.</p></dd>


<dt id="arg-g">G<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>An integer vector specifying the numbers of mixture components (clusters) for which the BIC is to be calculated. The default is <code>G = 1:9</code>.</p></dd>


<dt id="arg-search">search<a class="anchor" aria-label="anchor" href="#arg-search"></a></dt>
<dd><p>A character vector indicating whether a <code>"greedy"</code> or, potentially quicker but less optimal, <code>"headlong"</code> algorithm is to be used in the search for clustering variables.</p></dd>


<dt id="arg-direction">direction<a class="anchor" aria-label="anchor" href="#arg-direction"></a></dt>
<dd><p>A character vector indicating the type of search: <code>"forward"</code> starts from the empty model and at each step of the algorithm adds/removes a variable until the stopping criterion is satisfied; <code>"backward"</code> starts from the model with all the available variables and at each step of the algorithm removes/adds a variable until the stopping criterion is satisfied.</p></dd>


<dt id="arg-emmodels-">emModels1<a class="anchor" aria-label="anchor" href="#arg-emmodels-"></a></dt>
<dd><p>A vector of character strings indicating the models to be fitted in the EM phase of univariate clustering. Possible models are <code>"E"</code> and <code>"V"</code>, described in <code><a href="https://mclust-org.github.io/mclust/reference/mclustModelNames.html" class="external-link">mclustModelNames</a></code>.</p></dd>


<dt id="arg-emmodels-">emModels2<a class="anchor" aria-label="anchor" href="#arg-emmodels-"></a></dt>
<dd><p>A vector of character strings indicating the models to be fitted in the EM phase of multivariate clustering. Possible models are those described in <code><a href="https://mclust-org.github.io/mclust/reference/mclustModelNames.html" class="external-link">mclustModelNames</a></code>.</p></dd>


<dt id="arg-samp">samp<a class="anchor" aria-label="anchor" href="#arg-samp"></a></dt>
<dd><p>A logical value indicating whether or not a subset of observations is to be used in the hierarchical clustering phase used to get starting values for the EM algorithm.</p></dd>


<dt id="arg-sampsize">sampsize<a class="anchor" aria-label="anchor" href="#arg-sampsize"></a></dt>
<dd><p>The number of observations to be used in the hierarchical clustering subset. By default, a random sample of approximately half of the sample size is used.</p></dd>


<dt id="arg-hcmodel">hcModel<a class="anchor" aria-label="anchor" href="#arg-hcmodel"></a></dt>
<dd><p>A character string specifying the model to be used in hierarchical clustering for choosing the starting values used by the EM algorithm. By default, the <code>"VVV"</code> covariance structure is used (see <code><a href="https://mclust-org.github.io/mclust/reference/hc.html" class="external-link">hc</a></code>).</p></dd>


<dt id="arg-allow-eee">allow.EEE<a class="anchor" aria-label="anchor" href="#arg-allow-eee"></a></dt>
<dd><p>A logical value indicating whether a new clustering will be run with equal within-cluster covariance for hierarchical clustering to get starting values, if the clusterings with variable within-cluster covariance for hierarchical clustering do not produce any viable BIC values.</p></dd>


<dt id="arg-forcetwo">forcetwo<a class="anchor" aria-label="anchor" href="#arg-forcetwo"></a></dt>
<dd><p>A logical value indicating whether at least two variables will be forced to be selected initially, regardless of whether BIC evidence suggests bivariate clustering or not.</p></dd>


<dt id="arg-bic-diff">BIC.diff<a class="anchor" aria-label="anchor" href="#arg-bic-diff"></a></dt>
<dd><p>A numerical value indicating the minimum BIC difference between clustering and no clustering used to accept the inclusion of a variable in the set of clustering variables in a forward step of the greedy search algorithm. Furthermore, minus <code>BIC.diff</code> is used to accept the exclusion of a selected variable from the set of clustering variable in a backward step of the greedy search algorithm. Default is 0.</p></dd>


<dt id="arg-bic-upper">BIC.upper<a class="anchor" aria-label="anchor" href="#arg-bic-upper"></a></dt>
<dd><p>A numerical value indicating the minimum BIC difference between clustering and no clustering used to select a clustering variable in the headlong search. Default is 0.</p></dd>


<dt id="arg-bic-lower">BIC.lower<a class="anchor" aria-label="anchor" href="#arg-bic-lower"></a></dt>
<dd><p>A numerical value indicating the level of BIC difference between clustering and no clustering below which a variable will be removed from consideration in the headlong algorithm. Default is -10.</p></dd>


<dt id="arg-itermax">itermax<a class="anchor" aria-label="anchor" href="#arg-itermax"></a></dt>
<dd><p>An integer value giving the maximum number of iterations (of addition and removal steps) the selected algorithm is allowed to run for.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>An optional argument which allows to specify if the selected <code>"greedy"</code> algorithm should be run sequentially or in parallel.</p>
<p>For a single machine with multiple cores, possible values are:</p><ul><li><p>a logical value specifying if parallel computing should be used (<code>TRUE</code>) or not (<code>FALSE</code>, default) for running the algorithm;</p></li>
<li><p>a numerical value which gives the number of cores to employ. By default, this is obtained from the function <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></code>;</p></li>
<li><p>a character string specifying the type of parallelisation to use. This depends on system OS: on Windows OS only <code>"snow"</code> type functionality is available, while on Unix/Linux/Mac OSX both <code>"snow"</code> and <code>"multicore"</code> (default) functionalities are available.</p></li>
</ul><p>In all the cases described above, at the end of the search the cluster is automatically stopped by shutting down the workers.</p>
<p>If a cluster of multiple machines is available, the algorithm can be run in parallel using all, or a subset of, the cores available to the machines belonging to the cluster. However, this option requires more work from the user, who needs to set up and register a parallel back end.
In this case, the cluster must be explicitly stopped with <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></code>.</p></dd>


<dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>A logical specifying if the model with the selected "best" subset should be fitted at the end of the procedure. By default is set to <code>TRUE</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical indicating if info must be provided at each step of the algorithm. By default is set to <code>TRUE</code> during interactive sessions, and <code>FALSE</code> otherwise.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function implements variable selection methodology for model-based clustering.
The selection methods available are <code>"greedy"</code> search and <code>"headlong"</code> search (see argument <code>search</code>).
The <em>greedy search</em> at each step either checks all the variables not currently included in the set of clustering variables singly for inclusion into the set, or checks all variables in the set of clustering variables singly for exclusion.
The <em>headlong search</em> only checks until a variable is included or excluded (i.e., does not necessarily check all possible variables for inclusion/exclusion at each step) and any variable with evidence of clustering below a certain level at any stage is removed from consideration for the remainder of the algorithm.
Greedy search can be performed <em>forward-backward</em> starting from the empty model, or <em>backward-forward</em> starting from the model with all the variables included (see argument <code>direction</code>). Currently, headlong search can only run <em>forward-backward</em>.
<!-- % Both greedy and headlong searches can be performed forward-backward starting from the empty model, or backward-forward from the model with all the variables included (see argument \code{direction}).  --></p>
<p>The criterion to assess each variable's evidence for being useful to the clustering is given by the difference between the BIC for the clustering model using the set of clustering variables already included and the variable being checked, and the sum of BICs for the model with clustering using the set of already selected clustering variables without the variable being checked and the model for the variable being checked being conditionally independent of the clustering given the other clustering variables. The latter is modeled as a regression of the variable being checked on the other clustering variables. A subset selection procedure is also performed on the regression step.</p>
<p>Clustering models are fitted using <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></code>, where each model is allowed to vary over the specified number of components <code>G</code> and any of the different covariance parameterisations set in <code>emModels1</code> and <code>emModels2</code>.</p>
<p>The default value for <code>forcetwo</code> is <code>TRUE</code> because often in practice there will be little evidence of clustering on the univariate or bivariate level although there is multivariate clustering present and these variables are used as starting points to attempt to find this clustering, if necessary being removed later in the algorithm.</p>
<p>The default value for <code>allow.EEE</code> is <code>TRUE</code> but if necessary to speed up the algorithm it can be set to <code>FALSE</code>. Other speeding-up restrictions include reducing the <code>emModels1</code> (to <code>"E"</code>, say) and the <code>emModels2</code> to a smaller set of covariance parameterisations.
Reducing the maximum possible number of clusters present in the data will also increase the speed of the algorithm.
Another time-saving device is the <code>samp</code> option which uses the same algorithm but uses only a subset of the observations in the expensive hierarchical phase for initialisation of EM algorithm in <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></code>.
Finally, the headlong search may be quicker than the greedy search option in data sets with large numbers of variables (depending on the values of the upper and lower bounds chosen for the BIC difference).</p>
<p>The defaults for the <code>eps</code>, <code>tol</code> and <code>itmax</code> options for the Mclust
steps run in the algorithm can be changed by using the <code><a href="https://mclust-org.github.io/mclust/reference/mclust.options.html" class="external-link">mclust.options</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>'clustvarsel'</code> with the following components:</p>
<dl><dt>variables</dt>
<dd><p>The name of input variables.</p></dd>


<dt>subset</dt>
<dd><p>A vector of values specifying for the selected variables the columns position in the input data.frame or matrix.</p></dd>


<dt>steps.info</dt>
<dd><p>A matrix with a row for each step of the algorithm providing:<br></p>
<ul><li><p>the name of the variable proposed;</p></li>
<li><p>the BIC of the clustering variables' model at the end of the step;</p></li>
<li><p>the BIC difference between clustering and not clustering for the variable;</p></li>
<li><p>the type of step (Add/Remove);</p></li>
<li><p>the decision for the proposed step (Accepted/Rejected).</p></li>
</ul></dd>


<dt>search</dt>
<dd><p>A string specifying the type of search employed.</p></dd>


<dt>direction</dt>
<dd><p>A string specifying the direction of search employed.</p></dd>


<dt>model</dt>
<dd><p>If input argument <code>fit = TRUE</code>, a <code>'Mclust'</code> object containing the final model fitted on the "best" subset selected.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Raftery, A. E. and Dean, N. (2006) Variable Selection for Model-Based Clustering. <em>Journal of the American Statistical Association</em>, 101(473), 168-178.</p>
<p>Badsberg, J. H. (1992) Model search in contingency tables by CoCo. In Dodge, Y. and Whittaker, J. (Eds.), <em>Computational Statistics</em>, Volume 1, pp. 251-256</p>
<p>Maugis, C., Celeux, G., Martin-Magniette M. (2009) Variable Selection for Clustering With Gaussian Mixture Models. <em>Biometrics</em>, 65(3), 701-709.</p>
<p>Scrucca, L. and Raftery, A. E. (2018) clustvarsel: A Package Implementing Variable Selection for Gaussian Model-based Clustering in R. <em>Journal of Statistical Software</em>, 84(1), pp. 1-28.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>N. Dean, A. E. Raftery, and L. Scrucca</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate data with 2 clusters in the first two variables and no </span></span></span>
<span class="r-in"><span><span class="co"># clustering in the rest. Clusters have mixing proportion pro, means </span></span></span>
<span class="r-in"><span><span class="co"># mu1 and mu2 and variances sigma1 and sigma2</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: MASS</span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">pro</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">mu1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="fl">1.5</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, sep <span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># generate the clustering variables</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">u</span> <span class="op">&lt;</span> <span class="va">pro</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[</span><span class="va">u</span> <span class="op">&lt;</span> <span class="va">pro</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span> <span class="op">&lt;</span> <span class="va">pro</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">mu1</span>, Sigma <span class="op">=</span> <span class="va">sigma1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[</span><span class="va">u</span> <span class="op">&gt;=</span> <span class="va">pro</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span> <span class="op">&gt;=</span> <span class="va">pro</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">mu2</span>, Sigma <span class="op">=</span> <span class="va">sigma2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># generate the non-clustering variables</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">1.5</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot the data</span></span></span>
<span class="r-in"><span><span class="fu">clPairs</span><span class="op">(</span><span class="va">X</span>, <span class="va">Class</span>, gap <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="clustvarsel-1.png" alt="" width="504" height="432"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sequential forward greedy search (default)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">clustvarsel</span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variable selection for Gaussian model-based clustering</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stepwise (forward/backward) greedy search</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Variable proposed Type of step   BICclust Model G   BICdiff Decision</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 X2          Add  -836.4149     E 2  15.29468 Accepted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 X1          Add -1490.1021   VEV 2  79.36803 Accepted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 X5          Add -2085.4979   VII 3 -12.56056 Rejected</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 X1       Remove  -812.2814     V 4  55.23453 Rejected</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selected subset: X2, X1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gaussian finite mixture model fitted by EM algorithm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mclust VEV (ellipsoidal, equal shape) model with 2 components: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  log-likelihood   n df       BIC       ICL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -718.5595 200 10 -1490.102 -1501.624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  93 107 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Class</span>, <span class="va">out</span><span class="op">$</span><span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class   1   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1  93   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2   0 104</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># sequential backward greedy search</span></span></span>
<span class="r-in"><span><span class="fu">clustvarsel</span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, direction <span class="op">=</span> <span class="st">"backward"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sequential backward greedy search with subsampling at hierarchical </span></span></span>
<span class="r-in"><span><span class="co"># intialisation stage</span></span></span>
<span class="r-in"><span><span class="fu">clustvarsel</span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, direction <span class="op">=</span> <span class="st">"backward"</span>, </span></span>
<span class="r-in"><span>            samp <span class="op">=</span> <span class="cn">TRUE</span>, sampsize <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># parallel backward greedy search </span></span></span>
<span class="r-in"><span><span class="fu">clustvarsel</span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, direction <span class="op">=</span> <span class="st">"backward"</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># headlong search </span></span></span>
<span class="r-in"><span><span class="fu">clustvarsel</span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, search <span class="op">=</span> <span class="st">"headlong"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nema Dean, Adrian E. Raftery, <a href="https://luca-scr.github.io/" class="external-link">Luca Scrucca</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

