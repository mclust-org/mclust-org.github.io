<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A quick tour of clustvarsel â€¢ clustvarsel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A quick tour of clustvarsel">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clustvarsel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/clustvarsel.html">Vignette</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://mclust-org.github.io"><span class="fa fa-home"></span> mclust-org</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>A quick tour of clustvarsel</h1>
                        <h4 data-toc-skip class="author">Luca
Scrucca</h4>
            
            <h4 data-toc-skip class="date">02 Apr 2025</h4>
      

      <div class="d-none name"><code>clustvarsel.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <strong>clustvarsel</strong> package implements variable
selection methodology for Gaussian model-based clustering which allows
to find the (locally) optimal subset of variables in a dataset that have
group/cluster information. A greedy or headlong search can be used,
either in a forward-backward or backward-forward direction, with or
without sub-sampling at the hierarchical clustering stage for starting
<strong>mclust</strong> models. By default the algorithm uses a
sequential search, but parallelisation is also available.</p>
<p>This document gives a quick tour of <strong>clustvarsel</strong>
(version 2.3.5) functionalities. It was written in R Markdown, using the
<a href="https://cran.r-project.org/package=knitr" class="external-link">knitr</a> package for
production. See <code><a href="https://rdrr.io/pkg/clustvarsel/man" class="external-link">help(package="clustvarsel")</a></code> for further
details and references provided by
<code>citation("clustvarsel")</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mclust-org.github.io/mclust/" class="external-link">mclust</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">clustvarsel</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulated-clustering-data-example">Simulated clustering data example<a class="anchor" aria-label="anchor" href="#simulated-clustering-data-example"></a>
</h2>
<p>In this example we simulate a dataset on five dimensions with only
the first two variables contain clustering information, the third being
highly correlated with the first one, and the remaining features which
are simply noise variables.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span>      <span class="co"># sample size</span></span>
<span><span class="va">pro</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>    <span class="co"># mixing proportion</span></span>
<span><span class="va">mu1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span> <span class="co"># mean vector for the first cluster</span></span>
<span><span class="va">mu2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span> <span class="co"># mean vector for the second cluster</span></span>
<span><span class="va">sigma1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>       <span class="co"># covar matrix for the first cluster</span></span>
<span><span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="fl">1.5</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span> <span class="co"># covar matrix for the second cluster</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span>, <span class="fl">5</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span> <span class="co"># for replication</span></span>
<span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">Class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">u</span> <span class="op">&lt;</span> <span class="va">pro</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">X</span><span class="op">[</span><span class="va">u</span> <span class="op">&lt;</span> <span class="va">pro</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span> <span class="op">&lt;</span> <span class="va">pro</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">mu1</span>, Sigma <span class="op">=</span> <span class="va">sigma1</span><span class="op">)</span></span>
<span><span class="va">X</span><span class="op">[</span><span class="va">u</span> <span class="op">&gt;=</span> <span class="va">pro</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span> <span class="op">&gt;=</span> <span class="va">pro</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">mu2</span>, Sigma <span class="op">=</span> <span class="va">sigma2</span><span class="op">)</span></span>
<span><span class="va">X</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">X</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">1.5</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">X</span><span class="op">[</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clPairs.html" class="external-link">clPairs</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Class</span><span class="op">)</span></span></code></pre></div>
<p><img src="clustvarsel_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustvarsel.html">clustvarsel</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co">## iter 1</span></span>
<span><span class="co">## + adding step</span></span>
<span><span class="co">##   Var  BICdiff Step Decision</span></span>
<span><span class="co">## 1  X2 11.17931  Add Accepted</span></span>
<span><span class="co">## iter 2</span></span>
<span><span class="co">## + adding step</span></span>
<span><span class="co">##   Var BICdiff Step Decision</span></span>
<span><span class="co">## 2  X1 85.1953  Add Accepted</span></span>
<span><span class="co">## iter 3 </span></span>
<span><span class="co">## + adding step</span></span>
<span><span class="co">## - removing step</span></span>
<span><span class="co">##   Var   BICdiff   Step Decision</span></span>
<span><span class="co">## 3  X3 -14.91130    Add Rejected</span></span>
<span><span class="co">## 4  X1  85.19104 Remove Rejected</span></span>
<span><span class="co">## final iter</span></span>
<span><span class="co">## * fitting model on selected subset</span></span>
<span></span>
<span><span class="va">out</span></span>
<span><span class="co">## ------------------------------------------------------ </span></span>
<span><span class="co">## Variable selection for Gaussian model-based clustering</span></span>
<span><span class="co">## Stepwise (forward/backward) greedy search</span></span>
<span><span class="co">## ------------------------------------------------------ </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Variable proposed Type of step   BICclust Model G   BICdiff Decision</span></span>
<span><span class="co">##                 X2          Add  -822.6398     E 2  11.17931 Accepted</span></span>
<span><span class="co">##                 X1          Add -1482.8408   VEV 2  85.19530 Accepted</span></span>
<span><span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span></span>
<span><span class="co">##                 X1       Remove  -822.6355     E 2  85.19104 Rejected</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Selected subset: X2, X1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VEV (ellipsoidal, equal shape) model with 2 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log.likelihood   n df       BIC       ICL</span></span>
<span><span class="co">##       -714.9288 200 10 -1482.841 -1493.898</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1   2 </span></span>
<span><span class="co">##  99 101 </span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustvarsel.html">clustvarsel</a></span><span class="op">(</span><span class="va">X</span>, direction <span class="op">=</span> <span class="st">"backward"</span>, fit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## iter 1 </span></span>
<span><span class="co">## - removing step</span></span>
<span><span class="co">##   Var   BICdiff   Step Decision</span></span>
<span><span class="co">## 1  X3 -38.09195 Remove Accepted</span></span>
<span><span class="co">## iter 2 </span></span>
<span><span class="co">## - removing step</span></span>
<span><span class="co">##   Var   BICdiff   Step Decision</span></span>
<span><span class="co">## 2  X4 -23.50212 Remove Accepted</span></span>
<span><span class="co">## iter 3 </span></span>
<span><span class="co">## - removing step</span></span>
<span><span class="co">## + adding step</span></span>
<span><span class="co">##   Var   BICdiff   Step Decision</span></span>
<span><span class="co">## 3  X5 -16.25831 Remove Accepted</span></span>
<span><span class="co">## 4  X3 -14.91130    Add Rejected</span></span>
<span><span class="co">## iter 4 </span></span>
<span><span class="co">## - removing step</span></span>
<span><span class="co">## + adding step</span></span>
<span><span class="co">##   Var   BICdiff   Step Decision</span></span>
<span><span class="co">## 5  X1  95.55735 Remove Rejected</span></span>
<span><span class="co">## 6  X3 -14.91130    Add Rejected</span></span>
<span></span>
<span><span class="va">out</span></span>
<span><span class="co">## ------------------------------------------------------ </span></span>
<span><span class="co">## Variable selection for Gaussian model-based clustering</span></span>
<span><span class="co">## Stepwise (backward/forward) greedy search</span></span>
<span><span class="co">## ------------------------------------------------------ </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Variable proposed Type of step   BICclust Model G   BICdiff Decision</span></span>
<span><span class="co">##                 X3       Remove -2925.4851   EVE 2 -38.09195 Accepted</span></span>
<span><span class="co">##                 X4       Remove -2067.0668   EVE 2 -23.50212 Accepted</span></span>
<span><span class="co">##                 X5       Remove -1482.8408   VEV 2 -16.25831 Accepted</span></span>
<span><span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span></span>
<span><span class="co">##                 X1       Remove  -833.0019     V 2  95.55735 Rejected</span></span>
<span><span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Selected subset: X1, X2</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustvarsel.html">clustvarsel</a></span><span class="op">(</span><span class="va">X</span>, search <span class="op">=</span> <span class="st">"headlong"</span><span class="op">)</span></span>
<span><span class="co">## iter 1</span></span>
<span><span class="co">## + adding step</span></span>
<span><span class="co">##   Var  BICdiff Step Decision</span></span>
<span><span class="co">## 1  X2 11.17931  Add Accepted</span></span>
<span><span class="co">## iter 2</span></span>
<span><span class="co">## + adding step</span></span>
<span><span class="co">##   Var BICdiff Step Decision</span></span>
<span><span class="co">## 2  X1 85.1953  Add Accepted</span></span>
<span><span class="co">## iter 3 </span></span>
<span><span class="co">## + adding step</span></span>
<span><span class="co">## - removing step</span></span>
<span><span class="co">##   Var  BICdiff   Step Decision</span></span>
<span><span class="co">## 3  X3 -14.9113    Add Rejected</span></span>
<span><span class="co">## 4  X1  85.1953 Remove Rejected</span></span>
<span><span class="co">## final iter</span></span>
<span><span class="co">## * fitting model on selected subset</span></span>
<span></span>
<span><span class="va">out</span></span>
<span><span class="co">## ------------------------------------------------------ </span></span>
<span><span class="co">## Variable selection for Gaussian model-based clustering</span></span>
<span><span class="co">## Headlong (forward/backward) search</span></span>
<span><span class="co">## ------------------------------------------------------ </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Variable proposed Type of step   BICclust Model G   BICdiff Decision</span></span>
<span><span class="co">##                 X2          Add  -822.6398     E 2  11.17931 Accepted</span></span>
<span><span class="co">##                 X1          Add -1482.8408   VEV 2  85.19530 Accepted</span></span>
<span><span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span></span>
<span><span class="co">##                 X1       Remove  -822.6398     E 2  85.19530 Rejected</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Selected subset: X2, X1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulated-no-clustering-data-example">Simulated no-clustering data example<a class="anchor" aria-label="anchor" href="#simulated-no-clustering-data-example"></a>
</h2>
<p>In this example we simulate a dataset on ten dimensions with no
clustering. It is shown that model-based clustering on all the variables
yield the wrong conclusion that 2 clusters are present, but after subset
selection the Gaussian finite mixture model correctly select a single
cluster solution.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">p</span><span class="op">)</span></span>
<span><span class="va">sigma1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="fl">1.5</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/bdiag.html" class="external-link">bdiag</a></span><span class="op">(</span><span class="va">sigma1</span>, <span class="va">sigma2</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clPairs.html" class="external-link">clPairs</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code></pre></div>
<p><img src="clustvarsel_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Model-based clustering on all the available variables:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##              EII,2       VII,2       EII,3</span></span>
<span><span class="co">## BIC      -5899.073 -5901.88582 -5922.53452</span></span>
<span><span class="co">## BIC diff     0.000    -2.81261   -23.46131</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">## ----------------------------------------------------</span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ----------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust EII (spherical, equal volume) model with 2 components:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log.likelihood   n df       BIC       ICL</span></span>
<span><span class="co">##       -2891.255 200 22 -5899.073 -5953.953</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1   2 </span></span>
<span><span class="co">##  90 110</span></span></code></pre></div>
<p>Subset selection using forward/backward greedy algorithm:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustvarsel.html">clustvarsel</a></span><span class="op">(</span><span class="va">X</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------ </span></span>
<span><span class="co">## Variable selection for Gaussian model-based clustering</span></span>
<span><span class="co">## Stepwise (forward/backward) greedy search</span></span>
<span><span class="co">## ------------------------------------------------------ </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Variable proposed Type of step   BICclust Model G    BICdiff Decision</span></span>
<span><span class="co">##                 X3          Add  -666.9232     E 2 -4.8472740 Accepted</span></span>
<span><span class="co">##                 X7          Add -1242.8998   EII 2  1.5678544 Accepted</span></span>
<span><span class="co">##                X10          Add -1814.8848   EII 2  1.5172709 Accepted</span></span>
<span><span class="co">##                X10       Remove -1242.8998   EII 2  1.5172709 Rejected</span></span>
<span><span class="co">##                 X6          Add -2390.3224   EII 2  0.6539224 Accepted</span></span>
<span><span class="co">##                 X6       Remove -1814.8848   EII 2  0.6539224 Rejected</span></span>
<span><span class="co">##                 X2          Add -2942.2744   EII 2  0.1214452 Accepted</span></span>
<span><span class="co">##                 X2       Remove -2390.3224   EII 2  0.1214452 Rejected</span></span>
<span><span class="co">##                 X8          Add -3495.9758   EII 2  0.1104619 Accepted</span></span>
<span><span class="co">##                 X8       Remove -2942.2744   EII 2  0.1104619 Rejected</span></span>
<span><span class="co">##                 X9          Add -4081.9212   EII 2 -2.0296117 Rejected</span></span>
<span><span class="co">##                 X8       Remove -2942.2744   EII 2  0.1104619 Rejected</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Selected subset: X3, X7, X10, X6, X2, X8</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out1</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="co"># mod1 &lt;- Mclust(X[,out1$subset])</span></span>
<span><span class="co"># summary(mod1)</span></span>
<span><span class="co">## ----------------------------------------------------</span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ----------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust XII (spherical multivariate normal) model with 1 component:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log.likelihood   n df       BIC       ICL</span></span>
<span><span class="co">##       -1727.188 200  7 -3491.465 -3491.465</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1 </span></span>
<span><span class="co">## 200</span></span></code></pre></div>
<p>Note that the final clustering model shown in the
<code><a href="../reference/clustvarsel.html">clustvarsel()</a></code> output is EII with 2 mixture components.
However, this model has been constrained to have G
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>â‰¥</mo><annotation encoding="application/x-tex">\ge</annotation></semantics></math>
2 components because it must be a clustering model. When the final model
is fitted on the selected variables without imposing the constraint on
G, the BIC correctly indicates a single component model.</p>
<p>Subset selection using backward/forward greedy algorithm:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustvarsel.html">clustvarsel</a></span><span class="op">(</span><span class="va">X</span>, direction <span class="op">=</span> <span class="st">"backward"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------ </span></span>
<span><span class="co">## Variable selection for Gaussian model-based clustering</span></span>
<span><span class="co">## Stepwise (backward/forward) greedy search</span></span>
<span><span class="co">## ------------------------------------------------------ </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Variable proposed Type of step  BICclust Model G     BICdiff Decision</span></span>
<span><span class="co">##                 X2       Remove -5346.204   EII 2 -48.0289667 Accepted</span></span>
<span><span class="co">##                 X4       Remove -4696.525   EII 2  -7.1909995 Accepted</span></span>
<span><span class="co">##                 X3       Remove -4032.114   EII 2  -2.3352781 Accepted</span></span>
<span><span class="co">##                 X3          Add -4696.525   EII 2  -2.3352781 Rejected</span></span>
<span><span class="co">##                 X7       Remove -3453.786   EII 2  -1.1967844 Accepted</span></span>
<span><span class="co">##                 X7          Add -4032.114   EII 2  -1.1967844 Rejected</span></span>
<span><span class="co">##                 X8       Remove -2899.545   EII 2  -0.4288443 Accepted</span></span>
<span><span class="co">##                 X8          Add -3453.786   EII 2  -0.4288443 Rejected</span></span>
<span><span class="co">##                 X5       Remove -2308.785   EII 2   1.0712786 Rejected</span></span>
<span><span class="co">##                 X8          Add -3453.786   EII 2  -0.4288443 Rejected</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Selected subset: X1, X5, X6, X9, X10</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out2</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">## ----------------------------------------------------</span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ----------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust XII (spherical multivariate normal) model with 1 component:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log.likelihood   n df       BIC       ICL</span></span>
<span><span class="co">##       -1424.072 200  6 -2879.934 -2879.934</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1 </span></span>
<span><span class="co">## 200</span></span></code></pre></div>
<p>Although the selected subset of variables is different from that
obtained using forward greedy search, the same comments outlined
previously apply here too.</p>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Raftery, A. E. and Dean, N. (2006) Variable Selection for Model-Based
Clustering. <em>Journal of the American Statistical Association</em>,
101(473), 168-178.</p>
<p>Maugis, C., Celeux, G., Martin-Magniette M. (2009) Variable Selection
for Clustering With Gaussian Mixture Models. <em>Biometrics</em>, 65(3),
701-709.</p>
<p>Scrucca, L. and Raftery, A. E. (2018) clustvarsel: A Package
Implementing Variable Selection for Gaussian Model-based Clustering in
R. <em>Journal of Statistical Software</em>, 84(1), pp.Â 1-28.</p>
<hr>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## R version 4.4.3 (2025-02-28)</span></span>
<span><span class="co">## Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">## Running under: macOS Sequoia 15.3.2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Rome</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] clustvarsel_2.3.5 mclust_6.1.2      knitr_1.50       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] Matrix_1.7-2        jsonlite_2.0.0      compiler_4.4.3     </span></span>
<span><span class="co">##  [4] leaps_3.2           jquerylib_0.1.4     splines_4.4.3      </span></span>
<span><span class="co">##  [7] yaml_2.3.10         fastmap_1.2.0       lattice_0.22-6     </span></span>
<span><span class="co">## [10] R6_2.6.1            pcaPP_2.0-5         robustbase_0.99-4-1</span></span>
<span><span class="co">## [13] iterators_1.0.14    htmlwidgets_1.6.4   MASS_7.3-64        </span></span>
<span><span class="co">## [16] desc_1.4.3          bslib_0.9.0         rlang_1.1.5        </span></span>
<span><span class="co">## [19] cachem_1.1.0        inline_0.3.21       rrcov_1.7-6        </span></span>
<span><span class="co">## [22] xfun_0.51           fs_1.6.5            sass_0.4.9         </span></span>
<span><span class="co">## [25] cli_3.6.4           pkgdown_2.1.1       digest_0.6.37      </span></span>
<span><span class="co">## [28] foreach_1.5.2       grid_4.4.3          rstudioapi_0.17.1  </span></span>
<span><span class="co">## [31] mvtnorm_1.3-3       lifecycle_1.0.4     DEoptimR_1.1-3-1   </span></span>
<span><span class="co">## [34] evaluate_1.0.3      BMA_3.18.20         codetools_0.2-20   </span></span>
<span><span class="co">## [37] survival_3.8-3      stats4_4.4.3        rmarkdown_2.29     </span></span>
<span><span class="co">## [40] tools_4.4.3         htmltools_0.5.8.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nema Dean, Adrian E. Raftery, <a href="https://luca-scr.github.io/" class="external-link">Luca Scrucca</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
