<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A dimension reduction method based on Gaussian finite mixture models which provides an extension to sliced inverse regression (SIR). The basis of the subspace is estimated by modeling the inverse distribution within slice using Gaussian finite mixtures with number of components and covariance matrix parameterization selected by BIC or defined by the user."><title>Model-based Sliced Inverse Regression (MSIR) — msir • msir</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/JetBrains_Mono-0.4.5/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model-based Sliced Inverse Regression (MSIR) — msir"><meta property="og:description" content="A dimension reduction method based on Gaussian finite mixture models which provides an extension to sliced inverse regression (SIR). The basis of the subspace is estimated by modeling the inverse distribution within slice using Gaussian finite mixtures with number of components and covariance matrix parameterization selected by BIC or defined by the user."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">msir</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/msir.html">Vignette</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://mclust-org.github.io">
    <span class="fa fa-home"></span>
     
    mclust-org
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Model-based Sliced Inverse Regression (MSIR)</h1>
      
      <div class="d-none name"><code>msir.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A dimension reduction method based on Gaussian finite mixture models which provides an extension to sliced inverse regression (SIR). The basis of the subspace is estimated by modeling the inverse distribution within slice using Gaussian finite mixtures with number of components and covariance matrix parameterization selected by BIC or defined by the user.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">msir</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, nslices <span class="op">=</span> <span class="va">msir.nslices</span>, slice.function <span class="op">=</span> <span class="va">msir.slices</span>, </span>
<span>     modelNames <span class="op">=</span> <span class="cn">NULL</span>, G <span class="op">=</span> <span class="cn">NULL</span>, cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mle"</span>, <span class="st">"regularized"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A \((n \times p)\) design matrix containing the predictors data values.</p></dd>

  <dt>y</dt>
<dd><p>A \((n \times 1)\) vector of data values for the response variable. It can be a numeric vector (regression) but also a factor (classification). In the latter case, the levels of the factor define the slices used.</p></dd>

  <dt>nslices</dt>
<dd><p>The number of slices used, unless <code>y</code> is a factor. By default the value returned by <code><a href="msir.nslices.html">msir.nslices</a></code>.</p></dd>

  <dt>slice.function</dt>
<dd><p>The slice functions to be used, by default <code><a href="msir.slices.html">msir.slices</a></code>, but the user can provide a different slicing function.</p></dd>

  <dt>modelNames</dt>
<dd><p>A vector of character strings indicating the Gaussian mixture models to be fitted as described in <code><a href="https://mclust-org.github.io/mclust/reference/mclustModelNames.html" class="external-link">mclustModelNames</a></code>. If a  vector of strings is given they are used for all the slices. If a list of vectors is provided then each vector refers to a single slice.</p></dd>

  <dt>G</dt>
<dd><p>An integer vector specifying the numbers of mixture components used in fitting Gaussian mixture models. If a list of vectors is provided then each vector refers to a single slice.</p></dd>

  <dt>cov</dt>
<dd><p>The predictors marginal covariance matrix. Possible choices are:</p><ul><li><p><code>"mle"</code>: for the maximum likelihood estimate</p></li>
<li><p><code>"regularized"</code>: for a regularized estimate of the covariance matrix (see <code><a href="msir.regularizedSigma.html">msir.regularizedSigma</a></code>)</p></li>
<li><p><code>R matrix</code>: a \((p \times p)\) user defined covariance matrix</p></li>
</ul></dd>

  <dt>...</dt>
<dd><p>other arguments passed to <code>msir.compute</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns an object of class <code>'msir'</code> with attributes:</p>
<dl><dt>call</dt>
<dd><p>the function call.</p></dd>

  <dt>x</dt>
<dd><p>the design matrix.</p></dd>

  <dt>y</dt>
<dd><p>the response vector.</p></dd>

  <dt>slice.info</dt>
<dd><p>output from slicing function.</p></dd>

  <dt>mixmod</dt>
<dd><p>a list of finite mixture model objects as described in  <code><a href="https://mclust-org.github.io/mclust/reference/mclustModel.html" class="external-link">mclustModel</a></code>.</p></dd>

  <dt>loglik</dt>
<dd><p>the log-likelihood for the mixture models.</p></dd>

  <dt>f</dt>
<dd><p>a vector of length equal to the total number of mixture components containing the fraction of observations in each fitted component within slices.</p></dd>

  <dt>mu</dt>
<dd><p>a matrix of component within slices predictors means.</p></dd>

  <dt>sigma</dt>
<dd><p>the marginal predictors covariance matrix.</p></dd>

  <dt>M</dt>
<dd><p>the msir kernel matrix.</p></dd>

  <dt>evalues</dt>
<dd><p>the eigenvalues from the generalized eigen-decomposition of <code>M</code>.</p></dd>

  <dt>evectors</dt>
<dd><p>the raw eigenvectors from the generalized eigen-decomposition of <code>M</code> ordered according to the eigenvalues.</p></dd>

  <dt>basis</dt>
<dd><p>the normalized eigenvectors from the generalized eigen-decomposition of <code>M</code> ordered according to the eigenvalues.</p></dd>

  <dt>std.basis</dt>
<dd><p>standardized basis vectors obtained by multiplying each coefficient of the eigenvectors by the standard deviation of the corresponding predictor. The resulting coefficients are scaled such that all predictors have unit standard deviation.</p></dd>

  <dt>numdir</dt>
<dd><p>the maximal number of directions estimated.</p></dd>

  <dt>dir</dt>
<dd><p>the estimated MSIR directions from mean-centered predictors.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Scrucca, L. (2011) Model-based SIR for dimension reduction. <em>Computational Statistics &amp; Data Analysis</em>, 55(11), 3010-3026.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Luca Scrucca <a href="mailto:luca.scrucca@unipg.it">luca.scrucca@unipg.it</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="summary.msir.html">summary.msir</a></code>, <code><a href="plot.msir.html">plot.msir</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># 1-dimensional simple regression</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">p</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MSIR</span> <span class="op">&lt;-</span> <span class="fu">msir</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">MSIR</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model-based SIR </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slices:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1   2    3   4       5   6   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GMM       XII EEE  XXX EEI     XXX VII </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num.comp. 1   2    1   3       1   2   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num.obs.  33  26|7 33  15|6|12 33  28|7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated basis vectors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Dir1     Dir2     Dir3     Dir4       Dir5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1  0.7097864 -0.48270  0.53769  0.12034  0.0022288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2 -0.7041481 -0.42937  0.45878  0.13769 -0.1827196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x3  0.0111170  0.71477  0.68775 -0.22556 -0.0522356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x4  0.0052141  0.16238  0.16504  0.60551  0.7581749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x5 -0.0150997 -0.21300 -0.01333 -0.74097  0.6237394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Dir1     Dir2     Dir3      Dir4       Dir5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues  0.91016  0.26585  0.15332  0.060237   0.012936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cum. %      64.89545 83.85069 94.78262 99.077612 100.000000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MSIR</span>, type <span class="op">=</span> <span class="st">"2Dplot"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="msir-1.png" alt="" width="672" height="576"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1-dimensional symmetric response curve</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">p</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MSIR</span> <span class="op">&lt;-</span> <span class="fu">msir</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">MSIR</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model-based SIR </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slices:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1     2   3   4   5     6    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GMM       VVE   XII XII XII EEE   EEE  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num.comp. 2     1   1   1   2     2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num.obs.  20|13 33  33  33  14|19 22|13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated basis vectors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Dir1     Dir2      Dir3     Dir4     Dir5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1 -0.740396 -0.39489 -0.247911 -0.45435 -0.37276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2  0.666642 -0.41304 -0.083044 -0.49875 -0.29250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x3  0.068615 -0.65422  0.176128  0.67171 -0.33899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x4 -0.022374 -0.42329  0.596660 -0.23544  0.62061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x5  0.046850 -0.25746 -0.737983  0.19544  0.52481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Dir1      Dir2      Dir3       Dir4      Dir5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues  0.76871  0.053058  0.031793  0.0088756 6.346e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cum. %      88.48121 94.588434 98.247933 99.2695486 1.000e+02</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MSIR</span>, type <span class="op">=</span> <span class="st">"2Dplot"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="msir-2.png" alt="" width="672" height="576"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MSIR</span>, type <span class="op">=</span> <span class="st">"coefficients"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="msir-3.png" alt="" width="672" height="576"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2-dimensional response curve</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">b1</span>,<span class="va">b2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">b1</span> <span class="op">+</span> <span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">b1</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">4</span><span class="op">*</span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">b2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MSIR</span> <span class="op">&lt;-</span> <span class="fu">msir</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">MSIR</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model-based SIR </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slices:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1     2     3    4   5     6     7     8  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GMM       EEI   EVE   VEI  XII EEV   VEV   EEV   XXI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num.comp. 2     2     2    1   2     2     2     1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num.obs.  20|22 26|16 9|33 42  18|24 18|24 28|14 6  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated basis vectors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Dir1      Dir2      Dir3     Dir4      Dir5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1 -0.3884439  0.939737 -0.101742 0.147305  0.026227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2  0.6952440  0.215864 -0.613699 0.048259  0.063465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x3  0.6036119  0.209895  0.776560 0.059747 -0.091979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x4  0.0369820 -0.161043 -0.093403 0.985688 -0.065283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x5  0.0056592  0.017512 -0.035387 0.028667 -0.991243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Dir1     Dir2     Dir3      Dir4       Dir5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues  0.71463  0.49623  0.29359  0.071781   0.047476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cum. %      44.01218 74.57402 92.65524 97.076059 100.000000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MSIR</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="msir-4.png" alt="" width="672" height="576"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MSIR</span>, type <span class="op">=</span> <span class="st">"spinplot"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MSIR</span>, which <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"2Dplot"</span>, span <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="msir-5.png" alt="" width="672" height="576"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MSIR</span>, which <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"2Dplot"</span>, span <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="msir-6.png" alt="" width="672" height="576"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="http://www.stat.unipg.it/luca" class="external-link">Luca Scrucca</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

