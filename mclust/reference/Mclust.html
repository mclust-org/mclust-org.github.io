<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Model-based clustering based on parameterized finite Gaussian mixture models. 
Models are estimated by EM algorithm initialized by hierarchical model-based agglomerative clustering. The optimal model is then selected according to BIC."><title>Model-Based Clustering — Mclust • mclust</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model-Based Clustering — Mclust"><meta property="og:description" content="Model-based clustering based on parameterized finite Gaussian mixture models. 
Models are estimated by EM algorithm initialized by hierarchical model-based agglomerative clustering. The optimal model is then selected according to BIC."><meta property="og:image" content="https://mclust-org.github.io/mclust/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mclust</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">6.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mclust.html">Vignette</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://mclust-org.github.io">
    <span class="fa fa-home"></span>
     
    mclust-org
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Model-Based Clustering</h1>
      
      <div class="d-none name"><code>Mclust.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Model-based clustering based on parameterized finite Gaussian mixture models. 
Models are estimated by EM algorithm initialized by hierarchical model-based agglomerative clustering. The optimal model is then selected according to BIC.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Mclust</span><span class="op">(</span><span class="va">data</span>, G <span class="op">=</span> <span class="cn">NULL</span>, modelNames <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>     prior <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>     control <span class="op">=</span> <span class="fu"><a href="emControl.html">emControl</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>     initialization <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>     warn <span class="op">=</span> <span class="fu"><a href="mclust.options.html">mclust.options</a></span><span class="op">(</span><span class="st">"warn"</span><span class="op">)</span>, </span>
<span>     x <span class="op">=</span>  <span class="cn">NULL</span>, </span>
<span>     verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A numeric vector, matrix, or data frame of observations. Categorical
  variables are not allowed. If a matrix or data frame, rows
  correspond to observations (\(n\)) and columns correspond to variables (\(d\)).</p></dd>

  <dt>G</dt>
<dd><p>An integer vector specifying the numbers of mixture components
  (clusters) for which the BIC is to be calculated. 
  The default is <code>G=1:9</code>.</p></dd>

  <dt>modelNames</dt>
<dd><p>A vector of character strings indicating the models to be fitted 
  in the EM phase of clustering. The default is:</p><ul><li><p>for univariate data (\(d = 1\)): <code>c("E", "V")</code></p></li>
<li><p>for multivariate data (\(n &gt; d\)): all the models available in <code>mclust.options("emModelNames")</code></p></li>
<li><p>for multivariate data (\(n &lt;= d\)): the spherical and diagonal models, i.e. <code>c("EII", "VII", "EEI", "EVI", "VEI", "VVI")</code></p></li>
</ul><p>The help file for <code><a href="mclustModelNames.html">mclustModelNames</a></code> describes the available models.</p></dd>

  <dt>prior</dt>
<dd><p>The default assumes no prior, but this argument allows specification of a 
  conjugate prior on the means and variances through the function 
  <code><a href="priorControl.html">priorControl</a></code>. <br>
  Note that, as described in <code><a href="defaultPrior.html">defaultPrior</a></code>, in the multivariate 
  case only 10 out of 14 models may be used in conjunction with a prior, i.e.
  those available in <em>MCLUST</em> up to version 4.4.</p></dd>

  <dt>control</dt>
<dd><p>A list of control parameters for EM. The defaults are set by the call
  <code><a href="emControl.html">emControl()</a></code>.</p></dd>

  <dt>initialization</dt>
<dd><p>A list containing zero or more of the following components:</p><dl><dt><code>hcPairs</code></dt>
<dd><p>A matrix of merge pairs for hierarchical clustering such as produced
  by function <code><a href="hc.html">hc</a></code>. <br>
  For multivariate data, the default is to compute a hierarchical 
  agglomerative clustering tree by applying function 
  <code><a href="hc.html">hc</a></code> with 
  model specified by <code>mclust.options("hcModelName")</code>, and
  data transformation set by <code>mclust.options("hcUse")</code>.<br>
  All the input or a subset as indicated by the <code>subset</code> argument is 
  used for initial clustering.<br>
  The hierarchical clustering results are then used to start the EM
  algorithm from a given partition.<br>
  For univariate data, the default is to use quantiles to start the EM
  algorithm. However, hierarchical clustering could also be used by 
  calling <code><a href="hc.html">hc</a></code> with model specified as <code>"V"</code> or <code>"E"</code>.</p></dd>

  <dt><code>subset</code></dt>
<dd><p>A logical or numeric vector specifying a subset of the data
  to be used in the initial hierarchical clustering phase.
  No subset is used unless the number of observations exceeds 
  the value specified by <code>mclust.options("subset")</code>, which by 
  default is set to 2000 (see <code><a href="mclust.options.html">mclust.options</a></code>).
  Note that in this case to guarantee exact reproducibility of results 
  a seed must be specified (see <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code>).</p></dd>

  <dt><code>noise</code></dt>
<dd><p>A logical or numeric vector indicating an initial guess as to
  which observations are noise in the data. If numeric the entries
  should correspond to row indexes of the data. If supplied, a noise
  term will be added to the model in the estimation.</p></dd>

   
</dl><p></p></dd>

  <dt>warn</dt>
<dd><p>A logical value indicating whether or not certain warnings 
  (usually related to singularity) should be issued.
  The default is controlled by <code><a href="mclust.options.html">mclust.options</a></code>.</p></dd>

  <dt>x</dt>
<dd><p>An object of class <code>'mclustBIC'</code>. If supplied, BIC values for models 
   that have already been computed and are available in <code>x</code> are not 
   recomputed. 
   All arguments, with the exception of <code>data</code>, <code>G</code> and 
   <code>modelName</code>, are ignored and their values are set as specified in the
   attributes of <code>x</code>. Defaults for <code>G</code> and <code>modelNames</code>
   are taken from <code>x</code>.</p></dd>

  <dt>verbose</dt>
<dd><p>A logical controlling if a text progress bar is displayed during the
  fitting procedure. By default is <code>TRUE</code> if the session is 
  interactive, and <code>FALSE</code> otherwise.</p></dd>

  <dt>...</dt>
<dd><p>Catches unused arguments in indirect or list calls via <code>do.call</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>'Mclust'</code> providing the optimal (according to BIC)
 mixture model estimation.</p>
 

<p>The details of the output components are as follows:</p>
<dl><dt>call</dt>
<dd><p>The matched call</p></dd>
 

  <dt>data</dt>
<dd><p>The input data matrix.</p></dd>
 

  <dt>modelName</dt>
<dd><p>A character string denoting the model at which the optimal BIC occurs.</p></dd>

  <dt>n</dt>
<dd><p>The number of observations in the data.</p></dd>

  <dt>d</dt>
<dd><p>The dimension of the data.</p></dd>

  <dt>G</dt>
<dd><p>The optimal number of mixture components.</p></dd>

  <dt>BIC</dt>
<dd><p>All BIC values.</p></dd>

  <dt>loglik</dt>
<dd><p>The log-likelihood corresponding to the optimal BIC.</p></dd>

  <dt>df</dt>
<dd><p>The number of estimated parameters.</p></dd>

  <dt>bic</dt>
<dd><p>BIC value of the selected model.</p></dd>

  <dt>icl</dt>
<dd><p>ICL value of the selected model.</p></dd>

  <dt>hypvol</dt>
<dd><p>The hypervolume parameter for the noise component if required, otherwise set to <code>NULL</code> (see <code><a href="hypvol.html">hypvol</a></code>).</p></dd>

  <dt>parameters</dt>
<dd><p>A list with the following components:</p><dl><dt><code>pro</code></dt>
<dd><p>A vector whose <em>k</em>th component is the mixing proportion for
        the <em>k</em>th component of the mixture model.
        If missing, equal proportions are assumed.</p></dd>

    <dt><code>mean</code></dt>
<dd><p>The mean for each component. If there is more than one component,
        this is a matrix whose kth column is the mean of the <em>k</em>th
        component of the mixture model.</p></dd>

    <dt><code>variance</code></dt>
<dd><p>A list of variance parameters for the model.
        The components of this list depend on the model
        specification. See the help file for <code><a href="mclustVariance.html">mclustVariance</a></code>
        for details.</p></dd>

    
</dl><p></p></dd>

  <dt>z</dt>
<dd><p>A matrix whose <em>[i,k]</em>th entry is the probability that observation
  <em>i</em> in the test data belongs to the <em>k</em>th class.</p></dd>

  <dt>classification</dt>
<dd><p>The classification corresponding to <code>z</code>, i.e. <code>map(z)</code>.</p></dd>

  <dt>uncertainty</dt>
<dd><p>The uncertainty associated with the classification.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Scrucca L., Fraley C., Murphy T. B. and Raftery A. E. (2023) <em>Model-Based Clustering, Classification, and Density Estimation Using mclust in R</em>. Chapman &amp; Hall/CRC, ISBN: 978-1032234953, https://mclust-org.github.io/book/</p>
<p>Scrucca L., Fop M., Murphy T. B. and Raftery A. E. (2016) mclust 5: clustering, classification and density estimation using Gaussian finite mixture models, <em>The R Journal</em>, 8/1, pp. 289-317.</p>
<p>Fraley C. and Raftery A. E. (2002) Model-based clustering, discriminant analysis and density estimation, <em>Journal of the American Statistical Association</em>, 97/458, pp. 611-631.</p>
<p>C. Fraley and A. E. Raftery (2007) Bayesian regularization for normal mixture estimation and model-based clustering. <em>Journal of Classification</em>, 24, 155-181.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="summary.Mclust.html">summary.Mclust</a></code>, 
  <code><a href="plot.Mclust.html">plot.Mclust</a></code>, 
  <code><a href="priorControl.html">priorControl</a></code>, 
  <code><a href="emControl.html">emControl</a></code>, 
  <code><a href="hc.html">hc</a></code>,
  <code><a href="mclustBIC.html">mclustBIC</a></code>, 
  <code><a href="mclustModelNames.html">mclustModelNames</a></code>,
  <code><a href="mclust.options.html">mclust.options</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gaussian finite mixture model fitted by EM algorithm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mclust VEV (ellipsoidal, equal shape) model with 2 components: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  log-likelihood   n df       BIC       ICL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        -215.726 150 26 -561.7285 -561.7289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  50 100 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, G <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gaussian finite mixture model fitted by EM algorithm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mclust VEV (ellipsoidal, equal shape) model with 3 components: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  log-likelihood   n df       BIC       ICL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        -186.074 150 38 -562.5522 -566.4673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1  2  3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 45 55 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixing probabilities:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1         2         3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3333333 0.3005423 0.3661243 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]     [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length 5.006 5.915044 6.546807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width  3.428 2.777451 2.949613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length 1.462 4.204002 5.482252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width  0.246 1.298935 1.985523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variances:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [,,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length   0.13320850  0.10938369  0.019191764 0.011585649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width    0.10938369  0.15495369  0.012096999 0.010010130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length   0.01919176  0.01209700  0.028275400 0.005818274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width    0.01158565  0.01001013  0.005818274 0.010695632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [,,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length   0.22572159  0.07613348   0.14689934  0.04335826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width    0.07613348  0.08024338   0.07372331  0.03435893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length   0.14689934  0.07372331   0.16613979  0.04953078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width    0.04335826  0.03435893   0.04953078  0.03338619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [,,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length   0.42943106  0.10784274   0.33452389  0.06538369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width    0.10784274  0.11596343   0.08905176  0.06134034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length   0.33452389  0.08905176   0.36422115  0.08706895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width    0.06538369  0.06134034   0.08706895  0.08663823</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using prior</span></span></span>
<span class="r-in"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, prior <span class="op">=</span> <span class="fu"><a href="priorControl.html">priorControl</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The presence of BIC values equal to NA is likely due to one or more of the mixture proportions being estimated as zero, so that the model estimated reduces to one with a smaller number of components.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gaussian finite mixture model fitted by EM algorithm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mclust VEV (ellipsoidal, equal shape) model with 2 components: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prior: defaultPrior() </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  log-likelihood   n df       BIC      ICL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -225.2685 150 26 -580.8136 -580.814</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  50 100 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, prior <span class="op">=</span> <span class="fu"><a href="priorControl.html">priorControl</a></span><span class="op">(</span>functionName<span class="op">=</span><span class="st">"defaultPrior"</span>, shrinkage<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The presence of BIC values equal to NA is likely due to one or more of the mixture proportions being estimated as zero, so that the model estimated reduces to one with a smaller number of components.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gaussian finite mixture model fitted by EM algorithm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mclust VEV (ellipsoidal, equal shape) model with 2 components: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prior: defaultPrior(shrinkage = 0.1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  log-likelihood   n df       BIC       ICL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -227.6729 150 26 -585.6223 -585.6227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  50 100 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clustering of faithful data with some artificial noise added </span></span></span>
<span class="r-in"><span><span class="va">nNoise</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="co"># to make it reproducible</span></span></span>
<span class="r-in"><span><span class="va">Noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span></span>
<span class="r-in"><span>              <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nNoise</span>, min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fl">.1</span>, max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="va">Noise</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">Noise</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Mclust-1.png" alt="" width="672" height="576"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">NoiseInit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span><span class="op">+</span><span class="va">nNoise</span>, </span></span>
<span class="r-in"><span>          replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">data</span>, initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>noise <span class="op">=</span> <span class="va">NoiseInit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5</span>, parameter <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gaussian finite mixture model fitted by EM algorithm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mclust VVE (ellipsoidal, equal orientation) model with 2 components and a noise</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> term: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  log-likelihood   n df       BIC       ICL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -1746.033 372 12 -3563.093 -3674.077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   2   0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 180  88 104 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixing probabilities:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1         2         0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4301382 0.2112698 0.3585921 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eruptions  4.342387  1.978433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> waiting   80.218154 54.005828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variances:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [,,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           eruptions    waiting</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eruptions 0.1152778  0.4225761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> waiting   0.4225761 30.6256680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [,,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eruptions    waiting</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eruptions 0.03873859  0.3776241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> waiting   0.37762409 27.3035511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypervolume of noise component:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 191.8869 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod5</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Mclust-2.png" alt="" width="672" height="576"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chris Fraley, Adrian E. Raftery, <a href="http://www.stat.unipg.it/luca" class="external-link">Luca Scrucca</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

