<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A quick tour of msir • msir</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A quick tour of msir">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msir</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/msir.html">Vignette</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://mclust-org.github.io">
    <span class="fa fa-home"></span>
     
    mclust-org
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>A quick tour of msir</h1>
                        <h4 class="author">Luca Scrucca</h4>
            
            <h4 class="date">22 Dec 2018</h4>
      
      
      <div class="hidden name"><code>msir.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Model-based Sliced Inverse Regression (MSIR) is a dimension reduction method based on Gaussian finite mixture models which provides an extension to sliced inverse regression (SIR).</p>
<p>The basis of the MSIR subspace is estimated by modeling the inverse distribution within slice using Gaussian finite mixtures with number of components and covariance matrix parameterization selected by BIC or defined by the user.</p>
<p>The <strong>msir</strong> package implements the methodology described in Scrucca (2011).</p>
<p>This vignette is written in R Markdown using the <a href="https://cran.r-project.org/package=knitr">knitr</a> package for production.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(msir)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">## Package 'msir' version 1.3.2</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">## Type 'citation("msir")' for citing this R package in publications.</span></a></code></pre></div>
</div>
<div id="example-1-dimensional-nonlinear-response-curve" class="section level1">
<h1 class="hasAnchor">
<a href="#example-1-dimensional-nonlinear-response-curve" class="anchor"></a>Example: 1-dimensional nonlinear response curve</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">n &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb2-2" title="2">p &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb2-3" title="3">b &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,p<span class="dv">-2</span>)))</a>
<a class="sourceLine" id="cb2-4" title="4">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(n<span class="op">*</span>p), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> p)</a>
<a class="sourceLine" id="cb2-5" title="5">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x<span class="op">%*%</span>b) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span><span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(n)</a>
<a class="sourceLine" id="cb2-6" title="6">MSIR &lt;-<span class="st"> </span><span class="kw"><a href="../reference/msir.html">msir</a></span>(x, y)</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(MSIR)</a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">## -------------------------------------------------- </span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">## Model-based SIR </span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">## -------------------------------------------------- </span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">## Slices:</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">##           1   2    3   4   5   6  </span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">## GMM       XXI EEI  XXX XXX XXX XII</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">## Num.comp. 1   2    1   1   1   1  </span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">## Num.obs.  33  9|24 33  33  33  35 </span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">## Estimated basis vectors:</span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="co">##         Dir1      Dir2     Dir3      Dir4      Dir5</span></a>
<a class="sourceLine" id="cb2-20" title="20"><span class="co">## x1  0.719233  0.665189 -0.35087  0.088328  0.289256</span></a>
<a class="sourceLine" id="cb2-21" title="21"><span class="co">## x2 -0.693391  0.578066 -0.33561  0.195841  0.141172</span></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="co">## x3  0.027810  0.215261  0.30793  0.626084 -0.655309</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="co">## x4 -0.019198 -0.013048 -0.52209 -0.425878 -0.678608</span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="co">## x5 -0.027765  0.420542  0.62996 -0.616840 -0.080389</span></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="co">##                 Dir1     Dir2     Dir3     Dir4       Dir5</span></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="co">## Eigenvalues  0.89038  0.12676  0.04031  0.00887 1.6342e-03</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="co">## Cum. %      83.37250 95.24195 99.01642 99.84698 1.0000e+02</span></a>
<a class="sourceLine" id="cb2-29" title="29"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">type =</span> <span class="st">"evalues"</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">type =</span> <span class="st">"coefficients"</span>, <span class="dt">which =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-2-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">type =</span> <span class="st">"2Dplot"</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-2-3.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="example-1-dimensional-symmetric-response-curve" class="section level1">
<h1 class="hasAnchor">
<a href="#example-1-dimensional-symmetric-response-curve" class="anchor"></a>Example: 1-dimensional symmetric response curve</h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">n &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb5-2" title="2">p &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb5-3" title="3">b &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,p<span class="dv">-2</span>)))</a>
<a class="sourceLine" id="cb5-4" title="4">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(n<span class="op">*</span>p), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> p)</a>
<a class="sourceLine" id="cb5-5" title="5">y &lt;-<span class="st"> </span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x<span class="op">%*%</span>b)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span><span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(n)</a>
<a class="sourceLine" id="cb5-6" title="6">MSIR &lt;-<span class="st"> </span><span class="kw"><a href="../reference/msir.html">msir</a></span>(x, y)</a>
<a class="sourceLine" id="cb5-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(MSIR)</a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">## -------------------------------------------------- </span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">## Model-based SIR </span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">## -------------------------------------------------- </span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">## Slices:</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">##           1   2   3   4   5     6    </span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">## GMM       XXX XXI XII XII EEV   EII  </span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">## Num.comp. 1   1   1   1   2     2    </span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">## Num.obs.  33  33  33  33  13|20 16|19</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">## Estimated basis vectors:</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">##          Dir1        Dir2     Dir3     Dir4     Dir5</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">## x1  0.7032497 -0.32265327  0.17850  0.50213  0.48315</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">## x2 -0.7097760 -0.20051289  0.26844  0.34153  0.51756</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">## x3  0.0207609 -0.64666898  0.42755 -0.59757  0.03875</span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">## x4  0.0020883 -0.00061766  0.69106  0.35396 -0.60040</span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">## x5 -0.0349652 -0.66144409 -0.48550  0.38580 -0.36976</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">##                 Dir1      Dir2      Dir3     Dir4       Dir5</span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">## Eigenvalues  0.76068  0.048494  0.027907  0.01981 2.6055e-03</span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">## Cum. %      88.50291 94.145085 97.392035 99.69686 1.0000e+02</span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">type =</span> <span class="st">"evalues"</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">type =</span> <span class="st">"coefficients"</span>, <span class="dt">which =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-3-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">type =</span> <span class="st">"2Dplot"</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-3-3.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="example-2-dimensional-response-curve" class="section level1">
<h1 class="hasAnchor">
<a href="#example-2-dimensional-response-curve" class="anchor"></a>Example: 2-dimensional response curve</h1>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">n &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb8-2" title="2">p &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb8-3" title="3">b1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>, p<span class="dv">-3</span>))</a>
<a class="sourceLine" id="cb8-4" title="4">b2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>, p<span class="dv">-3</span>))</a>
<a class="sourceLine" id="cb8-5" title="5">b &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(b1,b2)</a>
<a class="sourceLine" id="cb8-6" title="6">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(n<span class="op">*</span>p), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> p)</a>
<a class="sourceLine" id="cb8-7" title="7">y &lt;-<span class="st"> </span>x <span class="op">%*%</span><span class="st"> </span>b1 <span class="op">+</span><span class="st"> </span>(x <span class="op">%*%</span><span class="st"> </span>b1)<span class="op">^</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">*</span>(x <span class="op">%*%</span><span class="st"> </span>b2)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(n)</a>
<a class="sourceLine" id="cb8-8" title="8">MSIR &lt;-<span class="st"> </span><span class="kw"><a href="../reference/msir.html">msir</a></span>(x, y)</a>
<a class="sourceLine" id="cb8-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(MSIR)</a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">## -------------------------------------------------- </span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">## Model-based SIR </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">## -------------------------------------------------- </span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">## </span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">## Slices:</span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">##           1   2     3     4        5   6     7   8  </span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">## GMM       XXI VVE   EEV   EVE      XII EEV   XII XXI</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">## Num.comp. 1   2     2     3        1   2     1   1  </span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">## Num.obs.  42  12|30 16|26 18|12|12 42  25|17 42  6  </span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">## Estimated basis vectors:</span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">##         Dir1      Dir2      Dir3      Dir4     Dir5</span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">## x1  0.320287  0.944245 -0.019421 -0.047184 -0.14173</span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="co">## x2  0.635841 -0.256139  0.464958  0.182138 -0.50389</span></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="co">## x3  0.695964 -0.194734 -0.298009 -0.145248  0.62064</span></a>
<a class="sourceLine" id="cb8-25" title="25"><span class="co">## x4 -0.092271  0.065128  0.818368 -0.361349  0.42430</span></a>
<a class="sourceLine" id="cb8-26" title="26"><span class="co">## x5  0.015541 -0.025113 -0.157804 -0.901626 -0.40099</span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="co">## </span></a>
<a class="sourceLine" id="cb8-28" title="28"><span class="co">##                 Dir1     Dir2      Dir3      Dir4       Dir5</span></a>
<a class="sourceLine" id="cb8-29" title="29"><span class="co">## Eigenvalues  0.65327  0.36881  0.054035  0.025591   0.013548</span></a>
<a class="sourceLine" id="cb8-30" title="30"><span class="co">## Cum. %      58.57625 91.64546 96.490546 98.785167 100.000000</span></a>
<a class="sourceLine" id="cb8-31" title="31"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">type =</span> <span class="st">"evalues"</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">type =</span> <span class="st">"coefficients"</span>, <span class="dt">which =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-4-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">which =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-4-3.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">which =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">"2Dplot"</span>, <span class="dt">span =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-4-4.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">which =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">"2Dplot"</span>, <span class="dt">span =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="msir_files/figure-html/unnamed-chunk-4-5.png" width="90%" style="display: block; margin: auto;"></p>
<p>To obtain rotating 3D spinplot use:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">type =</span> <span class="st">"spinplot"</span>)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MSIR, <span class="dt">type =</span> <span class="st">"spinplot"</span>, <span class="dt">span =</span> <span class="fl">0.75</span>)</a></code></pre></div>
</div>
<div id="general-usage-of-spinplot-function" class="section level1">
<h1 class="hasAnchor">
<a href="#general-usage-of-spinplot-function" class="anchor"></a>General usage of <code><a href="../reference/splinplot.html">spinplot()</a></code> function</h1>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">x1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb14-2" title="2">x2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb14-3" title="3">y  &lt;-<span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>x2<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="kw"><a href="../reference/splinplot.html">spinplot</a></span>(x1, y, x2)</a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="../reference/splinplot.html">spinplot</a></span>(x1, y, x2, <span class="dt">scaling=</span><span class="st">"aaa"</span>)</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw"><a href="../reference/splinplot.html">spinplot</a></span>(x1, y, x2, <span class="dt">rem.lin.trend =</span> <span class="st">"TRUE"</span>)</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw"><a href="../reference/splinplot.html">spinplot</a></span>(x1, y, x2, <span class="dt">fit.smooth =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-4" title="4"><span class="kw"><a href="../reference/splinplot.html">spinplot</a></span>(x1, y, x2, <span class="dt">fit.ols =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">x &lt;-<span class="st"> </span>iris[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb16-2" title="2">y &lt;-<span class="st"> </span>iris[,<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="kw"><a href="../reference/splinplot.html">spinplot</a></span>(x)</a>
<a class="sourceLine" id="cb16-4" title="4"><span class="kw"><a href="../reference/splinplot.html">spinplot</a></span>(x, <span class="dt">markby =</span> y)</a>
<a class="sourceLine" id="cb16-5" title="5"><span class="kw"><a href="../reference/splinplot.html">spinplot</a></span>(x, <span class="dt">markby =</span> y, <span class="dt">pch =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb16-6" title="6">         <span class="dt">col.points =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"dodgerblue2"</span>, <span class="st">"orange"</span>, <span class="st">"green3"</span>))</a>
<a class="sourceLine" id="cb16-7" title="7"><span class="kw"><a href="../reference/splinplot.html">spinplot</a></span>(x, <span class="dt">markby =</span> y, <span class="dt">pch =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb16-8" title="8">         <span class="dt">col.points =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"lightcyan"</span>, <span class="st">"yellow"</span>, <span class="st">"lightgreen"</span>), </a>
<a class="sourceLine" id="cb16-9" title="9">         <span class="dt">background =</span> <span class="st">"black"</span>)</a></code></pre></div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Scrucca, L. (2011) Model-based SIR for dimension reduction. <em>Computational Statistics &amp; Data Analysis</em>, 55(11), 3010-3026.</p>
<hr>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">session_info</a></span>()</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">## ─ Session info ──────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">##  setting  value                       </span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">##  version  R version 3.5.1 (2018-07-02)</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">##  os       macOS Sierra 10.12.5        </span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">##  system   x86_64, darwin15.6.0        </span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">##  ui       X11                         </span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">##  language (EN)                        </span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">##  collate  en_US.UTF-8                 </span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co">##  ctype    en_US.UTF-8                 </span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co">##  tz       Europe/Rome                 </span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co">##  date     2018-12-22                  </span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="co">## </span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co">## ─ Packages ──────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co">##  package     * version    date       lib source                         </span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co">##  assertthat    0.2.0      2017-04-11 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="co">##  backports     1.1.2      2017-12-13 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co">##  base64enc     0.1-3      2015-07-28 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="co">##  callr         3.0.0.9001 2018-11-16 [1] Github (r-lib/callr@be7707d)   </span></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co">##  cli           1.0.1.9000 2018-11-16 [1] Github (r-lib/cli@56538e3)     </span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="co">##  commonmark    1.6        2018-09-30 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-22" title="22"><span class="co">##  crayon        1.3.4      2017-09-16 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-23" title="23"><span class="co">##  debugme       1.1.0      2017-10-22 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-24" title="24"><span class="co">##  desc          1.2.0      2018-11-16 [1] Github (r-lib/desc@7c12d36)    </span></a>
<a class="sourceLine" id="cb17-25" title="25"><span class="co">##  devtools      2.0.1      2018-10-26 [1] CRAN (R 3.5.1)                 </span></a>
<a class="sourceLine" id="cb17-26" title="26"><span class="co">##  digest        0.6.18     2018-10-10 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-27" title="27"><span class="co">##  evaluate      0.12       2018-10-09 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-28" title="28"><span class="co">##  fs            1.2.6      2018-08-23 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-29" title="29"><span class="co">##  glue          1.3.0      2018-07-17 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-30" title="30"><span class="co">##  htmltools     0.3.6      2017-04-28 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-31" title="31"><span class="co">##  knitr       * 1.20       2018-02-20 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-32" title="32"><span class="co">##  magrittr      1.5        2014-11-22 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-33" title="33"><span class="co">##  MASS          7.3-51.1   2018-11-01 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-34" title="34"><span class="co">##  mclust        5.4.2      2018-11-27 [1] CRAN (R 3.5.1)                 </span></a>
<a class="sourceLine" id="cb17-35" title="35"><span class="co">##  memoise       1.1.0      2017-04-21 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-36" title="36"><span class="co">##  msir        * 1.3.2      2018-12-20 [1] CRAN (R 3.5.1)                 </span></a>
<a class="sourceLine" id="cb17-37" title="37"><span class="co">##  pkgbuild      1.0.2      2018-10-16 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-38" title="38"><span class="co">##  pkgdown       1.3.0      2018-12-07 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-39" title="39"><span class="co">##  pkgload       1.0.2      2018-10-29 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-40" title="40"><span class="co">##  prettyunits   1.0.2      2015-07-13 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-41" title="41"><span class="co">##  processx      3.2.0.9000 2018-11-16 [1] Github (r-lib/processx@8374340)</span></a>
<a class="sourceLine" id="cb17-42" title="42"><span class="co">##  ps            1.2.1      2018-11-06 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-43" title="43"><span class="co">##  R6            2.3.0      2018-10-04 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-44" title="44"><span class="co">##  Rcpp          1.0.0      2018-11-07 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-45" title="45"><span class="co">##  remotes       2.0.2.9000 2018-11-16 [1] Github (r-lib/remotes@bd970d7) </span></a>
<a class="sourceLine" id="cb17-46" title="46"><span class="co">##  rlang         0.3.0.1    2018-10-25 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-47" title="47"><span class="co">##  rmarkdown     1.10       2018-06-11 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-48" title="48"><span class="co">##  roxygen2      6.1.1      2018-11-07 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-49" title="49"><span class="co">##  rprojroot     1.3-2      2018-01-03 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-50" title="50"><span class="co">##  rstudioapi    0.8        2018-10-02 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-51" title="51"><span class="co">##  sessioninfo   1.1.1      2018-11-05 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-52" title="52"><span class="co">##  stringi       1.2.4      2018-07-20 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-53" title="53"><span class="co">##  stringr       1.3.1      2018-05-10 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-54" title="54"><span class="co">##  testthat      2.0.1      2018-10-13 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-55" title="55"><span class="co">##  usethis       1.4.0      2018-08-14 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-56" title="56"><span class="co">##  withr         2.1.2      2018-03-15 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-57" title="57"><span class="co">##  xml2          1.2.0      2018-01-24 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-58" title="58"><span class="co">##  yaml          2.2.0      2018-07-25 [1] CRAN (R 3.5.0)                 </span></a>
<a class="sourceLine" id="cb17-59" title="59"><span class="co">## </span></a>
<a class="sourceLine" id="cb17-60" title="60"><span class="co">## [1] /Library/Frameworks/R.framework/Versions/3.5/Resources/library</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#example-1-dimensional-nonlinear-response-curve">Example: 1-dimensional nonlinear response curve</a></li>
      <li><a href="#example-1-dimensional-symmetric-response-curve">Example: 1-dimensional symmetric response curve</a></li>
      <li><a href="#example-2-dimensional-response-curve">Example: 2-dimensional response curve</a></li>
      <li><a href="#general-usage-of-spinplot-function">General usage of <code><a href="--/reference/splinplot-html">spinplot()</a></code> function</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://www.stat.unipg.it/luca">Luca Scrucca</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
