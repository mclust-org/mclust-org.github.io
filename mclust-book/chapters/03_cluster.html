<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3&nbsp; Model-Based Clustering – Model-Based Clustering, Classification, and Density Estimation 
Using mclust in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/04_classification.html" rel="next">
<link href="../chapters/02_mixture.html" rel="prev">
<link href="../images/cover.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03_cluster.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model-Based Clustering</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Model-Based Clustering, Classification, and Density Estimation Using mclust in R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/00_preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Finite Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03_cluster.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model-Based Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mixture-Based Classification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05_dens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model-Based Density Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06_graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Visualizing Gaussian Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07_miscellanea.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Miscellanea</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/99_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#gaussian-mixture-models-for-cluster-analysis" id="toc-gaussian-mixture-models-for-cluster-analysis" class="nav-link active" data-scroll-target="#gaussian-mixture-models-for-cluster-analysis"><span class="header-section-number">3.1</span> Gaussian Mixture Models for Cluster Analysis</a></li>
  <li><a href="#sec-clust_mclust" id="toc-sec-clust_mclust" class="nav-link" data-scroll-target="#sec-clust_mclust"><span class="header-section-number">3.2</span> Clustering in mclust</a></li>
  <li>
<a href="#sec-modsel_cluster" id="toc-sec-modsel_cluster" class="nav-link" data-scroll-target="#sec-modsel_cluster"><span class="header-section-number">3.3</span> Model Selection</a>
  <ul class="collapse">
<li><a href="#sec-modsel_BIC" id="toc-sec-modsel_BIC" class="nav-link" data-scroll-target="#sec-modsel_BIC"><span class="header-section-number">3.3.1</span> BIC</a></li>
  <li><a href="#icl" id="toc-icl" class="nav-link" data-scroll-target="#icl"><span class="header-section-number">3.3.2</span> ICL</a></li>
  <li><a href="#bootstrap-likelihood-ratio-testing" id="toc-bootstrap-likelihood-ratio-testing" class="nav-link" data-scroll-target="#bootstrap-likelihood-ratio-testing"><span class="header-section-number">3.3.3</span> Bootstrap Likelihood Ratio Testing</a></li>
  </ul>
</li>
  <li><a href="#sec-resamp" id="toc-sec-resamp" class="nav-link" data-scroll-target="#sec-resamp"><span class="header-section-number">3.4</span> Resampling-Based Inference in mclust</a></li>
  <li><a href="#sec-clustone" id="toc-sec-clustone" class="nav-link" data-scroll-target="#sec-clustone"><span class="header-section-number">3.5</span> Clustering Univariate Data</a></li>
  <li>
<a href="#sec-mbahc" id="toc-sec-mbahc" class="nav-link" data-scroll-target="#sec-mbahc"><span class="header-section-number">3.6</span> Model-Based Agglomerative Hierarchical Clustering</a>
  <ul class="collapse">
<li><a href="#agglomerative-clustering-for-large-datasets" id="toc-agglomerative-clustering-for-large-datasets" class="nav-link" data-scroll-target="#agglomerative-clustering-for-large-datasets"><span class="header-section-number">3.6.1</span> Agglomerative Clustering for Large Datasets</a></li>
  </ul>
</li>
  <li><a href="#sec-mclust_init" id="toc-sec-mclust_init" class="nav-link" data-scroll-target="#sec-mclust_init"><span class="header-section-number">3.7</span> Initialization in mclust</a></li>
  <li><a href="#sec-mclust_em" id="toc-sec-mclust_em" class="nav-link" data-scroll-target="#sec-mclust_em"><span class="header-section-number">3.8</span> EM Algorithm in mclust</a></li>
  <li><a href="#further-considerations-in-cluster-analysis-via-mixture-modeling" id="toc-further-considerations-in-cluster-analysis-via-mixture-modeling" class="nav-link" data-scroll-target="#further-considerations-in-cluster-analysis-via-mixture-modeling"><span class="header-section-number">3.9</span> Further Considerations in Cluster Analysis via Mixture Modeling</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-cluster" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model-Based Clustering</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="hidden">
<p><span class="math display">\[
\DeclareMathOperator{\Real}{\mathbb{R}}
\DeclareMathOperator{\Proj}{\text{P}}
\DeclareMathOperator{\Exp}{\text{E}}
\DeclareMathOperator{\Var}{\text{Var}}
\DeclareMathOperator{\var}{\text{var}}
\DeclareMathOperator{\sd}{\text{sd}}
\DeclareMathOperator{\cov}{\text{cov}}
\DeclareMathOperator{\cor}{\text{cor}}
\DeclareMathOperator{\range}{\text{range}}
\DeclareMathOperator{\rank}{\text{rank}}
\DeclareMathOperator{\ind}{\perp\hspace*{-1.1ex}\perp}
\DeclareMathOperator{\CE}{\text{CE}}
\DeclareMathOperator{\BS}{\text{BS}}
\DeclareMathOperator{\ECM}{\text{ECM}}
\DeclareMathOperator{\BSS}{\text{BSS}}
\DeclareMathOperator{\WSS}{\text{WSS}}
\DeclareMathOperator{\TSS}{\text{TSS}}
\DeclareMathOperator{\BIC}{\text{BIC}}
\DeclareMathOperator{\ICL}{\text{ICL}}
\DeclareMathOperator{\CV}{\text{CV}}
\DeclareMathOperator{\diag}{\text{diag}}
\DeclareMathOperator{\se}{\text{se}}
\DeclareMathOperator{\Cov}{\text{Cov}}
\DeclareMathOperator{\boot}{\text{boot}}
\DeclareMathOperator{\LRTS}{\text{LRTS}}
\DeclareMathOperator{\Model}{\mathcal{M}}
\DeclareMathOperator*{\argmin}{arg\min}
\DeclareMathOperator*{\argmax}{arg\max}
\DeclareMathOperator{\vech}{vech}
\DeclareMathOperator{\tr}{tr}
\]</span></p>
<!-- \definecolor{quarto-callout-note-color}{HTML}{4477AA} -->
</div>
<p>This chapter describes the general methodology for Gaussian model-based clustering in <strong>mclust</strong>, including model estimation and selection. Several data examples are presented, in both the multivariate and univariate case. EM algorithm initialization is discussed at some length, as this is a major issue for model-based clustering. Model-based hierarchical agglomerative clustering is also presented, and the corresponding implementation in <strong>mclust</strong> is shown. The chapter concludes by providing some details on performing single E- and M- steps, and on control parameters used by the EM functions in <strong>mclust</strong>.</p>
<section id="gaussian-mixture-models-for-cluster-analysis" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="gaussian-mixture-models-for-cluster-analysis">
<span class="header-section-number">3.1</span> Gaussian Mixture Models for Cluster Analysis</h2>
<p>Cluster analysis <!-- \index{cluster analysis} --> refers to a broad set of multivariate statistical methods and techniques which seek to identify homogeneous subgroups of cases in a dataset, that is, to partition similar observations into meaningful and useful <em>clusters</em>. Cluster analysis is an instance of <em>unsupervised learning</em>, <!-- \index{unsupervised learning} --> since the presence and number of clusters may not be known a priori, nor is case labeling available.</p>
<p>Many approaches to clustering have been proposed in the literature for exploring the underlying group structure of data. Traditional methods are combinatorial in nature, and either <em>hierarchical</em> (agglomerative or divisive) or <em>non-hierarchical</em> (for example, <span class="math inline">\(k\)</span>-means). Although some are related to formal statistical models, they typically are based on heuristic procedures which make no explicit assumptions about the structure of the clusters. The choice of clustering method, similarity measures, and interpretation have tended to be informal and often subjective.</p>
<p><em>Model-based clustering</em> (MBC) is a probabilistic approach to clustering in which each cluster corresponds to a mixture component described by a probability distribution with unknown parameters. The type of distribution is often specified a priori (most commonly Gaussian), whereas the model structure (including the number of components) remains to be determined by parameter estimation and model-selection techniques. Parameters can be estimated by maximum likelihood, using, for instance, the EM algorithm, or by Bayesian approaches. These model-based methods are increasingly favored over heuristic clustering methods. Moreover, the one-to-one relationship between mixture components and clusters can be relaxed, as discussed in <a href="07_miscellanea.html#sec-nongausclust" class="quarto-xref"><span>Section 7.3</span></a>.</p>
<p>Model-based clustering can be viewed as a <em>generative</em> approach because it attempts to learn generative models from the data, with each model representing one particular cluster. It is possible to simulate from an estimated model, as discussed in <a href="07_miscellanea.html#sec-sim" class="quarto-xref"><span>Section 7.4</span></a>, which can be useful for resampling inference, sensitivity, and predictive analysis.</p>
<p>The finite mixture of Gaussian distributions described in <a href="02_mixture.html#sec-GMM" class="quarto-xref"><span>Section 2.2</span></a> is one of the most flexible classes of models for continuous variables and, as such, it has become a method of choice in a wide variety of settings. Component covariance matrices can be parameterized by eigen-decomposition to impose geometric constraints, as described in <a href="02_mixture.html#sec-eigendecomp" class="quarto-xref"><span>Section 2.2.1</span></a>. Constraining some but not all of the quantities in <a href="02_mixture.html#eq-eigendecomp" class="quarto-xref">Equation&nbsp;<span>2.4</span></a> to be equal between clusters yields parsimonious and easily interpretable models, appropriate for diverse clustering situations. Once the parameters of a Gaussian mixture model (GMM) are estimated via EM, a partition <span class="math inline">\(\mathcal{C}=\{ C_1, \dots, C_G \}\)</span> of the data into <span class="math inline">\(G\)</span> clusters can be derived by assigning each observation <span class="math inline">\(\boldsymbol{x}_i\)</span> to the component with the largest conditional probability that <span class="math inline">\(\boldsymbol{x}_i\)</span> arises from that component distribution — the <em>MAP principle</em> discussed in <a href="02_mixture.html#sec-map" class="quarto-xref"><span>Section 2.2.4</span></a>.</p>
<p>The parameterization includes, but is not restricted to, well-known covariance models that are associated with various criteria for hierarchical clustering: equal-volume spherical variance (sum of squares criterion) <span class="citation" data-cites="Ward:1963">(<a href="99_references.html#ref-Ward:1963" role="doc-biblioref">Ward 1963</a>)</span>, constant variance <span class="citation" data-cites="Friedman:Rubin:1967">(<a href="99_references.html#ref-Friedman:Rubin:1967" role="doc-biblioref">Friedman and Rubin 1967</a>)</span>, and unconstrained variance <span class="citation" data-cites="Scott:Symons:1971">(<a href="99_references.html#ref-Scott:Symons:1971" role="doc-biblioref">Scott and Symons 1971</a>)</span>. Moreover, <span class="math inline">\(k\)</span>-means, although it does not make an explicit assumption about the structure of the data, is related to the GMM with spherical, equal volume components <span class="citation" data-cites="Celeux:Govaert:1995">(<a href="99_references.html#ref-Celeux:Govaert:1995" role="doc-biblioref">Celeux and Govaert 1995</a>)</span>.</p>
</section><section id="sec-clust_mclust" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="sec-clust_mclust">
<span class="header-section-number">3.2</span> Clustering in mclust</h2>
<p>The main function to fit GMMs for clustering is called <code>Mclust()</code>. <!-- \index{mclust!\code{Mclust()}} --> This function requires a numeric matrix or data frame, with <span class="math inline">\(n\)</span> observations along the rows and <span class="math inline">\(d\)</span> variables along the columns, to be supplied as the <code>data</code> argument. In the univariate case (<span class="math inline">\(d = 1\)</span>), the data can be input as a vector. The number of mixture components <span class="math inline">\(G\)</span>, and the model name corresponding to the eigen-decomposition discussed in <a href="02_mixture.html#sec-eigendecomp" class="quarto-xref"><span>Section 2.2.1</span></a>, can also be specified. By default, all of the available models are estimated for up to <span class="math inline">\(G=9\)</span> mixture components, but this number can be increased by specifying the argument <code>G</code> accordingly.</p>
<p><a href="#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a> lists the models currently implemented in <strong>mclust</strong>, both in the univariate and multivariate cases. Options for specification of a noise component and a prior distribution are also shown; these will be discussed in <a href="07_miscellanea.html#sec-noise_outliers" class="quarto-xref"><span>Section 7.1</span></a> and <a href="07_miscellanea.html#sec-prior" class="quarto-xref"><span>Section 7.2</span></a>, respectively.</p>
<div id="tbl-mclust" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mclust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.1: Models available in the <strong>mclust</strong> package for hierarchical clustering (HC), Gaussian mixture models (GMM) fitted by the EM algorithm, with noise component or prior (indicates availability).
</figcaption><div aria-describedby="tbl-mclust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 36%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead><tr class="header">
<th>Label</th>
<th>Model</th>
<th>Distribution</th>
<th>HC</th>
<th>GMM</th>
<th>GMM + noise</th>
<th>GMM + prior</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>X</code></td>
<td><span class="math inline">\(\sigma^2\)</span></td>
<td>Univariate</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><code>E</code></td>
<td><span class="math inline">\(\sigma^2\)</span></td>
<td>Univariate</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><code>V</code></td>
<td><span class="math inline">\(\sigma_k^2\)</span></td>
<td>Univariate</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><code>XII</code></td>
<td><span class="math inline">\(\diag(\sigma^2, \ldots, \sigma^2)\)</span></td>
<td>Spherical</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><code>XXI</code></td>
<td><span class="math inline">\(\diag(\sigma_1^2, \ldots, \sigma_d^2)\)</span></td>
<td>Diagonal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><code>XXX</code></td>
<td><span class="math inline">\(\boldsymbol{\Sigma}\)</span></td>
<td>Ellipsoidal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><code>EII</code></td>
<td><span class="math inline">\(\lambda \boldsymbol{I}\)</span></td>
<td>Spherical</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><code>VII</code></td>
<td><span class="math inline">\(\lambda_k \boldsymbol{I}\)</span></td>
<td>Spherical</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><code>EEI</code></td>
<td><span class="math inline">\(\lambda \boldsymbol{\Delta}\)</span></td>
<td>Diagonal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><code>VEI</code></td>
<td><span class="math inline">\(\lambda_k \boldsymbol{\Delta}\)</span></td>
<td>Diagonal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><code>EVI</code></td>
<td><span class="math inline">\(\lambda \boldsymbol{\Delta}_k\)</span></td>
<td>Diagonal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><code>VVI</code></td>
<td><span class="math inline">\(\lambda_k \boldsymbol{\Delta}_k\)</span></td>
<td>Diagonal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><code>EEE</code></td>
<td><span class="math inline">\(\lambda \boldsymbol{U}\boldsymbol{\Delta}\boldsymbol{U}{}^{\!\top}\)</span></td>
<td>Ellipsoidal</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><code>VEE</code></td>
<td><span class="math inline">\(\lambda_k \boldsymbol{U}\boldsymbol{\Delta}\boldsymbol{U}{}^{\!\top}\)</span></td>
<td>Ellipsoidal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td></td>
</tr>
<tr class="odd">
<td><code>EVE</code></td>
<td><span class="math inline">\(\lambda \boldsymbol{U}\boldsymbol{\Delta}_k \boldsymbol{U}{}^{\!\top}\)</span></td>
<td>Ellipsoidal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td></td>
</tr>
<tr class="even">
<td><code>VVE</code></td>
<td><span class="math inline">\(\lambda_k \boldsymbol{U}\boldsymbol{\Delta}_k \boldsymbol{U}{}^{\!\top}\)</span></td>
<td>Ellipsoidal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td></td>
</tr>
<tr class="odd">
<td><code>EEV</code></td>
<td><span class="math inline">\(\lambda \boldsymbol{U}_k \boldsymbol{\Delta}\boldsymbol{U}{}^{\!\top}_k\)</span></td>
<td>Ellipsoidal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><code>VEV</code></td>
<td><span class="math inline">\(\lambda_k \boldsymbol{U}_k \boldsymbol{\Delta}\boldsymbol{U}{}^{\!\top}_k\)</span></td>
<td>Ellipsoidal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><code>EVV</code></td>
<td><span class="math inline">\(\lambda \boldsymbol{U}_k \boldsymbol{\Delta}_k \boldsymbol{U}{}^{\!\top}_k\)</span></td>
<td>Ellipsoidal</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td></td>
</tr>
<tr class="even">
<td><code>VVV</code></td>
<td><span class="math inline">\(\lambda_k \boldsymbol{U}_k \boldsymbol{\Delta}_k \boldsymbol{U}{}^{\!\top}_k\)</span></td>
<td>Ellipsoidal</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The diagram in <a href="#fig-mclust_diagram" class="quarto-xref">Figure&nbsp;<span>3.1</span></a> presents the flow chart of the model-based clustering approach <!-- \index{model-based clustering flow chart}  --> implemented in the function <code>Mclust()</code> of the <strong>mclust</strong> package.</p>
<div id="fig-mclust_diagram" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mclust_diagram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/mclust_diagram.png" class="img-fluid figure-img" style="width:15em">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mclust_diagram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Flow chart of the model-based clustering approach implemented in <strong>mclust</strong>. <span class="math inline">\(\mathcal{G}\)</span> indicates the set containing the number of mixture components, by default <span class="math inline">\(\mathcal{G} = \{1,2,\dots,9\}\)</span>. <span class="math inline">\(\mathcal{M}\)</span> is the set of within-cluster covariance models, by default all of the available models listed in <a href="#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a>. BIC is the default of several model-selection options.
</figcaption></figure>
</div>
<p>Given numerical data, a model-based agglomerative hierarchical clustering (MBAHC) procedure is first applied, for which details are given in <a href="#sec-mbahc" class="quarto-xref"><span>Section 3.6</span></a>. For a set <span class="math inline">\(\mathcal{G}\)</span> giving the numbers of mixture components to consider, and a list <span class="math inline">\(\mathcal{M}\)</span> of models with within-cluster covariance eigen-decomposition chosen from <a href="#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a>, the hierarchical partitions obtained for any number of components in the set <span class="math inline">\(\mathcal{G}\)</span> are used to start the EM algorithm. GMMs are then fit for any combination of elements <span class="math inline">\(G \in \mathcal{G}\)</span> and <span class="math inline">\(M \in \mathcal{M}\)</span>. At the end of the procedure, the model with the best value of the model-selection criterion is returned (BIC is the default for model selection; see {#sec-modsel_cluster} for available options).</p>
<div id="exm-diabetes" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.1</strong></span> &nbsp;&nbsp;<strong>Clustering diabetes data</strong></p>
<p>The <code>diabetes</code> dataset from <span class="citation" data-cites="Reaven:Miller:1979">Reaven and Miller (<a href="99_references.html#ref-Reaven:Miller:1979" role="doc-biblioref">1979</a>)</span>, available in the R package <strong>rrcov</strong> <span class="citation" data-cites="Rpkg:rrcov">(<a href="99_references.html#ref-Rpkg:rrcov" role="doc-biblioref">Todorov 2022</a>)</span>, contains measurements on 145 non-obese adult subjects. A description of the variables is given in the table below.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 90%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>rw</code></td>
<td>Relative weight, expressed as the ratio of actual weight to expected weight, given the subject’s height.</td>
</tr>
<tr class="even">
<td><code>fpg</code></td>
<td>Fasting plasma glucose level.</td>
</tr>
<tr class="odd">
<td><code>glucose</code></td>
<td>Area under the plasma glucose curve.</td>
</tr>
<tr class="even">
<td><code>insulin</code></td>
<td>Area under the plasma insulin curve.</td>
</tr>
<tr class="odd">
<td><code>sspg</code></td>
<td>Steady state plasma glucose level, a measure of insulin resistance.</td>
</tr>
</tbody>
</table>
<p>The <code>glucose</code> and <code>insulin</code> measurements were recorded for a three hour oral glucose tolerance test (OGTT). The subjects are clinically classified into three groups: <code>"normal"</code>, <code>"overt"</code> diabetes (the most advanced stage), and <code>"chemical"</code> diabetes (a latent stage preceding overt diabetes).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"diabetes"</span>, package <span class="op">=</span> <span class="st">"rrcov"</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="va">diabetes</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">Class</span> <span class="op">=</span> <span class="va">diabetes</span><span class="op">$</span><span class="va">group</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span><span class="op">)</span></span>
<span><span class="co">## Class</span></span>
<span><span class="co">##   normal chemical    overt </span></span>
<span><span class="co">##       76       36       33</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data can be shown graphically as in <a href="#fig-diabetes_clpairs" class="quarto-xref">Figure&nbsp;<span>3.2</span></a> with the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clp</span> <span class="op">=</span> <span class="fu">clPairs</span><span class="op">(</span><span class="va">X</span>, <span class="va">Class</span>, lower.panel <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">clPairsLegend</span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, class <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">class</span>, col <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">col</span>, pch <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">pch</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-diabetes_clpairs" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-diabetes_clpairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-diabetes_clpairs-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diabetes_clpairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Pairwise scatterplots for the <code>diabetes</code> data with points marked according to the true classification.
</figcaption></figure>
</div>
</div>
</div>
<p>The <code>clPairs()</code> <!-- \index{mclust!\code{clPairs()}}  --> function is an enhanced version of the base <code><a href="https://rdrr.io/r/graphics/pairs.html">pairs()</a></code> function, which allows data points to be represented by different colors and symbols. The function invisibly returns a list information useful for adding a legend via the <code>clPairsLegend()</code> function.</p>
<p>The following command performs a cluster analysis of the <code>diabetes</code> dataset for an unconstrained covariance model (<code>VVV</code> in the nomenclature of <a href="02_mixture.html#tbl-covar_param" class="quarto-xref">Table&nbsp;<span>2.1</span></a> and <a href="#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a>) with three mixture components:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">3</span>, modelNames <span class="op">=</span> <span class="st">"VVV"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, a summary of the modeling results is printed:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VVV (ellipsoidal, varying volume, shape, and orientation) model</span></span>
<span><span class="co">## with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC     ICL</span></span>
<span><span class="co">##         -2936.8 145 62 -6182.2 -6189.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3 </span></span>
<span><span class="co">## 78 40 27</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By adding the optional argument <code>parameters = TRUE</code>, a more detailed summary can be obtained, including the estimated parameters:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VVV (ellipsoidal, varying volume, shape, and orientation) model</span></span>
<span><span class="co">## with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC     ICL</span></span>
<span><span class="co">##         -2936.8 145 62 -6182.2 -6189.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3 </span></span>
<span><span class="co">## 78 40 27 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2       3 </span></span>
<span><span class="co">## 0.53635 0.27605 0.18760 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##              [,1]     [,2]       [,3]</span></span>
<span><span class="co">## rw        0.93884   1.0478    0.98353</span></span>
<span><span class="co">## fpg      91.76513 102.9543  236.39448</span></span>
<span><span class="co">## glucose 357.21471 508.7962 1127.76651</span></span>
<span><span class="co">## insulin 166.14835 298.1248   78.38848</span></span>
<span><span class="co">## sspg    107.47991 228.7259  338.06062</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">## [,,1]</span></span>
<span><span class="co">##                 rw      fpg   glucose      insulin      sspg</span></span>
<span><span class="co">## rw       0.0160109   0.3703    1.7519   -0.0072541    2.5199</span></span>
<span><span class="co">## fpg      0.3703007  63.8795  128.5895   29.8548772   58.8162</span></span>
<span><span class="co">## glucose  1.7518634 128.5895 2090.3853  269.2839704  408.9926</span></span>
<span><span class="co">## insulin -0.0072541  29.8549  269.2840 2656.1047748  856.5919</span></span>
<span><span class="co">## sspg     2.5198642  58.8162  408.9926  856.5919127 2131.0809</span></span>
<span><span class="co">## [,,2]</span></span>
<span><span class="co">##                rw        fpg    glucose    insulin       sspg</span></span>
<span><span class="co">## rw       0.011785   -0.25403    -2.4794     1.7088     2.2958</span></span>
<span><span class="co">## fpg     -0.254030  210.19848  1035.1415  -242.8201   -74.2975</span></span>
<span><span class="co">## glucose -2.479438 1035.14145  8151.8109 -1301.0449 -1021.8653</span></span>
<span><span class="co">## insulin  1.708775 -242.82013 -1301.0449 24803.2354  2202.7878</span></span>
<span><span class="co">## sspg     2.295790  -74.29753 -1021.8653  2202.7878  2453.5726</span></span>
<span><span class="co">## [,,3]</span></span>
<span><span class="co">##                 rw        fpg   glucose    insulin      sspg</span></span>
<span><span class="co">## rw        0.013712    -3.1314   -16.683     2.7459    3.2804</span></span>
<span><span class="co">## fpg      -3.131374  4910.7530 17669.044 -2208.7550 2630.6654</span></span>
<span><span class="co">## glucose -16.682509 17669.0438 71474.571 -9214.1986 9005.4355</span></span>
<span><span class="co">## insulin   2.745916 -2208.7550 -9214.199  2124.2757 -296.8184</span></span>
<span><span class="co">## sspg      3.280440  2630.6654  9005.435  -296.8184 6392.4694</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following table shows the relationship between the true classes and those defined by the fitted GMM:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span>, Cluster <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##           Cluster</span></span>
<span><span class="co">## Class       1  2  3</span></span>
<span><span class="co">##   normal   70  6  0</span></span>
<span><span class="co">##   chemical  8 28  0</span></span>
<span><span class="co">##   overt     0  6 27</span></span>
<span><span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.65015</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Roughly, the first cluster appears to be associated with normal subjects, the second cluster with chemical diabetes, and the last cluster with subjects suffering from overt diabetes. Also shown is the <em>adjusted Rand index</em> <!-- \index{adjusted Rand index (ARI)}  --> <span class="citation" data-cites="Hubert:Arabie:1985">(ARI, <a href="99_references.html#ref-Hubert:Arabie:1985" role="doc-biblioref">Hubert and Arabie 1985</a>)</span>, which can be used for evaluating a clustering solution. The ARI is a measure of agreement between two partitions, one that is estimated by a statistical procedure ignoring the labeling of the groups and the other that is the true classification. It has zero expected value in the case of a random partition, corresponding to the hypothesis of independent clusterings with fixed marginals, and is bounded above by 1, with higher values representing better partition accuracy. In this case, a better classification could be obtained by including the full range of available covariance models (the default) in the call to <code>Mclust()</code>.</p>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> <!-- \index{mclust!\code{plot.Mclust()}}  --> method associated with <code>Mclust()</code> provides for a variety of displays. For instance, the following code produces a plot showing the clustering partition derived from the fitted GMM:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-diabetes_classif" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-diabetes_classif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-diabetes_classif-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diabetes_classif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Scatterplot matrix of variables in the <code>diabetes</code> data with points colored according to the <strong>mclust</strong> classification, and ellipses corresponding to projections of the <strong>mclust</strong> cluster covariances.
</figcaption></figure>
</div>
</div>
</div>
<p>The resulting plot is shown in <a href="#fig-diabetes_classif" class="quarto-xref">Figure&nbsp;<span>3.3</span></a>, with points marked on the basis of the MAP classification (see <a href="02_mixture.html#sec-map" class="quarto-xref"><span>Section 2.2.4</span></a>), and ellipses showing the projection of the two-dimensional analog of the standard deviation for the cluster covariances of the estimated GMM. The ellipses can be dropped by specifying the optional argument <code>addEllipses = FALSE</code>, and filled ellipses can be obtained with the code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"classification"</span>, fillEllipses <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The previous figures showed scatterplot matrices of all pairs of variables. A subset of pairs plots can be specified using the optional argument <code>dimen</code>. For instance, the following code selects the first two variables (see <a href="#fig-diabetes_classif_fill" class="quarto-xref">Figure&nbsp;<span>3.4</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"classification"</span>, dimens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, fillEllipses <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-diabetes_classif_fill" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-diabetes_classif_fill-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-diabetes_classif_fill-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diabetes_classif_fill-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Scatterplot of a pair of variables in the <code>diabetes</code> data with points marked according to the <strong>mclust</strong> classification, and filled ellipses corresponding to <strong>mclust</strong> cluster covariances.
</figcaption></figure>
</div>
</div>
</div>
<p>Uncertainty associated with the MAP classification (see <a href="02_mixture.html#sec-map" class="quarto-xref"><span>Section 2.2.4</span></a>) can also be represented graphically as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, dimens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, what <span class="op">=</span> <span class="st">"uncertainty"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-diabetes_uncert" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-diabetes_uncert-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-diabetes_uncert-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diabetes_uncert-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Scatterplot of a pair of variables in the <code>diabetes</code> data with points marked according to the clustering, and point size reflecting the corresponding uncertainty of the MAP classification for the <strong>mclust</strong> model.
</figcaption></figure>
</div>
</div>
</div>
<p>The resulting plot is shown in <a href="#fig-diabetes_uncert" class="quarto-xref">Figure&nbsp;<span>3.5</span></a>, where the size of the data points reflects the classification uncertainty. Subsets of variables can also be specified for this type of graph.</p>
<p>Plots can be selected interactively by leaving the <code>what</code> argument unspecified, in which case the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function will supply a menu of options. <a href="06_graphics.html" class="quarto-xref"><span>Chapter 6</span></a> provides a more detailed description of the graphical capabilities available in <strong>mclust</strong> for further fine-tuning.</p>
</div>
<div id="exm-thyroid" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.2</strong></span> &nbsp;&nbsp;<strong>Clustering thyroid disease data</strong></p>
<p>Consider the thyroid disease data <span class="citation" data-cites="Coomans:Broeckaert:1986">(<a href="99_references.html#ref-Coomans:Broeckaert:1986" role="doc-biblioref">Coomans and Broeckaert 1986</a>)</span> that provides the results of five laboratory tests administered to a sample of 215 patients. The tests are used to predict whether a patient’s thyroid can be classified as euthyroidism (normal thyroid gland function), hypothyroidism (underactive thyroid not producing enough thyroid hormone) or hyperthyroidism (overactive thyroid producing and secreting excessive amounts of the free thyroid hormones T3 and/or thyroxine T4). Diagnosis of thyroid function was based on a complete medical record, including anamnesis, scan, and other measurements.</p>
<p>The data is one of several datasets included in the “Thyroid Disease Data Set” of the UCI Machine Learning Repository (<span class="citation" data-cites="UCI:dataset">Dua and Graff (<a href="99_references.html#ref-UCI:dataset" role="doc-biblioref">2017</a>)</span> — see <a href="https://archive.ics.uci.edu/ml/datasets/thyroid+disease" class="uri">https://archive.ics.uci.edu/ml/datasets/thyroid+disease</a>). The data used here, which corresponds to <code>new-thyroid.data</code> and <code>new-thyroid.names</code> in the data folder at the UCI site, is available as a dataset in <strong>mclust</strong>. A description of the variables is given in the table below, and a plot of the data is shown in <a href="#fig-thyroid_clpairs" class="quarto-xref">Figure&nbsp;<span>3.6</span></a>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 81%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>Diagnosis</code></td>
<td>Diagnosis of thyroid operation: Hypo, Normal, and Hyper.</td>
</tr>
<tr class="even">
<td><code>RT3U</code></td>
<td>T3-resin uptake test (percentage).</td>
</tr>
<tr class="odd">
<td><code>T4</code></td>
<td>Total serum thyroxin as measured by the isotopic displacement method.</td>
</tr>
<tr class="even">
<td><code>T3</code></td>
<td>Total serum triiodothyronine as measured by radioimmuno assay.</td>
</tr>
<tr class="odd">
<td><code>TSH</code></td>
<td>Basal thyroid-stimulating hormone (TSH) as measured by radioimmuno assay.</td>
</tr>
<tr class="even">
<td><code>DTSH</code></td>
<td>Maximal absolute difference of TSH value after injection of 200 micro grams of thyrotropin-releasing hormone as compared to the basal value.</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"thyroid"</span>, package <span class="op">=</span> <span class="st">"mclust"</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">thyroid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Class</span> <span class="op">=</span> <span class="va">thyroid</span><span class="op">$</span><span class="va">Diagnosis</span></span>
<span></span>
<span><span class="va">clp</span> <span class="op">=</span> <span class="fu">clPairs</span><span class="op">(</span><span class="va">X</span>, <span class="va">Class</span>, lower.panel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>              symbols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>              colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray50"</span>, <span class="st">"black"</span>, <span class="st">"red3"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu">clPairsLegend</span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, title <span class="op">=</span> <span class="st">"Thyroid diagnosis:"</span>, class <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">class</span>, </span>
<span>              col <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">col</span>, pch <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">pch</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-thyroid_clpairs" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-thyroid_clpairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-thyroid_clpairs-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-thyroid_clpairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Pairwise scatterplots showing the classification for the <code>thyroid</code> gland data.
</figcaption></figure>
</div>
</div>
</div>
<p>In <a href="#exm-diabetes" class="quarto-xref">Example&nbsp;<span>3.1</span></a> we fitted a GMM by specifying both the numbers of mixture components to be considered, using the argument <code>G</code>, and the models for the component-covariance matrices to be used, using the argument <code>modelNames</code>. Users can provide multiple values for both arguments, a vector of integers for <code>G</code>, a vector of character strings for <code>modelNames</code>. By default, <code>G = 1:9</code>, so GMMs with up to nine components are fitted, and all of the available models shown in <a href="#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a> are used for <code>modelNames</code>.</p>
<p>Clustering of the thyroid data is obtained using the following R command:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since we have provided only the data in the function call, selection of both the number of mixture components and the covariance parameterization is done automatically using the default model selection criterion, BIC. We can inspect the table of BIC values for all the <span class="math inline">\(9 \times 14 = 126\)</span> estimated models as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">BIC</span></span>
<span><span class="co">## Bayesian Information Criterion (BIC): </span></span>
<span><span class="co">##       EII     VII     EEI     VEI     EVI     VVI     EEE     VEE</span></span>
<span><span class="co">## 1 -7477.4 -7477.4 -6699.7 -6699.7 -6699.7 -6699.7 -6388.4 -6388.4</span></span>
<span><span class="co">## 2 -7265.4 -6780.9 -6399.7 -5475.4 -5446.6 -5276.3 -6231.3 -5429.6</span></span>
<span><span class="co">## 3 -6971.3 -6404.0 -6081.2 -5471.7 -5110.3 -4777.9 -6228.4 -5273.3</span></span>
<span><span class="co">## 4 -6726.5 -6263.1 -5972.8 -5281.3 -5146.0 -4796.8 -6260.7 -5381.4</span></span>
<span><span class="co">## 5 -6604.0 -6077.5 -5920.8 -5248.8 -4897.4 -4810.9 -6292.6 -5276.0</span></span>
<span><span class="co">## 6 -6574.1 -6002.9 -5893.5 -5230.1 -4945.0 -4854.6 -5946.0 -5291.6</span></span>
<span><span class="co">## 7 -6572.8 -5967.0 -6116.2 -5250.0 -4960.5 -4860.0 -5977.3 -5279.3</span></span>
<span><span class="co">## 8 -6500.2 -5947.6 -6065.9 -5253.0 -5003.5 -4881.4 -5924.7 -5327.2</span></span>
<span><span class="co">## 9 -6370.8 -5904.0 -5579.3 -5244.5 -5089.2 -4876.4 -5696.2 -5273.0</span></span>
<span><span class="co">##       EVE     VVE     EEV     VEV     EVV     VVV</span></span>
<span><span class="co">## 1 -6388.4 -6388.4 -6388.4 -6388.4 -6388.4 -6388.4</span></span>
<span><span class="co">## 2 -5286.3 -5163.6 -5354.9 -5166.4 -5241.5 -5150.8</span></span>
<span><span class="co">## 3 -5036.4 -5453.9 -5272.8 -5181.0 -5048.4 -4809.8</span></span>
<span><span class="co">## 4 -4974.8 -5478.8 -5129.3 -4902.6 -5061.9 -5175.3</span></span>
<span><span class="co">## 5 -5022.6 -5474.2 -5233.9 -4972.1      NA -4959.9</span></span>
<span><span class="co">## 6 -4932.2 -4878.3 -5290.6 -5005.4 -5141.0 -5012.5</span></span>
<span><span class="co">## 7 -5039.8 -4888.7 -5359.3 -5209.3 -5250.2 -5096.8</span></span>
<span><span class="co">## 8 -5086.9 -4909.7 -5376.2 -5070.9 -5347.1 -5129.7</span></span>
<span><span class="co">## 9      NA      NA -5287.7 -5091.2      NA      NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Top 3 models based on the BIC criterion: </span></span>
<span><span class="co">##   VVI,3   VVI,4   VVV,3 </span></span>
<span><span class="co">## -4777.9 -4796.8 -4809.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The missing values (denoted by <code>NA</code>) that appear in the BIC table indicate that a particular model could not be estimated as initialized. This usually happens when a covariance matrix estimate becomes singular during EM. The Bayesian regularization method proposed by <span class="citation" data-cites="Fraley:Raftery:2007a">Fraley and Raftery (<a href="99_references.html#ref-Fraley:Raftery:2007a" role="doc-biblioref">2007</a>)</span> and implemented in <strong>mclust</strong> as described in <a href="07_miscellanea.html#sec-prior" class="quarto-xref"><span>Section 7.2</span></a> addresses this problem.</p>
<p>The top three models are also listed at the bottom of the table. A summary of the top models according to the BIC criterion can also be obtained as</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">BIC</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##            VVI,3     VVI,4     VVV,3     VVI,5     VVI,6</span></span>
<span><span class="co">## BIC      -4777.9 -4796.773 -4809.761 -4810.928 -4854.644</span></span>
<span><span class="co">## BIC diff     0.0   -18.866   -31.854   -33.021   -76.737</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where we have specified that the the top five GMMs should be shown through the optional argument <code>k = 5</code>. This summary is useful because it provides the BIC differences with respect to the best model, namely, the one with the largest BIC. For the interpretation of BIC, see the discussion in <a href="02_mixture.html#sec-infocrit" class="quarto-xref"><span>Section 2.3.1</span></a>.</p>
<p>The BIC values can be displayed graphically using</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"BIC"</span>, </span>
<span>     legendArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"bottomright"</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-thyroid_bic" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-thyroid_bic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-thyroid_bic-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-thyroid_bic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: BIC traces for the GMMs estimated for the <code>thyroid</code> data.
</figcaption></figure>
</div>
</div>
</div>
<p>where we included the optional argument <code>legendArgs</code> to control the placement and format of the legend. The resulting plot of BIC traces is shown in <a href="#fig-thyroid_bic" class="quarto-xref">Figure&nbsp;<span>3.7</span></a>.</p>
<p>The model selected is (<code>VVI</code>,3), a three-component Gaussian mixture with diagonal covariance structure, in which both the volume and shape vary between clusters. We can obtain a full summary of the model estimates as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VVI (diagonal, varying volume and shape) model with 3</span></span>
<span><span class="co">## components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC     ICL</span></span>
<span><span class="co">##           -2303 215 32 -4777.9 -4784.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1   2   3 </span></span>
<span><span class="co">##  35 152  28 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2       3 </span></span>
<span><span class="co">## 0.16310 0.70747 0.12943 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##           [,1]     [,2]     [,3]</span></span>
<span><span class="co">## RT3U 95.536865 110.3462 123.2078</span></span>
<span><span class="co">## T4   17.678383   9.0880   3.7994</span></span>
<span><span class="co">## T3    4.262681   1.7218   1.0576</span></span>
<span><span class="co">## TSH   0.970155   1.3051  13.8951</span></span>
<span><span class="co">## DTSH -0.017415   2.4960  18.8221</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">## [,,1]</span></span>
<span><span class="co">##        RT3U     T4     T3     TSH     DTSH</span></span>
<span><span class="co">## RT3U 343.92  0.000 0.0000 0.00000 0.000000</span></span>
<span><span class="co">## T4     0.00 17.497 0.0000 0.00000 0.000000</span></span>
<span><span class="co">## T3     0.00  0.000 4.9219 0.00000 0.000000</span></span>
<span><span class="co">## TSH    0.00  0.000 0.0000 0.15325 0.000000</span></span>
<span><span class="co">## DTSH   0.00  0.000 0.0000 0.00000 0.071044</span></span>
<span><span class="co">## [,,2]</span></span>
<span><span class="co">##        RT3U     T4      T3     TSH   DTSH</span></span>
<span><span class="co">## RT3U 66.372 0.0000 0.00000 0.00000 0.0000</span></span>
<span><span class="co">## T4    0.000 4.8234 0.00000 0.00000 0.0000</span></span>
<span><span class="co">## T3    0.000 0.0000 0.23278 0.00000 0.0000</span></span>
<span><span class="co">## TSH   0.000 0.0000 0.00000 0.21394 0.0000</span></span>
<span><span class="co">## DTSH  0.000 0.0000 0.00000 0.00000 3.1892</span></span>
<span><span class="co">## [,,3]</span></span>
<span><span class="co">##       RT3U    T4      T3 TSH   DTSH</span></span>
<span><span class="co">## RT3U 95.27 0.000 0.00000   0   0.00</span></span>
<span><span class="co">## T4    0.00 4.278 0.00000   0   0.00</span></span>
<span><span class="co">## T3    0.00 0.000 0.27698   0   0.00</span></span>
<span><span class="co">## TSH   0.00 0.000 0.00000 147   0.00</span></span>
<span><span class="co">## DTSH  0.00 0.000 0.00000   0 231.29</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The clustering implied by the selected model can then be shown graphically as in <a href="#fig-thyroid_classification" class="quarto-xref">Figure&nbsp;<span>3.8</span></a> with the code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-thyroid_classification" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-thyroid_classification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-thyroid_classification-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-thyroid_classification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.8: Scatterplot matrix for the <code>thyroid</code> data with points marked according to the GMM (<code>VVI</code>,3) clustering, and ellipses corresponding to projections of the estimated cluster covariances.
</figcaption></figure>
</div>
</div>
</div>
<p>The confusion matrix for the clustering and the corresponding adjusted Rand index are obtained as:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span>, Cluster <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##         Cluster</span></span>
<span><span class="co">## Class      1   2   3</span></span>
<span><span class="co">##   Hypo     0   4  26</span></span>
<span><span class="co">##   Normal   1 147   2</span></span>
<span><span class="co">##   Hyper   34   1   0</span></span>
<span><span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.87715</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The estimated clustering model turns out to be quite accurate in recovering the true thyroid diagnosis.</p>
<p>A plot of the posterior conditional probabilities ordered by cluster can be obtained using the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">z</span>  <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">z</span>               <span class="co"># posterior conditional probabilities</span></span>
<span><span class="va">cl</span> <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">classification</span>  <span class="co"># MAP clustering</span></span>
<span><span class="va">G</span>  <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">G</span>               <span class="co"># number of clusters</span></span>
<span><span class="va">sclass</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># class separation</span></span>
<span><span class="va">sedge</span> <span class="op">=</span> <span class="fl">3</span>   <span class="co"># edge spacing</span></span>
<span><span class="va">L</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">+</span> <span class="va">G</span><span class="op">*</span><span class="op">(</span><span class="va">sclass</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">sedge</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">L</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Posterior conditional probabilities"</span>, xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">=</span> <span class="va">sclass</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span> <span class="va">i</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">cl</span> <span class="op">==</span> <span class="va">k</span><span class="op">)</span></span>
<span> <span class="va">ord</span> <span class="op">=</span> <span class="va">i</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">i</span>, <span class="va">k</span><span class="op">]</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="op">(</span><span class="va">l</span><span class="op">+</span><span class="va">sedge</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, <span class="va">z</span><span class="op">[</span><span class="va">ord</span>, <span class="va">j</span><span class="op">]</span>, </span>
<span>           pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/rect.html">rect</a></span><span class="op">(</span><span class="va">l</span>, <span class="fl">0</span>, <span class="va">l</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">sedge</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, <span class="fl">1</span>, </span>
<span>      border <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2</span>, density <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span> <span class="va">l</span> <span class="op">=</span> <span class="va">l</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">sedge</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">+</span> <span class="va">sclass</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-thyroid_postprobs" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-thyroid_postprobs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-thyroid_postprobs-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-thyroid_postprobs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.9: Estimated posterior conditional probabilities of class membership for each of the three clusters determined by the MAP classification of observations in the <code>thyroid</code> data. The panels correspond to the different clusters.
</figcaption></figure>
</div>
</div>
</div>
<p>This yields <a href="#fig-thyroid_postprobs" class="quarto-xref">Figure&nbsp;<span>3.9</span></a>, in which a panel of posterior conditional probabilities of class membership is shown for each of the three clusters determined by the MAP classification. The plot shows that observations in the third cluster have the largest probabilities of membership, while there is some uncertainty in membership among the first two clusters.</p>
</div>
<div id="exm-cluster_wine" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.3</strong></span> &nbsp;&nbsp;<strong>Clustering Italian wines data</strong></p>
<p><span class="citation" data-cites="Forina:1986">Forina et al. (<a href="99_references.html#ref-Forina:1986" role="doc-biblioref">1986</a>)</span> reported data on 178 wines grown in the same region in Italy but derived from three different cultivars (Barbera, Barolo, Grignolino). For each wine, 13 measurements of chemical and physical properties were made as reported in the table below. This data set is from the UCI Machine Learning Data Repository (<span class="citation" data-cites="UCI:dataset">Dua and Graff (<a href="99_references.html#ref-UCI:dataset" role="doc-biblioref">2017</a>)</span> — see <a href="http://archive.ics.uci.edu/ml/datasets/Wine" class="uri">http://archive.ics.uci.edu/ml/datasets/Wine</a>) and is available in the <strong>gclus</strong> package <span class="citation" data-cites="Rpkg:gclus">(<a href="99_references.html#ref-Rpkg:gclus" role="doc-biblioref">Hurley 2019</a>)</span>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>Class</code></td>
<td>Wine classes: 1) Barolo; 2) Grignolino; 3) Barbera</td>
</tr>
<tr class="even">
<td><code>Alcohol</code></td>
<td>Alcohol</td>
</tr>
<tr class="odd">
<td><code>Malic</code></td>
<td>Malic acid</td>
</tr>
<tr class="even">
<td><code>Ash</code></td>
<td>Ash</td>
</tr>
<tr class="odd">
<td><code>Alcalinity</code></td>
<td>Alcalinity of ash</td>
</tr>
<tr class="even">
<td><code>Magnesium</code></td>
<td>Magnesium</td>
</tr>
<tr class="odd">
<td><code>Phenols</code></td>
<td>Total phenols</td>
</tr>
<tr class="even">
<td><code>Flavanoids</code></td>
<td>Flavanoids</td>
</tr>
<tr class="odd">
<td><code>Nonflavanoid</code></td>
<td>Nonflavanoid phenols</td>
</tr>
<tr class="even">
<td><code>Proanthocyanins</code></td>
<td>Proanthocyanins</td>
</tr>
<tr class="odd">
<td><code>Intensity</code></td>
<td>Color intensity</td>
</tr>
<tr class="even">
<td><code>Hue</code></td>
<td>Hue</td>
</tr>
<tr class="odd">
<td><code>OD280</code></td>
<td>OD280/OD315 of diluted wines</td>
</tr>
<tr class="even">
<td><code>Proline</code></td>
<td>Proline</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"wine"</span>, package <span class="op">=</span> <span class="st">"gclus"</span><span class="op">)</span></span>
<span><span class="va">Class</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">wine</span><span class="op">$</span><span class="va">Class</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>               labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Barolo"</span>, <span class="st">"Grignolino"</span>, <span class="st">"Barbera"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">wine</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For a description of the data, see <code><a href="https://rdrr.io/pkg/gclus/man/wine.html">help("wine", package = "gclus")</a></code>.</p>
<p>We fit the data with <code>Mclust()</code> for all 14 models, and then summarize the BIC for the top 3 models:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">BIC</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##            VVE,3     EVE,4     VVE,4</span></span>
<span><span class="co">## BIC      -6849.4 -6873.616 -6885.472</span></span>
<span><span class="co">## BIC diff     0.0   -24.225   -36.081</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The BIC traces are then plotted (see <a href="#fig-wine_bic" class="quarto-xref">Figure&nbsp;<span>3.10</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"BIC"</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">BIC</span><span class="op">[</span>, <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>     legendArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bottomleft"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-wine_bic" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-wine_bic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-wine_bic-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wine_bic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.10: BIC plot for models fitted to the <code>wine</code> data.
</figcaption></figure>
</div>
</div>
</div>
<p>Note that, in this last plot, we adjusted the range of the vertical axis so as to remove models with lower BIC values. The model selected by BIC is a three-component Gaussian mixture with covariances having different volumes and shapes, but the same orientation (<code>VVE</code>). This is a flexible but relatively parsimonious model. A summary of the selected model is then obtained:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VVE (ellipsoidal, equal orientation) model with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n  df     BIC     ICL</span></span>
<span><span class="co">##         -3015.3 178 158 -6849.4 -6850.7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3 </span></span>
<span><span class="co">## 59 69 50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##             </span></span>
<span><span class="co">## Class         1  2  3</span></span>
<span><span class="co">##   Barolo     59  0  0</span></span>
<span><span class="co">##   Grignolino  0 69  2</span></span>
<span><span class="co">##   Barbera     0  0 48</span></span>
<span><span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.96674</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The fitted model provides an accurate recovery of the true classes with a high ARI.</p>
<p>Displaying the results is difficult because of the high dimensionality of the data. Below we give a simple method for choosing a subset of variables for a matrix of scatterplots. More sophisticated approaches to choosing projections that reveal clustering are discussed in <a href="06_graphics.html#sec-displaydr" class="quarto-xref"><span>Section 6.4</span></a>. First we plot the estimated cluster means, normalized to the <span class="math inline">\([0,1]\)</span> range, using the heatmap function <!-- \index{heatmap cluster means}  --> available in base R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">norm01</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>, <span class="fl">2</span>, <span class="va">norm01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span><span class="op">(</span><span class="va">M</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, scale <span class="op">=</span> <span class="st">"none"</span>, margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>        labRow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Cluster"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">mod</span><span class="op">$</span><span class="va">G</span><span class="op">)</span>, cexRow <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-wine_heatmap" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-wine_heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-wine_heatmap-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wine_heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.11: Heatmap of normalized cluster means for the clustering model fitted to the <code>wine</code> data.
</figcaption></figure>
</div>
</div>
</div>
<p>The resulting heatmap (see <a href="#fig-wine_heatmap" class="quarto-xref">Figure&nbsp;<span>3.11</span></a>) shows which features have the most different cluster means. Based on this, we select a subset of three variables (<code>Alcohol</code>, <code>Malic</code>, and <code>Flavanoids</code>) for the <code>dimens</code> argument specifying coordinate projections for multivariate data in the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function call:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"classification"</span>, dimens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-wine_scatterplot" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-wine_scatterplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-wine_scatterplot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wine_scatterplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.12: Coordinate projection plot of selected features showing the clusters for the <code>wine</code> data.
</figcaption></figure>
</div>
</div>
</div>
</div>
</section><section id="sec-modsel_cluster" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="sec-modsel_cluster">
<span class="header-section-number">3.3</span> Model Selection</h2>
<section id="sec-modsel_BIC" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="sec-modsel_BIC">
<span class="header-section-number">3.3.1</span> BIC</h3>
<p>In the <strong>mclust</strong> package, BIC is used by default for model selection. The function <code>mclustBIC()</code>, <!-- \index{mclust!\code{mclustBIC()}} --> and indirectly <code>Mclust()</code>, computes a matrix of BIC values for models chosen from <a href="#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a>, and numbers of mixture components as specified.</p>
<div id="exm-oldfaithful" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.4</strong></span> &nbsp;&nbsp;<strong>BIC model selection for the Old Faithful data</strong></p>
<p>As an illustration, consider the bivariate <code>faithful</code> dataset <span class="citation" data-cites="Hardle:1991">(<a href="99_references.html#ref-Hardle:1991" role="doc-biblioref">Härdle 1991</a>)</span>, included in the base R package <strong>datasets</strong>. “Old Faithful” is a geyser located in Yellowstone National Park, Wyoming, USA. The <code>faithful</code> dataset provides the duration of Old Faithful’s eruptions (<code>eruptions</code>, time in minutes) and the waiting times between successive eruptions (<code>waiting</code>, time in minutes). A scatterplot of the data is shown in panel <a href="#fig-faithful_data" class="quarto-xref">Figure&nbsp;<span>3.13</span></a>, obtained using the code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"faithful"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-faithful_data" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-faithful_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful_data-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-faithful_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.13: Scatterplot of the Old Faithful data available in the <code>faithful</code> dataset.
</figcaption></figure>
</div>
</div>
</div>
<p>The following code can be used to compute the BIC values and plot the corresponding BIC traces:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BIC</span> <span class="op">=</span> <span class="fu">mclustBIC</span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span><span class="va">BIC</span></span>
<span><span class="co">## Bayesian Information Criterion (BIC): </span></span>
<span><span class="co">##       EII     VII     EEI     VEI     EVI     VVI     EEE     VEE</span></span>
<span><span class="co">## 1 -4024.7 -4024.7 -3055.8 -3055.8 -3055.8 -3055.8 -2607.6 -2607.6</span></span>
<span><span class="co">## 2 -3453.0 -3458.3 -2354.6 -2350.6 -2352.6 -2346.1 -2325.2 -2323.0</span></span>
<span><span class="co">## 3 -3377.7 -3336.6 -2323.0 -2332.7 -2332.2 -2342.4 -2314.3 -2322.1</span></span>
<span><span class="co">## 4 -3230.3 -3242.8 -2323.7 -2331.3 -2334.7 -2343.5 -2331.2 -2340.2</span></span>
<span><span class="co">## 5 -3149.4 -3129.1 -2327.1 -2350.2 -2347.6 -2351.0 -2360.7 -2347.3</span></span>
<span><span class="co">## 6 -3081.4 -3038.2 -2338.2 -2360.6 -2357.7 -2373.5 -2347.4 -2372.3</span></span>
<span><span class="co">## 7 -2990.4 -2973.4 -2356.5 -2368.5 -2372.9 -2394.7 -2369.3 -2371.2</span></span>
<span><span class="co">## 8 -2978.1 -2935.1 -2364.1 -2384.7 -2389.1 -2413.7 -2376.1 -2390.4</span></span>
<span><span class="co">## 9 -2953.4 -2919.4 -2372.8 -2398.2 -2407.2 -2432.7 -2389.6 -2406.7</span></span>
<span><span class="co">##       EVE     VVE     EEV     VEV     EVV     VVV</span></span>
<span><span class="co">## 1 -2607.6 -2607.6 -2607.6 -2607.6 -2607.6 -2607.6</span></span>
<span><span class="co">## 2 -2324.3 -2320.4 -2329.1 -2325.4 -2327.6 -2322.2</span></span>
<span><span class="co">## 3 -2342.3 -2336.3 -2325.3 -2329.6 -2340.0 -2349.7</span></span>
<span><span class="co">## 4 -2361.8 -2362.5 -2351.5 -2361.1 -2344.7 -2351.5</span></span>
<span><span class="co">## 5 -2351.8 -2368.9 -2356.9 -2368.1 -2364.9 -2379.4</span></span>
<span><span class="co">## 6 -2366.5 -2386.5 -2366.1 -2386.3 -2384.1 -2387.0</span></span>
<span><span class="co">## 7 -2379.8 -2402.2 -2379.1 -2401.3 -2398.7 -2412.4</span></span>
<span><span class="co">## 8 -2403.9 -2426.0 -2393.0 -2425.4 -2415.0 -2442.0</span></span>
<span><span class="co">## 9 -2414.1 -2448.2 -2407.5 -2446.7 -2438.9 -2460.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Top 3 models based on the BIC criterion: </span></span>
<span><span class="co">##   EEE,3   VVE,2   VEE,3 </span></span>
<span><span class="co">## -2314.3 -2320.4 -2322.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BIC</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-faithful_BIC" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-faithful_BIC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful_BIC-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-faithful_BIC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.14: BIC traces for the GMMs estimated for the <code>faithful</code> dataset.
</figcaption></figure>
</div>
</div>
</div>
<p>In this case the BIC supports a three-component GMM with common full covariance matrix (<code>EEE</code> model). Note that, as for the thyroid disease data example, there are missing BIC values (denoted by <code>NA</code>) corresponding to models that could not be estimated as initialized.</p>
<p>By default, <code>mclustBIC</code> computes results for up to 9 components and all available models in <a href="#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a>. Optional arguments can be provided to <code>mclustBIC()</code> allowing fine tuning, such as <code>G</code> for the number of components, and <code>modelNames</code> for specifying the model covariance parameterizations (see <a href="#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a> and <code>help("mclustModelNames")</code> for a description of available model names).</p>
<!--
CF: I chose `x` for this argument, for `extra', but that probably wasn't such a good idea since it's often used to denote the data.
Maybe we should use a different names for the arg while retaining `x` for backward compatibiliy.
-->
<p>Another optional argument, called <code>x</code>, can be used to provide the output from a previous call to <code>mclustBIC()</code>. This is useful if the model space needs to be enlarged by fitting more models (by increasing the number of mixture components and/or specifying additional covariance parameterizations) without the need to recompute the BIC values for those models already fitted. BIC values already available can be provided analogously to <code>Mclust</code> as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">faithful</span>, x <span class="op">=</span> <span class="va">BIC</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="icl" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="icl">
<span class="header-section-number">3.3.2</span> ICL</h3>
<p>Besides the BIC criterion for model selection, the <em>integrated complete-data likelihood</em> (ICL) criterion, described in <a href="02_mixture.html#sec-infocrit" class="quarto-xref"><span>Section 2.3.1</span></a>, is available in <strong>mclust</strong> through the function <code>mclustICL()</code>. <!-- \index{mclust!\code{mclustICL()}}  --> It is invoked similarly to <code>mclustBIC()</code>, and it allows us to select both the model (among those in <a href="#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a>) and the number of mixture components that maximize the ICL criterion.</p>
<div id="exm-oldfaithful_icl" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.5</strong></span> &nbsp;&nbsp;<strong>ICL model selection for the Old Faithful data</strong></p>
<p>Considering again the data in <a href="#exm-oldfaithful" class="quarto-xref">Example&nbsp;<span>3.4</span></a>, ICL values are computed as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ICL</span> <span class="op">=</span> <span class="fu">mclustICL</span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span><span class="va">ICL</span></span>
<span><span class="co">## Integrated Complete-data Likelihood (ICL) criterion: </span></span>
<span><span class="co">##       EII     VII     EEI     VEI     EVI     VVI     EEE     VEE</span></span>
<span><span class="co">## 1 -4024.7 -4024.7 -3055.8 -3055.8 -3055.8 -3055.8 -2607.6 -2607.6</span></span>
<span><span class="co">## 2 -3455.8 -3460.9 -2356.3 -2350.7 -2353.3 -2346.2 -2326.7 -2323.4</span></span>
<span><span class="co">## 3 -3422.8 -3360.3 -2359.5 -2377.3 -2367.5 -2387.7 -2357.8 -2376.5</span></span>
<span><span class="co">## 4 -3265.8 -3272.5 -2372.0 -2413.4 -2402.2 -2436.3 -2468.3 -2452.7</span></span>
<span><span class="co">## 5 -3190.7 -3151.9 -2394.0 -2486.7 -2412.4 -2445.8 -2478.2 -2472.0</span></span>
<span><span class="co">## 6 -3117.4 -3061.3 -2423.0 -2486.8 -2446.9 -2472.6 -2456.2 -2503.9</span></span>
<span><span class="co">## 7 -3022.3 -2995.8 -2476.2 -2519.8 -2446.7 -2496.7 -2464.3 -2466.8</span></span>
<span><span class="co">## 8 -3007.4 -2953.7 -2488.5 -2513.5 -2492.3 -2509.7 -2502.2 -2479.8</span></span>
<span><span class="co">## 9 -2989.1 -2933.1 -2499.9 -2540.4 -2515.0 -2528.6 -2547.1 -2499.9</span></span>
<span><span class="co">##       EVE     VVE     EEV     VEV     EVV     VVV</span></span>
<span><span class="co">## 1 -2607.6 -2607.6 -2607.6 -2607.6 -2607.6 -2607.6</span></span>
<span><span class="co">## 2 -2325.8 -2320.8 -2330.0 -2325.7 -2328.2 -2322.7</span></span>
<span><span class="co">## 3 -2412.0 -2427.0 -2372.4 -2405.3 -2380.3 -2385.2</span></span>
<span><span class="co">## 4 -2459.4 -2440.3 -2414.2 -2419.9 -2385.8 -2407.6</span></span>
<span><span class="co">## 5 -2444.3 -2478.6 -2431.1 -2490.2 -2423.2 -2474.5</span></span>
<span><span class="co">## 6 -2504.8 -2489.1 -2449.6 -2481.4 -2483.8 -2491.6</span></span>
<span><span class="co">## 7 -2499.3 -2496.3 -2465.7 -2506.8 -2490.1 -2519.5</span></span>
<span><span class="co">## 8 -2526.0 -2516.6 -2489.4 -2539.8 -2497.8 -2556.1</span></span>
<span><span class="co">## 9 -2545.7 -2541.7 -2542.9 -2566.7 -2528.6 -2587.2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Top 3 models based on the ICL criterion: </span></span>
<span><span class="co">##   VVE,2   VVV,2   VEE,2 </span></span>
<span><span class="co">## -2320.8 -2322.7 -2323.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A trace of ICL values is plotted and shown in <a href="#fig-faithful_ICL" class="quarto-xref">Figure&nbsp;<span>3.15</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ICL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-faithful_ICL" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-faithful_ICL-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful_ICL-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-faithful_ICL-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.15: ICL traces for the GMMs estimated for the <code>faithful</code> dataset.
</figcaption></figure>
</div>
</div>
</div>
<p>Note that, in this case, ICL selects two components, one less than the number selected by BIC. This is reasonable, since ICL penalizes overlapping components more heavily.</p>
<p>The model selected by ICL can be fitted using</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">faithful</span>, G <span class="op">=</span> <span class="fl">2</span>, modelNames <span class="op">=</span> <span class="st">"VVE"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Optional arguments can also be provided in the <code>Mclust()</code> function call, analogous to those described above for <code>mclustBIC()</code>.</p>
<p>The following code can be used to draw scatterplots of the data with points marked according to the classification obtained by the ``best’’ estimated model selected, respectively, by the BIC and ICL model selection criteria (see <a href="#fig-faithful_GMMs" class="quarto-xref">Figure&nbsp;<span>3.16</span></a>):</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod1</span>, what <span class="op">=</span> <span class="st">"classification"</span>, fillEllipses <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod2</span>, what <span class="op">=</span> <span class="st">"classification"</span>, fillEllipses <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-faithful_GMMs" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-faithful_GMMs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful_GMMs" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful_GMMs-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful_GMMs-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful_GMMs-1.png" id="fig-faithful_GMMs-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful_GMMs">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful_GMMs-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful_GMMs" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful_GMMs-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful_GMMs-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful_GMMs-2.png" id="fig-faithful_GMMs-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful_GMMs">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful_GMMs-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-faithful_GMMs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.16: Scatterplots for the <code>faithful</code> dataset with points and ellipses corresponding to the classification from the best estimated GMMs selected by BIC (a) and ICL (b).
</figcaption></figure>
</div>
</div>
</section><section id="bootstrap-likelihood-ratio-testing" class="level3" data-number="3.3.3"><h3 data-number="3.3.3" class="anchored" data-anchor-id="bootstrap-likelihood-ratio-testing">
<span class="header-section-number">3.3.3</span> Bootstrap Likelihood Ratio Testing</h3>
<p>The bootstrap procedure discussed in <a href="02_mixture.html#sec-bootstrapLRT" class="quarto-xref"><span>Section 2.3.2</span></a> for selecting the number of mixture components is implemented in the <code>mclustBootstrapLRT()</code> function. <!-- \index{mclust!\code{mclustBootstrapLRT()}} --></p>
<div id="exm-oldfaithful_lrt" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.6</strong></span> &nbsp;&nbsp;<strong>Bootstrap LRT for the Old Faithful data</strong></p>
<p>Using the data of {<a href="#exm-oldfaithful" class="quarto-xref">Example&nbsp;<span>3.4</span></a>}, a bootstrap LR test is obtained by specifying the input data and the name of the model to test:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">LRT</span> <span class="op">=</span> <span class="fu">mclustBootstrapLRT</span><span class="op">(</span><span class="va">faithful</span>, modelName <span class="op">=</span> <span class="st">"VVV"</span><span class="op">)</span></span>
<span><span class="va">LRT</span></span>
<span><span class="co">## ------------------------------------------------------------- </span></span>
<span><span class="co">## Bootstrap sequential LRT for the number of mixture components </span></span>
<span><span class="co">## ------------------------------------------------------------- </span></span>
<span><span class="co">## Model        = VVV </span></span>
<span><span class="co">## Replications = 999 </span></span>
<span><span class="co">##              LRTS bootstrap p-value</span></span>
<span><span class="co">## 1 vs 2   319.0654             0.001</span></span>
<span><span class="co">## 2 vs 3     6.1305             0.572</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sequential bootstrap procedure terminates when a test is not significant as specified by the argument <code>level</code> (which is set to <code>0.05</code> by default). There is also the option to specify the maximum number of mixture components to test via the argument <code>maxG</code>. The number of bootstrap resamples can be set with the optional argument <code>nboot</code> (<code>nboot</code> = 999 is the default).</p>
<p>In the example above, the bootstrap <span class="math inline">\(p\)</span>-values clearly indicate the presence of two clusters. Note that models fitted to the original data are estimated via the EM algorithm initialized with unconstrained model-based agglomerative hierarchical clustering (the default). Then, during the bootstrap procedure, models under the null and the alternative hypotheses are fitted to bootstrap samples using again the EM algorithm. However, in this case the algorithm starts with the E-step initialized with the estimated parameters obtained for the original data.</p>
<p>The bootstrap distributions of the LRTS can be shown graphically (see <a href="#fig-faithful_lrt_boot" class="quarto-xref">Figure&nbsp;<span>3.17</span></a>) using the associated plot method:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">LRT</span>, G <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">LRT</span>, G <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-faithful_lrt_boot" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-faithful_lrt_boot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful_lrt_boot" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful_lrt_boot-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful_lrt_boot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful_lrt_boot-1.png" id="fig-faithful_lrt_boot-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful_lrt_boot">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful_lrt_boot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful_lrt_boot" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful_lrt_boot-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful_lrt_boot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful_lrt_boot-2.png" id="fig-faithful_lrt_boot-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful_lrt_boot">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful_lrt_boot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-faithful_lrt_boot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.17: Histograms of LRTS bootstrap distributions for testing the number of mixture components in the <code>faithful</code> data assuming the <code>VVV</code> model. The dotted vertical lines refer to the sample values of LRTS.
</figcaption></figure>
</div>
</div>
</section></section><section id="sec-resamp" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="sec-resamp">
<span class="header-section-number">3.4</span> Resampling-Based Inference in mclust</h2>
<p><a href="02_mixture.html#sec-resamp_inference" class="quarto-xref"><span>Section 2.4</span></a> describes some resampling-based approaches to inference in GMMs, namely the nonparametric bootstrap, the parametric bootstrap, and the weighted likelihood bootstrap. These, together with the <em>jackknife</em> <span class="citation" data-cites="Efron:1979">(<a href="99_references.html#ref-Efron:1979" role="doc-biblioref">Efron 1979, Efron:1982</a>)</span>, are implemented in the <code>MclustBootstrap()</code> function available in <strong>mclust</strong>.</p>
<div id="exm-hemophilia" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.7</strong></span> &nbsp;&nbsp;<strong>Resampling-based inference for Gaussian mixtures on the hemophilia data</strong></p>
<p>Consider the <code>hemophilia</code> dataset <span class="citation" data-cites="Habbema:Hermans:vandenBroek:1974">(<a href="99_references.html#ref-Habbema:Hermans:vandenBroek:1974" role="doc-biblioref">Habbema, Hermans, and Broek 1974</a>)</span> available in the package <strong>rrcov</strong> <span class="citation" data-cites="Rpkg:rrcov">(<a href="99_references.html#ref-Rpkg:rrcov" role="doc-biblioref">Todorov 2022</a>)</span>, which contains two measured variables on 75 women belonging to two groups: 30 of them are non-carriers (normal group) and 45 are known hemophilia A carriers (obligatory carriers).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"hemophilia"</span>, package <span class="op">=</span> <span class="st">"rrcov"</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="va">hemophilia</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">Class</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">hemophilia</span><span class="op">$</span><span class="va">gr</span><span class="op">)</span> </span>
<span><span class="va">clp</span> <span class="op">=</span> <span class="fu">clPairs</span><span class="op">(</span><span class="va">X</span>, <span class="va">Class</span>, symbols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">0</span><span class="op">)</span>, colors <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu">clPairsLegend</span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, class <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">class</span>, col <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">col</span>, pch <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">pch</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The last command plots the known classification of the observed data (see <a href="#fig-hemophilia-1" class="quarto-xref">Figure&nbsp;<span>3.18 (a)</span></a>).</p>
<p>By analogy with the analysis of <span class="citation" data-cites="Basford:Greenway:McLachlan:Peel:1997">Basford et al. (<a href="99_references.html#ref-Basford:Greenway:McLachlan:Peel:1997" role="doc-biblioref">1997</a>, Example II, Section 5)</span>, we fitted a two-component GMM with unconstrained covariance matrices:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">2</span>, modelName <span class="op">=</span> <span class="st">"VVV"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VVV (ellipsoidal, varying volume, shape, and orientation) model</span></span>
<span><span class="co">## with 2 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood  n df    BIC    ICL</span></span>
<span><span class="co">##          77.029 75 11 106.56 92.855</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2 </span></span>
<span><span class="co">## 39 36 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2 </span></span>
<span><span class="co">## 0.51015 0.48985 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##                  [,1]      [,2]</span></span>
<span><span class="co">## AHFactivity -0.116124 -0.366387</span></span>
<span><span class="co">## AHFantigen  -0.024573 -0.045323</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">## [,,1]</span></span>
<span><span class="co">##             AHFactivity AHFantigen</span></span>
<span><span class="co">## AHFactivity   0.0113599  0.0065959</span></span>
<span><span class="co">## AHFantigen    0.0065959  0.0123872</span></span>
<span><span class="co">## [,,2]</span></span>
<span><span class="co">##             AHFactivity AHFantigen</span></span>
<span><span class="co">## AHFactivity    0.015874   0.015050</span></span>
<span><span class="co">## AHFantigen     0.015050   0.032341</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that, in the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> <!-- \index{mclust!\code{summary.Mclust()}}  --> function call, we set <code>parameters = TRUE</code> to retrieve the estimated parameters. The clustering structure identified is shown in <a href="#fig-hemophilia-2" class="quarto-xref">Figure&nbsp;<span>3.18 (b)</span></a> and can be obtained as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"classification"</span>, fillEllipses <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-hemophilia" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-hemophilia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hemophilia" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hemophilia-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hemophilia-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hemophilia-1.png" id="fig-hemophilia-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hemophilia">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hemophilia-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hemophilia" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hemophilia-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hemophilia-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hemophilia-2.png" id="fig-hemophilia-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hemophilia">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hemophilia-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hemophilia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.18: Scatterplots for the <code>hemophilia</code> data displaying the true class membership (a) and the classification obtained from the fit of a GMM (b).
</figcaption></figure>
</div>
<p>A function, <code>MclustBootstrap()</code>, <!-- \index{mclust!\code{MclustBootstrap()}} --> is available for bootstrap inference for GMMs. This function requires the user to input an object as returned by a call to <code>Mclust()</code>. Optionally, the number of bootstrap resamples (<code>nboot</code>) and the type of bootstrap resampling to use (<code>type</code>), can also be specified. By default, <code>nboot = 999</code> and <code>type = "bs"</code>, with the latter specifying the nonparametric bootstrap. Thus, a simple call for computing the bootstrap distribution of the GMM parameters is the following:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">boot</span> <span class="op">=</span> <span class="fu">MclustBootstrap</span><span class="op">(</span><span class="va">mod</span>, nboot <span class="op">=</span> <span class="fl">999</span>, type <span class="op">=</span> <span class="st">"bs"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that, although we have included the arguments <code>nboot</code> and <code>type</code>, they could have been omitted in this instance since they are both set at their defaults.</p>
<p>Results of the function <code>MclustBootstrap()</code> are available through the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method, which by default returns the standard errors of the GMM parameters:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">boot</span>, what <span class="op">=</span> <span class="st">"se"</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------------- </span></span>
<span><span class="co">## Resampling standard errors </span></span>
<span><span class="co">## ---------------------------------------------------------- </span></span>
<span><span class="co">## Model                      = VVV </span></span>
<span><span class="co">## Num. of mixture components = 2 </span></span>
<span><span class="co">## Replications               = 999 </span></span>
<span><span class="co">## Type                       = nonparametric bootstrap </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2 </span></span>
<span><span class="co">## 0.12032 0.12032 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##                    1        2</span></span>
<span><span class="co">## AHFactivity 0.037581 0.041488</span></span>
<span><span class="co">## AHFantigen  0.030828 0.062937</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">## [,,1]</span></span>
<span><span class="co">##             AHFactivity AHFantigen</span></span>
<span><span class="co">## AHFactivity   0.0065336  0.0044027</span></span>
<span><span class="co">## AHFantigen    0.0044027  0.0030834</span></span>
<span><span class="co">## [,,2]</span></span>
<span><span class="co">##             AHFactivity AHFantigen</span></span>
<span><span class="co">## AHFactivity   0.0062451  0.0056968</span></span>
<span><span class="co">## AHFantigen    0.0056968  0.0093190</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Bootstrap percentile confidence intervals, described in <a href="02_mixture.html#sec-resamp_inference" class="quarto-xref"><span>Section 2.4</span></a>, can also be obtained by specifying <code>what = "ci"</code> in the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> call. The confidence level of the intervals can also be specified (by default, <code>conf.level = 0.95</code>). For instance:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">boot</span>, what <span class="op">=</span> <span class="st">"ci"</span>, conf.level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------------- </span></span>
<span><span class="co">## Resampling confidence intervals </span></span>
<span><span class="co">## ---------------------------------------------------------- </span></span>
<span><span class="co">## Model                      = VVV </span></span>
<span><span class="co">## Num. of mixture components = 2 </span></span>
<span><span class="co">## Replications               = 999 </span></span>
<span><span class="co">## Type                       = nonparametric bootstrap </span></span>
<span><span class="co">## Confidence level           = 0.9 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##           1       2</span></span>
<span><span class="co">## 5%  0.37514 0.22068</span></span>
<span><span class="co">## 95% 0.77932 0.62486</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">## [,,1]</span></span>
<span><span class="co">##     AHFactivity AHFantigen</span></span>
<span><span class="co">## 5%     -0.20610  -0.079998</span></span>
<span><span class="co">## 95%    -0.08424   0.020474</span></span>
<span><span class="co">## [,,2]</span></span>
<span><span class="co">##     AHFactivity AHFantigen</span></span>
<span><span class="co">## 5%     -0.43889  -0.132681</span></span>
<span><span class="co">## 95%    -0.30504   0.097313</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">## [,,1]</span></span>
<span><span class="co">##     AHFactivity AHFantigen</span></span>
<span><span class="co">## 5%    0.0056903  0.0081596</span></span>
<span><span class="co">## 95%   0.0265706  0.0181777</span></span>
<span><span class="co">## [,,2]</span></span>
<span><span class="co">##     AHFactivity AHFantigen</span></span>
<span><span class="co">## 5%    0.0050765  0.0096963</span></span>
<span><span class="co">## 95%   0.0247648  0.0423184</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The bootstrap distribution of the parameters can also be represented graphically. For instance, the following code produces a plot of the bootstrap distribution for the mixing proportions:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">boot</span>, what <span class="op">=</span> <span class="st">"pro"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-hemophilia_boot1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-hemophilia_boot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hemophilia_boot1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hemophilia_boot1-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hemophilia_boot1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hemophilia_boot1-1.png" id="fig-hemophilia_boot1-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hemophilia_boot1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hemophilia_boot1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hemophilia_boot1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hemophilia_boot1-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hemophilia_boot1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hemophilia_boot1-2.png" id="fig-hemophilia_boot1-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hemophilia_boot1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hemophilia_boot1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hemophilia_boot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.19: Bootstrap distribution for the mixture proportions of the GMM fitted to the <code>hemophilia</code> data. The vertical dotted lines indicate the MLEs, the bottom line indicates the percentile confidence intervals, and the square shows the center of the bootstrap distribution.
</figcaption></figure>
</div>
<p>and for the component means:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">boot</span>, what <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-hemophilia_boot2" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-hemophilia_boot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hemophilia_boot2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hemophilia_boot2-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hemophilia_boot2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hemophilia_boot2-1.png" id="fig-hemophilia_boot2-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hemophilia_boot2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hemophilia_boot2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hemophilia_boot2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hemophilia_boot2-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hemophilia_boot2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hemophilia_boot2-2.png" id="fig-hemophilia_boot2-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hemophilia_boot2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hemophilia_boot2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hemophilia_boot2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hemophilia_boot2-3" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hemophilia_boot2-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hemophilia_boot2-3.png" id="fig-hemophilia_boot2-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hemophilia_boot2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hemophilia_boot2-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hemophilia_boot2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hemophilia_boot2-4" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hemophilia_boot2-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hemophilia_boot2-4.png" id="fig-hemophilia_boot2-4" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hemophilia_boot2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hemophilia_boot2-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hemophilia_boot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.20: Bootstrap distribution for the mixture component means of the GMM fitted to the <code>hemophilia</code> data. The vertical dotted lines indicate the MLEs, the bottom line indicates the percentile confidence intervals, and the square shows the center of the bootstrap distribution.
</figcaption></figure>
</div>
<p>The resulting plots are shown in <a href="#fig-hemophilia_boot1" class="quarto-xref">Figure&nbsp;<span>3.19</span></a> and <a href="#fig-hemophilia_boot2" class="quarto-xref">Figure&nbsp;<span>3.20</span></a>.</p>
<p>As mentioned, with the function <code>MclustBootstrap()</code>, it is also possible to choose the parametric bootstrap (<code>type = "pb"</code>), the weighted likelihood bootstrap (<code>type = "wlbs"</code>), or the jackknife (<code>type = "jk"</code>). For instance, in our data example the weighted likelihood bootstrap can be obtained as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wlboot</span> <span class="op">=</span> <span class="fu">MclustBootstrap</span><span class="op">(</span><span class="va">mod</span>, nboot <span class="op">=</span> <span class="fl">999</span>, type <span class="op">=</span> <span class="st">"wlbs"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">wlboot</span>, what <span class="op">=</span> <span class="st">"se"</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------------- </span></span>
<span><span class="co">## Resampling standard errors </span></span>
<span><span class="co">## ---------------------------------------------------------- </span></span>
<span><span class="co">## Model                      = VVV </span></span>
<span><span class="co">## Num. of mixture components = 2 </span></span>
<span><span class="co">## Replications               = 999 </span></span>
<span><span class="co">## Type                       = weighted likelihood bootstrap </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2 </span></span>
<span><span class="co">## 0.12062 0.12062 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##                    1        2</span></span>
<span><span class="co">## AHFactivity 0.037307 0.040271</span></span>
<span><span class="co">## AHFantigen  0.029360 0.064102</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">## [,,1]</span></span>
<span><span class="co">##             AHFactivity AHFantigen</span></span>
<span><span class="co">## AHFactivity   0.0063976  0.0042667</span></span>
<span><span class="co">## AHFantigen    0.0042667  0.0029802</span></span>
<span><span class="co">## [,,2]</span></span>
<span><span class="co">##             AHFactivity AHFantigen</span></span>
<span><span class="co">## AHFactivity   0.0056345  0.0057299</span></span>
<span><span class="co">## AHFantigen    0.0057299  0.0093274</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this case the differences between the nonparametric and the weighted likelihood bootstrap are negligible. We can summarize the inference for the GMM component means obtained under the two approaches graphically, showing the bootstrap percentile confidence intervals for each variable and component (see <a href="#fig-hemophilia_boot3" class="quarto-xref">Figure&nbsp;<span>3.21</span></a>):</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">boot.ci</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">boot</span>, what <span class="op">=</span> <span class="st">"ci"</span><span class="op">)</span></span>
<span><span class="va">wlboot.ci</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">wlboot</span>, what <span class="op">=</span> <span class="st">"ci"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">mod</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">mod</span><span class="op">$</span><span class="va">G</span>, <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="va">j</span>, <span class="op">]</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">mod</span><span class="op">$</span><span class="va">G</span>, pch <span class="op">=</span> <span class="fl">15</span>,</span>
<span>       ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, xlab <span class="op">=</span> <span class="st">"Mixture component"</span>,</span>
<span>       ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">boot.ci</span><span class="op">$</span><span class="va">mean</span>, <span class="va">wlboot.ci</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>, </span>
<span>       xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="va">mod</span><span class="op">$</span><span class="va">G</span><span class="op">+</span><span class="fl">.5</span><span class="op">)</span>, xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">mod</span><span class="op">$</span><span class="va">G</span><span class="op">+</span><span class="fl">0.2</span>, <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="va">j</span>, <span class="op">]</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">mod</span><span class="op">$</span><span class="va">G</span>, pch <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, at <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">mod</span><span class="op">$</span><span class="va">G</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">boot.ci</span>, </span>
<span>       <span class="fu">errorBars</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">G</span>, <span class="va">mean</span><span class="op">[</span><span class="fl">1</span>, <span class="va">j</span>, <span class="op">]</span>, <span class="va">mean</span><span class="op">[</span><span class="fl">2</span>, <span class="va">j</span>, <span class="op">]</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">wlboot.ci</span>, </span>
<span>       <span class="fu">errorBars</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">+</span><span class="fl">0.2</span>, <span class="va">mean</span><span class="op">[</span><span class="fl">1</span>, <span class="va">j</span>, <span class="op">]</span>, <span class="va">mean</span><span class="op">[</span><span class="fl">2</span>, <span class="va">j</span>, <span class="op">]</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-hemophilia_boot3" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-hemophilia_boot3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hemophilia_boot3" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hemophilia_boot3-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="80%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hemophilia_boot3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hemophilia_boot3-1.png" id="fig-hemophilia_boot3-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:80.0%" data-ref-parent="fig-hemophilia_boot3">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hemophilia_boot3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hemophilia_boot3" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hemophilia_boot3-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="80%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hemophilia_boot3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hemophilia_boot3-2.png" id="fig-hemophilia_boot3-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:80.0%" data-ref-parent="fig-hemophilia_boot3">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hemophilia_boot3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hemophilia_boot3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.21: Bootstrap percentile intervals for the means of the GMM fitted to the <code>hemophilia</code> data. Solid lines refer to the nonparametric bootstrap, dashed lines to the weighted likelihood bootstrap.
</figcaption></figure>
</div>
</div>
</section><section id="sec-clustone" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="sec-clustone">
<span class="header-section-number">3.5</span> Clustering Univariate Data</h2>
<p>For clustering univariate data, the quantiles of the empirical distribution are used to initialize the EM algorithm by default, rather than hierarchical clustering. There are only two possible models, <code>E</code> for equal variance across components and <code>V</code> allowing the variance to vary across the components.</p>
<div id="exm-precip" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.8</strong></span> &nbsp;&nbsp;<strong>Univariate clustering of annual precipitation in US cities</strong></p>
<p>As an example of univariate clustering, consider the <code>precip</code> dataset <span class="citation" data-cites="McNeil:1977">(<a href="99_references.html#ref-McNeil:1977" role="doc-biblioref">McNeil 1977</a>)</span> included in the package <strong>datasets</strong> available in the base R distribution:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"precip"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/dotchart.html">dotchart</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">precip</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.6</span>, pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">"Average annual rainfall (in inches)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-precip_dotchart" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-precip_dotchart-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-precip_dotchart-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-precip_dotchart-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.22: Dot chart of average annual rainfall (in inches) for 70 US cities.
</figcaption></figure>
</div>
</div>
</div>
<p>The average amount of rainfall (in inches) for each of 70 US cities is shown as a dot chart in <a href="#fig-precip_dotchart" class="quarto-xref">Figure&nbsp;<span>3.22</span></a>. A clustering model is then obtained as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">precip</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust V (univariate, unequal variance) model with 2 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood  n df     BIC     ICL</span></span>
<span><span class="co">##         -275.47 70  5 -572.19 -575.21</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2 </span></span>
<span><span class="co">## 13 57 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2 </span></span>
<span><span class="co">## 0.18137 0.81863 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##      1      2 </span></span>
<span><span class="co">## 12.793 39.780 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">##      1      2 </span></span>
<span><span class="co">## 16.813 90.394</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"BIC"</span>, legendArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bottomleft"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-precip_bic" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-precip_bic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-precip_bic-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-precip_bic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.23: BIC traces for GMMs fitted to the <code>precip</code> data.
</figcaption></figure>
</div>
</div>
</div>
<p>The selected model is a two-component Gaussian mixture with different variances. The first cluster, which includes 13 cities, is characterized by both smaller means and variances compared to the second cluster. The clustering partition and the corresponding classification uncertainties can be displayed using the following plot commands (see <a href="#fig-precip_classif_uncert" class="quarto-xref">Figure&nbsp;<span>3.24</span></a>):</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"uncertainty"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-precip_classif_uncert" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-precip_classif_uncert-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-precip_classif_uncert" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-precip_classif_uncert-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-precip_classif_uncert-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-precip_classif_uncert-1.png" id="fig-precip_classif_uncert-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-precip_classif_uncert">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-precip_classif_uncert-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-precip_classif_uncert" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-precip_classif_uncert-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-precip_classif_uncert-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-precip_classif_uncert-2.png" id="fig-precip_classif_uncert-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-precip_classif_uncert">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-precip_classif_uncert-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-precip_classif_uncert-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.24: Classification (a) and uncertainty (b) plots for the <code>precip</code> data.
</figcaption></figure>
</div>
<p>The final clustering is shown in a dot chart with observations grouped by clusters (see <a href="#fig-precip_dotchart_cluster" class="quarto-xref">Figure&nbsp;<span>3.25</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">precip</span>, clusters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/make.unique.html">make.unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">precip</span><span class="op">)</span><span class="op">)</span> <span class="co"># correct duplicated names </span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">precip</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/dotchart.html">dotchart</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">precip</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>         groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">clusters</span>, levels <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">1</span>, </span>
<span>                         labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cluster 2"</span>, <span class="st">"Cluster 1"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         cex <span class="op">=</span> <span class="fl">0.6</span>, pch <span class="op">=</span> <span class="fl">19</span>, </span>
<span>         color <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">clusters</span><span class="op">]</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">"Average annual rainfall (in inches)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-precip_dotchart_cluster" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-precip_dotchart_cluster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-precip_dotchart_cluster-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-precip_dotchart_cluster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.25: Dot chart of average annual rainfall (in inches) for 70 US cities grouped by the estimated clustering partitions.
</figcaption></figure>
</div>
</div>
</div>
<p>Each of the graphs shown indicates that the two groups of cities are separated by about 20 inches of annual rainfall.</p>
</div>
<p>Further graphical capabilities for univariate data are discussed in <a href="06_graphics.html#sec-display1" class="quarto-xref"><span>Section 6.1</span></a>.</p>
</section><section id="sec-mbahc" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="sec-mbahc">
<span class="header-section-number">3.6</span> Model-Based Agglomerative Hierarchical Clustering</h2>
<p>Model-based agglomerative hierarchical clustering <span class="citation" data-cites="Banfield:Raftery:1993">(MBAHC, <a href="99_references.html#ref-Banfield:Raftery:1993" role="doc-biblioref">Banfield and Raftery 1993</a>)</span> adopts the general ideas of classical agglomerative hierarchical clustering, with the aim of obtaining a hierarchy of clusters of <span class="math inline">\(n\)</span> objects. Given no preliminary information with regard to grouping, agglomerative hierarchical clustering proceeds from <span class="math inline">\(n\)</span> clusters each containing a single observation, to one cluster containing all <span class="math inline">\(n\)</span> observations, by successively merging observations and clusters. In the traditional approach, two groups are merged if they are closest according to a particular distance metric and type of linkage, while in MBAHC, the two groups are merged that optimize a regularized criterion <span class="citation" data-cites="Fraley:1998">(<a href="99_references.html#ref-Fraley:1998" role="doc-biblioref">Fraley 1998</a>)</span> derived from the classification likelihood over all possible merge pairs.</p>
<p>Given <span class="math inline">\(n\)</span> observations <span class="math inline">\((\boldsymbol{x}_1, \dots, \boldsymbol{x}_n)\)</span>, let <span class="math inline">\((\ell_1, \dots, \ell_n){}^{\!\top}\)</span> denote the classification labels, so that <span class="math inline">\(\ell_i=k\)</span> if <span class="math inline">\(\boldsymbol{x}_i\)</span> is assigned to cluster <span class="math inline">\(k\)</span>. The unknown parameters are obtained by maximizing the classification likelihood: <!-- \index{classification likelihood} --> <span class="math display">\[
L_{CL}(\boldsymbol{\theta}_1, \dots, \boldsymbol{\theta}_G, \ell_1, \dots, \ell_n ; \boldsymbol{x}_1, \dots, \boldsymbol{x}_n) =
\prod_{i=1}^n f_{\ell_i}(\boldsymbol{x}_i ; \boldsymbol{\theta}_{\ell_i}).
\]</span> Assuming a multivariate Gaussian distribution for the data, so that <span class="math inline">\(f_{\ell_i}(\boldsymbol{x}_i ; \boldsymbol{\theta}_{\ell_i}) = \phi(\boldsymbol{x}_i ; \boldsymbol{\mu}_k,\boldsymbol{\Sigma}_k)\)</span> if <span class="math inline">\(\ell_i=k\)</span>, the classification likelihood is <span class="math display">\[
L_{CL}(\boldsymbol{\mu}_1, \dots, \boldsymbol{\mu}_G, \boldsymbol{\Sigma}_1, \dots, \boldsymbol{\Sigma}_G, \ell_1, \dots, \ell_n ; \boldsymbol{x}_1, \dots, \boldsymbol{x}_n) = \\
\prod_{k=1}^G \prod_{i \in \mathcal{I}_k} \phi(\boldsymbol{x}_i ; \boldsymbol{\mu}_k,\boldsymbol{\Sigma}_k),
\]</span> where <span class="math inline">\(\mathcal{I}_k = \{ i : \ell_i = k \}\)</span> is the set of indices corresponding to the observations that belong to cluster <span class="math inline">\(k\)</span>. After replacing the unknown mean vectors <span class="math inline">\(\boldsymbol{\mu}_k\)</span> by their MLEs, <span class="math inline">\(\widehat{\boldsymbol{\mu}}_k = \bar{\boldsymbol{x}}_k\)</span>, the profile (or concentrated) log-likelihood is given by <span id="eq-mbahc_loglik"><span class="math display">\[
\begin{multline}
\log L_{CL}(\boldsymbol{\Sigma}_1, \dots, \boldsymbol{\Sigma}_G, \ell_1, \dots, \ell_n ; \boldsymbol{x}_1, \dots, \boldsymbol{x}_n) = \\
-\frac{1}{2} nd \log(2\pi) -\frac{1}{2} \sum_{k=1}^G \{ \tr(\boldsymbol{W}_k \boldsymbol{\Sigma}_k^{-1}) + n_k \log|\boldsymbol{\Sigma}_k| \},
\end{multline}
\tag{3.1}\]</span></span> where <span class="math inline">\(\boldsymbol{W}_k = \sum_{i \in \mathcal{I}_k} (\boldsymbol{x}_i - \bar{\boldsymbol{x}}_k)(\boldsymbol{x}_i - \bar{\boldsymbol{x}}_k){}^{\!\top}\)</span> is the sample cross-product matrix for the <span class="math inline">\(k\)</span>th cluster, and <span class="math inline">\(n_k\)</span> is the number of observations in cluster <span class="math inline">\(k\)</span>.</p>
<p>By imposing different covariance structures on <span class="math inline">\(\boldsymbol{\Sigma}_k\)</span>, different merging criteria can be derived <span class="citation" data-cites="Fraley:1998">(see <a href="99_references.html#ref-Fraley:1998" role="doc-biblioref">Fraley 1998</a>, Table 1)</span>. For instance, assuming a common isotropic cluster-covariance, <span class="math inline">\(\boldsymbol{\Sigma}_k = \sigma^2\boldsymbol{I}\)</span>, the log-likelihood in <a href="#eq-mbahc_loglik" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> is maximized by minimizing the criterion <span class="math display">\[
\tr\left( \sum_{k=1}^G \boldsymbol{W}_k \right),
\]</span> the well-known sum of squares criterion of <span class="citation" data-cites="Ward:1963">Ward (<a href="99_references.html#ref-Ward:1963" role="doc-biblioref">1963</a>)</span>. If the covariances are allowed to be different across clusters, then the criterion to be minimized at each stage of the hierarchical algorithm is <span class="math display">\[
\sum_{k=1}^G n_k \log \left| \frac{\boldsymbol{W}_k}{n_k} \right|.
\]</span> Methods for regularizing these criteria and efficient numerical algorithms for their minimization have been discussed by <span class="citation" data-cites="Fraley:1998">Fraley (<a href="99_references.html#ref-Fraley:1998" role="doc-biblioref">1998</a>)</span>. <a href="#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a> lists the models for hierarchical clustering available in <strong>mclust</strong>.</p>
<p>At each stage of MBAHC, a pair of groups is merged that minimizes a regularized merge criterion over all possible merge pairs <span class="citation" data-cites="Fraley:1998">(<a href="99_references.html#ref-Fraley:1998" role="doc-biblioref">Fraley 1998</a>)</span>. Regularization is necessary because cluster contributions to the merge criterion (and the classification likelihood) are undefined for singletons, as well as for other combinations of observations resulting in a singular or near-singular sample covariance.</p>
<p>Traditional hierarchical clustering procedures, as implemented, for example, in the base R function <code><a href="https://rdrr.io/r/stats/hclust.html">hclust()</a></code>, are typically represented graphically with a <em>dendrogram</em> <!-- \index{dendrogram}  --> that shows the links between objects using a tree diagram, usually with the root at the top and leaves at the bottom. The height of the branches reflects the order in which the clusters are joined, and, to some extent, it also reflects the distances between clusters <span class="citation" data-cites="Hastie:Tibshirani:Friedman:2009">(see, for example, <a href="99_references.html#ref-Hastie:Tibshirani:Friedman:2009" role="doc-biblioref">Hastie, Tibshirani, and Friedman 2009, sec. 14.3.12</a>)</span>.</p>
<p>Because the regularized merge criterion may either increase or decrease from stage to stage, the association of a positive distance with merges in traditional hierarchical clustering does not apply to MBAHC. However, it is still possible to draw a dendrogram in the which the tree height increases as the number of groups decreases, so that the root is at the top of the hierarchy. Moreover, the classification likelihood often increases in the later stages of merging (small numbers of clusters), in which case the corresponding dendrogram can be drawn.</p>
<p><strong>mclust</strong> provides the function <code>hc()</code> <!-- \index{mclust!\code{hc()}}  --> to perform model-based agglomerative hierarchical clustering. It takes the data matrix to be clustered as the main argument. The principal optional arguments are as follows:</p>
<ul>
<li><p><code>modelName</code>: for selecting the model to fit among the four models available, which, following the nomenclature in <a href="02_mixture.html#tbl-covar_param" class="quarto-xref">Table&nbsp;<span>2.1</span></a>, are denoted as <code>EII</code>, <code>VII</code>, <code>EEE</code>, and <code>VVV</code> (default).</p></li>
<li><p><code>partition</code>: for providing an initial partition from which to start the agglomeration. The default is to start with partitioning into unique observations.</p></li>
<li><p><code>use</code>: for specifying the data transformation to apply before performing hierarchical clustering. By default <code>use = "VARS"</code>, so the variables are expressed in the original scale. Other possible values, including the default for initialization of the EM algorithm in model-based clustering, are described in <a href="#sec-mclust_init" class="quarto-xref"><span>Section 3.7</span></a>.</p></li>
</ul>
<div id="exm-unemployment" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.9</strong></span> &nbsp;&nbsp;<strong>Model-based hierarchical cluastering of European unemployment data</strong></p>
<p>Consider the <code>EuroUnemployment</code> dataset which provides unemployment rates for 31 European countries for the year 2014. The considered rates are shown in the table below.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>TUR</code></td>
<td>Total unemployment rate, defined as the percentage of unemployed persons aged 15–74 in the economically active population.</td>
</tr>
<tr class="even">
<td><code>YUR</code></td>
<td>Youth unemployment rate, defined as the percentage of unemployed persons aged 15–24 in the economically active population.</td>
</tr>
<tr class="odd">
<td><code>LUR</code></td>
<td>Long-term unemployment rate, defined as the percentage of unemployed persons who have been unemployed for 12 months or more.</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"EuroUnemployment"</span>, package <span class="op">=</span> <span class="st">"mclust"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">EuroUnemployment</span><span class="op">)</span></span>
<span><span class="co">##       TUR             YUR            LUR       </span></span>
<span><span class="co">##  Min.   : 3.50   Min.   : 7.7   Min.   : 0.60  </span></span>
<span><span class="co">##  1st Qu.: 6.35   1st Qu.:15.4   1st Qu.: 2.10  </span></span>
<span><span class="co">##  Median : 8.70   Median :20.5   Median : 3.70  </span></span>
<span><span class="co">##  Mean   :10.05   Mean   :23.2   Mean   : 4.86  </span></span>
<span><span class="co">##  3rd Qu.:11.35   3rd Qu.:24.1   3rd Qu.: 6.80  </span></span>
<span><span class="co">##  Max.   :26.50   Max.   :53.2   Max.   :19.50</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following code fits the isotropic <code>EII</code> and unconstrained <code>VVV</code> agglomerative hierarchical clustering models to this data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">HC_EII</span> <span class="op">=</span> <span class="fu">hc</span><span class="op">(</span><span class="va">EuroUnemployment</span>, modelName <span class="op">=</span> <span class="st">"EII"</span><span class="op">)</span></span>
<span><span class="va">HC_VVV</span> <span class="op">=</span> <span class="fu">hc</span><span class="op">(</span><span class="va">EuroUnemployment</span>, modelName <span class="op">=</span> <span class="st">"VVV"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Merge dendrograms (with uniform length between the hierarchy levels) for the <code>EII</code> and <code>VVV</code> models are plotted and shown in <a href="#fig-HCmerge" class="quarto-xref">Figure&nbsp;<span>3.26</span></a>.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">HC_EII</span>, what <span class="op">=</span> <span class="st">"merge"</span>, labels <span class="op">=</span> <span class="cn">TRUE</span>, hang <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">HC_VVV</span>, what <span class="op">=</span> <span class="st">"merge"</span>, labels <span class="op">=</span> <span class="cn">TRUE</span>, hang <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-HCmerge" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-HCmerge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-HCmerge" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-HCmerge-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-HCmerge-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-HCmerge-1.png" id="fig-HCmerge-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-HCmerge">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-HCmerge-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-HCmerge" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-HCmerge-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-HCmerge-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-HCmerge-2.png" id="fig-HCmerge-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-HCmerge">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-HCmerge-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-HCmerge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.26: Dendrograms with height corresponding to the number of groups for model-based hierarchical clustering of the <code>EuroUnemployment</code> data with the <code>EII</code> (a) and <code>VVV</code> (b) models.
</figcaption></figure>
</div>
<p>Log-likelihood dendrograms for the <code>EII</code> and <code>VVV</code> models are plotted and shown in <a href="#fig-HCloglik" class="quarto-xref">Figure&nbsp;<span>3.27</span></a>. These dendrograms extend from one cluster only as far as the classification likelihood increases and is defined (no singletons or singular covariances).</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">HC_EII</span>, what <span class="op">=</span> <span class="st">"loglik"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">HC_VVV</span>, what <span class="op">=</span> <span class="st">"loglik"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-HCloglik" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-HCloglik-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-HCloglik" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-HCloglik-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-HCloglik-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-HCloglik-1.png" id="fig-HCloglik-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-HCloglik">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-HCloglik-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-HCloglik" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-HCloglik-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-HCloglik-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-HCloglik-2.png" id="fig-HCloglik-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-HCloglik">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-HCloglik-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-HCloglik-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.27: Dendrograms with height corresponding to the classification log-likelihood for model-based hierarchical clustering of the <code>EuroUnemployment</code> data with the <code>EII</code> (a) and <code>VVV</code> (b) models. The log-likelihood is undefined at the other levels of the trees due to the presence of singletons.
</figcaption></figure>
</div>
</div>
<section id="agglomerative-clustering-for-large-datasets" class="level3" data-number="3.6.1"><h3 data-number="3.6.1" class="anchored" data-anchor-id="agglomerative-clustering-for-large-datasets">
<span class="header-section-number">3.6.1</span> Agglomerative Clustering for Large Datasets</h3>
<p>Model-based hierarchical agglomerative clustering is computationally demanding on large datasets, both in terms of time and memory. However, it is possible to initialize the modeling from a partition containing fewer groups than the number of observations. For example, <span class="citation" data-cites="Posse:2001">Posse (<a href="99_references.html#ref-Posse:2001" role="doc-biblioref">2001</a>)</span> proposed using a subgraph of the minimum spanning tree associated with the data to derive an initial partition for model-based hierarchical clustering. He illustrated the method by applying it to a multiband MRI image of the human brain and to data on global precipitation climatology.</p>
<p>The optional argument <code>partition</code> available in the function <code>hc()</code> allows us to specify an initial partition of observations from which to start the agglomeration process.</p>
<div id="exm-star" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.10</strong></span> &nbsp;&nbsp;<strong>Model-based hierarchical clustering on star data</strong></p>
<p>As a simple illustration, consider the <code>HRstars</code> dataset from the <strong>GDAdata</strong> package <span class="citation" data-cites="Rpkg:GDAdata">(<a href="99_references.html#ref-Rpkg:GDAdata" role="doc-biblioref">Unwin 2015</a>)</span>, which contains 6,200 measurements of star data on four variables. We first use <span class="math inline">\(k\)</span>-means to divide the data into 100 groups, and then apply MBAHC to the data with this initial partition.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"HRstars"</span>, package <span class="op">=</span> <span class="st">"GDAdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">initial</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">HRstars</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">100</span>, nstart<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="va">HC_VVV</span> <span class="op">=</span> <span class="fu">hc</span><span class="op">(</span><span class="va">HRstars</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, modelName <span class="op">=</span> <span class="st">"VVV"</span>, </span>
<span>            partition <span class="op">=</span> <span class="va">initial</span>, use <span class="op">=</span> <span class="st">"VARS"</span><span class="op">)</span></span>
<span><span class="va">HC_VVV</span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## hc(data = HRstars[, -1], modelName = "VVV", use = "VARS", partition =</span></span>
<span><span class="co">## initial) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model-Based Agglomerative Hierarchical Clustering </span></span>
<span><span class="co">## Model name        = VVV </span></span>
<span><span class="co">## Use               = VARS </span></span>
<span><span class="co">## Number of objects = 6220</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section></section><section id="sec-mclust_init" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="sec-mclust_init">
<span class="header-section-number">3.7</span> Initialization in mclust</h2>
<p>As discussed in <a href="02_mixture.html#sec-init" class="quarto-xref"><span>Section 2.2.3</span></a>, initialization of the EM algorithm in model-based clustering is often crucial, because the likelihood surfaces for models of interest tend to have many local maxima and may even be unbounded, not to mention having regions where progress is slow. In <strong>mclust</strong>, the EM algorithm for multivariate data is initialized with the partitions obtained from model-based agglomerative hierarchical clustering (MBAHC), by default using the unconstrained (<code>VVV</code>) model. Efficient numerical algorithms for agglomerative hierarchical clustering with multivariate normal models have been discussed by <span class="citation" data-cites="Fraley:1998">Fraley (<a href="99_references.html#ref-Fraley:1998" role="doc-biblioref">1998</a>)</span> and briefly reviewed in <a href="#sec-mbahc" class="quarto-xref"><span>Section 3.6</span></a>. <!-- \index{EM initialization!in mclust} --> In this approach, the two clusters are merged that yield the minimum regularized merge criterion (derived from the classification likelihood) over all possible merges at the current stage of the procedure.</p>
<p>Using unconstrained MBAHC is particularly convenient for GMMs because the underlying probability model (<code>VVV</code>) is shared to some extent by both the initialization step and the model fitting step. This strategy also has the advantage in that it provides the basis for initializing EM for any number of mixture components and component-covariance parameterizations. Although there is no guarantee that EM when so initialized will converge to a finite local optimum, it often provides reasonable starting values.</p>
<p>An issue with hierarchical clustering methods is that the resolution of ties in the merge criterion can have a significant effect on the downstream clustering outcome. Such ties are not uncommon when the data are discrete or when continuous data are rounded. Moreover, as the merges progress, these ties may not be exact for numerical reasons, and as a consequence results may be sensitive to relatively small changes in the data, including the order of the variables.</p>
<p>One way of detecting sensitivity in the results of a clustering method is to apply it to perturbed data. Such perturbations can be implemented in a number of ways, such as jittering the data, changing the order of the variables, or comparing results on different subsets of the data when there are a sufficient number of observations. Iterative methods, such as EM, can be initialized with different starting values.</p>
<div id="exm-flea" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.11</strong></span> &nbsp;&nbsp;<strong>Clustering flea beatle data</strong></p>
<p>As an illustration of the issues related to the initialization of the EM algorithm, consider the flea beatle data available in package <strong>tourr</strong> <span class="citation" data-cites="Rpkg:tourr">(<a href="99_references.html#ref-Rpkg:tourr" role="doc-biblioref">Wickham and Cook 2022</a>)</span>. This dataset provides six physical measurements for a sample of 74 fleas from three species as shown in the table below.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 71%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>species</code></td>
<td>Species of flea beetle from the genus Chaetocnema: concinna, heptapotamica, heikertingeri.</td>
</tr>
<tr class="even">
<td><code>tars1</code></td>
<td>Width of the first joint of the first tarsus in microns (the sum of measurements for both tarsi)</td>
</tr>
<tr class="odd">
<td><code>tars2</code></td>
<td>Width of the second joint of the first tarsus in microns (the sum of measurements for both tarsi)</td>
</tr>
<tr class="even">
<td><code>head</code></td>
<td>Maximal width of the head between the external edges of the eyes (in <span class="math inline">\(0.01\)</span> mm).</td>
</tr>
<tr class="odd">
<td><code>ade1</code></td>
<td>Maximal width of the aedeagus in the fore-part (in microns).</td>
</tr>
<tr class="even">
<td><code>ade2</code></td>
<td>Front angle of the aedeagus (1 unit = <span class="math inline">\(7.5\)</span> degrees)</td>
</tr>
<tr class="odd">
<td><code>ade3</code></td>
<td>Aedeagus width from the side (in microns).</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"flea"</span>, package <span class="op">=</span> <span class="st">"tourr"</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">flea</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Class</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">flea</span><span class="op">$</span><span class="va">species</span>, </span>
<span>               labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Concinna"</span>, <span class="st">"Heikertingeri"</span>, <span class="st">"Heptapotamica"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span><span class="op">)</span></span>
<span><span class="co">## Class</span></span>
<span><span class="co">##      Concinna Heikertingeri Heptapotamica </span></span>
<span><span class="co">##            21            31            22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-flea_clpairs" class="quarto-xref">Figure&nbsp;<span>3.28</span></a>, obtained with the code below, shows the scatterplot matrix of variables in the <code>flea</code> dataset with points marked according to the flea species. Since the observed values are rounded (to the nearest integer presumably), there is a considerable overplotting of points. For this reason, we added transparency (or opacity) to cluster colors via the alpha channel in the following plot:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">col</span> <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span></span>
<span><span class="va">clp</span> <span class="op">=</span> <span class="fu">clPairs</span><span class="op">(</span><span class="va">X</span>, <span class="va">Class</span>, lower.panel <span class="op">=</span> <span class="cn">NULL</span>, gap <span class="op">=</span> <span class="fl">0</span>,</span>
<span>              symbols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">15</span>, <span class="fl">17</span><span class="op">)</span>, </span>
<span>              colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="va">col</span>, alpha.f <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">clPairsLegend</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.1</span>, y <span class="op">=</span> <span class="fl">0.3</span>, class <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">class</span>, </span>
<span>              col <span class="op">=</span> <span class="va">col</span>, pch <span class="op">=</span> <span class="va">clp</span><span class="op">$</span><span class="va">pch</span>,</span>
<span>              title <span class="op">=</span> <span class="st">"Flea beatle species"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-flea_clpairs" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-flea_clpairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-flea_clpairs-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-flea_clpairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.28: Scatterplot matrix for the <code>flea</code> dataset with points marked according to the true classes.
</figcaption></figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="Scrucca:Fop:Murphy:Raftery:2016">Luca Scrucca et al. (<a href="99_references.html#ref-Scrucca:Fop:Murphy:Raftery:2016" role="doc-biblioref">2016</a>)</span> discussed model-based clustering for this dataset and showed that using the original variables for the MBAHC initialization step leads to sub-optimal results in <code>Mclust()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># set the default for the current session</span></span>
<span><span class="fu">mclust.options</span><span class="op">(</span><span class="st">"hcUse"</span> <span class="op">=</span> <span class="st">"VARS"</span><span class="op">)</span></span>
<span><span class="va">mod1</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co"># or specify the initialization method only for this model</span></span>
<span><span class="co"># mod1 = Mclust(X, initialization = list(hcPairs = hc(X, use = "VARS")))</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust EEE (ellipsoidal, equal volume, shape and orientation) model</span></span>
<span><span class="co">## with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood  n df     BIC    ICL</span></span>
<span><span class="co">##         -395.01 74 41 -966.49 -966.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3 </span></span>
<span><span class="co">## 21 22 31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##                </span></span>
<span><span class="co">## Class            1  2  3</span></span>
<span><span class="co">##   Concinna      21  0  0</span></span>
<span><span class="co">##   Heikertingeri  0  0 31</span></span>
<span><span class="co">##   Heptapotamica  0 22  0</span></span>
<span><span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we reverse the order of the variables in the fit, MBAHC yields a different set of initial partitions for EM, a consequence of the discrete nature of the data. With this initialization, <code>Mclust</code> still chooses the <code>EEE</code> model with 5 components, but with a different clustering partition.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust EEE (ellipsoidal, equal volume, shape and orientation) model</span></span>
<span><span class="co">## with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood  n df     BIC    ICL</span></span>
<span><span class="co">##         -395.01 74 41 -966.49 -966.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3 </span></span>
<span><span class="co">## 21 22 31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##                </span></span>
<span><span class="co">## Class            1  2  3</span></span>
<span><span class="co">##   Concinna      21  0  0</span></span>
<span><span class="co">##   Heikertingeri  0  0 31</span></span>
<span><span class="co">##   Heptapotamica  0 22  0</span></span>
<span><span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This second model has a higher BIC and better clustering accuracy.</p>
<p>In order to assess the stability of the results, we randomly start the EM algorithm using the function <code>hcRandomPairs()</code> to obtain a random hierarchical partitioning of the data for initialization:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod3</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span>, initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>hcPairs <span class="op">=</span> <span class="fu">hcRandomPairs</span><span class="op">(</span><span class="va">X</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VEE (ellipsoidal, equal shape and orientation) model with 4</span></span>
<span><span class="co">## components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood  n df     BIC     ICL</span></span>
<span><span class="co">##         -385.73 74 51 -990.98 -991.14</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3  4 </span></span>
<span><span class="co">## 28 22  3 21</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod3</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##                </span></span>
<span><span class="co">## Class            1  2  3  4</span></span>
<span><span class="co">##   Concinna       0  0  0 21</span></span>
<span><span class="co">##   Heikertingeri 28  0  3  0</span></span>
<span><span class="co">##   Heptapotamica  0 22  0  0</span></span>
<span><span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod3</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.9286</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this case, we obtain the <code>VEE</code> model with 4 components, which has a lower BIC but a higher ARI compared to the previous model. The function <code>mclustBICupdate()</code> <!-- \index{mclust!\code{mclustBICupdate()}}  --> can be used to retain the best models for each combination of number of components and cluster-covariance parameterization across several replications:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BIC</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="co"># get BIC table from initial random start</span></span>
<span>  <span class="va">BIC0</span> <span class="op">=</span> <span class="fu">mclustBIC</span><span class="op">(</span><span class="va">X</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>hcPairs <span class="op">=</span> <span class="fu">hcRandomPairs</span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># update BIC table by merging best BIC values for each</span></span>
<span>  <span class="co"># G and modelNames</span></span>
<span>  <span class="va">BIC</span>  <span class="op">=</span> <span class="fu">mclustBICupdate</span><span class="op">(</span><span class="va">BIC</span>, <span class="va">BIC0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BIC</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##            EEE,3     VEE,3    EEE,4    VVE,4   VEE,4</span></span>
<span><span class="co">## BIC      -966.49 -970.3464 -977.888 -986.025 -991.67</span></span>
<span><span class="co">## BIC diff    0.00   -3.8529  -11.394  -19.531  -25.18</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then recover the best model object by a subsequent call to <code>Mclust</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod4</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span>, x <span class="op">=</span> <span class="va">BIC</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust EEE (ellipsoidal, equal volume, shape and orientation) model</span></span>
<span><span class="co">## with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood  n df     BIC    ICL</span></span>
<span><span class="co">##         -395.01 74 41 -966.49 -966.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3 </span></span>
<span><span class="co">## 31 22 21</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod4</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##                </span></span>
<span><span class="co">## Class            1  2  3</span></span>
<span><span class="co">##   Concinna       0  0 21</span></span>
<span><span class="co">##   Heikertingeri 31  0  0</span></span>
<span><span class="co">##   Heptapotamica  0 22  0</span></span>
<span><span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod4</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The above procedure is able to identify the true clustering structure, but it is a time-consuming process which for large datasets may not be feasible. Moreover, even when using multiple random starts, there is no guarantee that the best solution found is the best that can be achieved.</p>
<p><span class="citation" data-cites="Scrucca:Raftery:2015">L. Scrucca and Raftery (<a href="99_references.html#ref-Scrucca:Raftery:2015" role="doc-biblioref">2015</a>)</span> discussed several approaches to improve the hierarchical clustering initialization for model-based clustering. The main idea is to apply a transformation to the data in an effort to enhance separation among clusters before applying the MBAHC for the initialization step. The EM algorithm is then run using the data on the original scale. Among the studied transformations, one that often worked reasonably well (and is used as the default in <strong>mclust</strong>) is the <em>scaled SVD transformation</em>. <!-- \index{scaled SVD transform initialization} --></p>
<p>Let <span class="math inline">\(\boldsymbol{X}\)</span> be the <span class="math inline">\((n \times p)\)</span> data matrix, and <span class="math inline">\(\mathbb{X}= (\boldsymbol{X}- \boldsymbol{1}_n\bar{\boldsymbol{x}}{}^{\!\top})\boldsymbol{S}^{-1/2}\)</span> be the corresponding centered and scaled matrix, where <span class="math inline">\(\bar{\boldsymbol{x}}\)</span> is the vector of sample means, <span class="math inline">\(\boldsymbol{1}_n\)</span> is the unit vector of length <span class="math inline">\(n\)</span>, and <span class="math inline">\(\boldsymbol{S}= \diag(s^2_1, \dots, s^2_d)\)</span> is the diagonal matrix of sample variances. Consider the following singular value decomposition (SVD): <span class="math display">\[
\mathbb{X}= \boldsymbol{U}\boldsymbol{\Omega}\boldsymbol{V}{}^{\!\top}= \sum_{i=1}^r \omega_i\boldsymbol{u}_i\boldsymbol{v}{}^{\!\top}_i,
\]</span> where <span class="math inline">\(\boldsymbol{u}_i\)</span> are the left singular vectors, <span class="math inline">\(\boldsymbol{v}_i\)</span> the right singular vectors, <span class="math inline">\(\omega_1 \ge \omega_2 \ge \dots \ge \omega_r &gt; 0\)</span> the corresponding singular values, and <span class="math inline">\(r \le \min(n,d)\)</span> the rank of matrix <span class="math inline">\(\mathbb{X}\)</span>, with equality when there are no singularities. The scaled SVD transformation is computed as: <span class="math display">\[
\boldsymbol{\mathscr{X}}= \mathbb{X}\boldsymbol{S}^{-1/2} \boldsymbol{V}\boldsymbol{\Omega}^{-1/2} = \boldsymbol{U}\boldsymbol{\Omega}^{1/2},
\]</span> for which <span class="math inline">\(\Exp(\boldsymbol{\mathscr{X}}) = \boldsymbol{0}\)</span> and <span class="math inline">\(\Var(\boldsymbol{\mathscr{X}}) = \boldsymbol{\Omega}/n = \diag(\omega_i)/n\)</span>. Thus, in the transformed scale the features are centered, uncorrelated, and with decreasing variances equal to the square root of the eigenvalues of the marginal sample correlation matrix.</p>
<div id="exm-flea2" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.12</strong></span> &nbsp;&nbsp;<strong>Clustering flea beatle data (continued)</strong></p>
<p>A GMM estimation initialized using MBAHC with the scaled SVD transformation of the data described above is obtained with the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mclust.options</span><span class="op">(</span><span class="st">"hcUse"</span> <span class="op">=</span> <span class="st">"SVD"</span><span class="op">)</span>  <span class="co"># restore the default</span></span>
<span><span class="va">mod5</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="co"># X is the unscaled flea data</span></span>
<span><span class="co"># or specify only for this model fit</span></span>
<span><span class="co"># mod5 = Mclust(X, initialization = list(hcPairs = hc(X, use = "SVD")))</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod5</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust EEE (ellipsoidal, equal volume, shape and orientation) model</span></span>
<span><span class="co">## with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood  n df     BIC    ICL</span></span>
<span><span class="co">##         -395.01 74 41 -966.49 -966.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3 </span></span>
<span><span class="co">## 21 31 22</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod5</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##                </span></span>
<span><span class="co">## Class            1  2  3</span></span>
<span><span class="co">##   Concinna      21  0  0</span></span>
<span><span class="co">##   Heikertingeri  0 31  0</span></span>
<span><span class="co">##   Heptapotamica  0  0 22</span></span>
<span><span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">Class</span>, <span class="va">mod5</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span>  </span>
<span><span class="co">## [1] 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this case, a single run with the scaled SVD initialization strategy (the default strategy for the <code>Mclust()</code> function) yields the highest BIC, and a perfect classification of the fleas into the actual species. However, as the true clustering would not usually be known, analysis with perturbations and/or multiple initialization strategies is always advisable.</p>
</div>
<p>With EM, it is possible to do model-based clustering starting with parameter estimates, conditional probabilities, or classifications other than those produced by model-based agglomerative hierarchical clustering. The next section provides some further details on how to run an EM algorithm for Gaussian mixtures in <strong>mclust</strong>.</p>
</section><section id="sec-mclust_em" class="level2" data-number="3.8"><h2 data-number="3.8" class="anchored" data-anchor-id="sec-mclust_em">
<span class="header-section-number">3.8</span> EM Algorithm in mclust</h2>
<p>As described in <a href="02_mixture.html#sec-EM_GMM" class="quarto-xref"><span>Section 2.2.2</span></a>, an iteration of EM consists of an E-step and an M-step. The E-step computes a matrix <span class="math inline">\(\boldsymbol{Z}=\{z_{ik}\}\)</span>, where <span class="math inline">\(z_{ik}\)</span> is an estimate of the conditional probability that observation <span class="math inline">\(i\)</span> belongs to cluster <span class="math inline">\(k\)</span> given the current parameter estimates. The M-step computes parameter estimates given <span class="math inline">\(\boldsymbol{Z}\)</span>.</p>
<p><strong>mclust</strong> provides functions <code>em()</code> and <code>me()</code> implementing the EM algorithm for maximum likelihood estimation in Gaussian mixture models for all 14 of the covariance parameterizations based on eigen-decomposition. The <code>em()</code> <!-- \index{mclust!\code{em()}} --> function starts with the E-step; besides the data and model specification, the model parameters (means, covariances, and mixing proportions) must be provided. The <code>me()</code> <!-- \index{mclust!\code{me()}}  --> function, on the other hand, starts with the M-step; besides the data and model specification, the matrix of conditional probabilities must be provided. The output for both are the maximum likelihood estimates of the model parameters and the matrix of conditional probabilities.</p>
<p>Functions <code>estep()</code> <!-- \index{mclust!\code{estep()}}  --> and <code>mstep()</code> <!-- \index{mclust!\code{mstep()}}  --> implement the individual E- and M- steps, respectively, of an EM iteration. Conditional probabilities and the log-likelihood can be recovered from parameters via <code>estep()</code>, while parameters can be recovered from conditional probabilities using <code>mstep()</code>.</p>
<div id="exm-iris" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.13</strong></span> &nbsp;&nbsp;<strong>Single M- and E- steps using the iris data</strong></p>
<p>Consider the well-known <code>iris</code> dataset <span class="citation" data-cites="Anderson:1935">(<a href="99_references.html#ref-Anderson:1935" role="doc-biblioref">Anderson 1935, Fisher:1936</a>)</span> which contains the measurements (in cm) of sepal length and width, and petal length and width, for 50 flowers from each of 3 species of Iris, namely setosa, versicolor, and virginica.</p>
<p>The following code shows how single M- and E- steps can be performed using functions <code>mstep()</code> and <code>estep()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"iris"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    150 obs. of  5 variables:</span></span>
<span><span class="co">## $ Sepal.Length: num 5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...</span></span>
<span><span class="co">## $ Sepal.Width : num 3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...</span></span>
<span><span class="co">## $ Petal.Length: num 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...</span></span>
<span><span class="co">## $ Petal.Width : num 0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...</span></span>
<span><span class="co">## $ Species : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1</span></span>
<span><span class="co">##    1 1 1 ...</span></span>
<span><span class="va">ms</span> <span class="op">=</span> <span class="fu">mstep</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, modelName <span class="op">=</span> <span class="st">"VVV"</span>,</span>
<span>            z <span class="op">=</span> <span class="fu">unmap</span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ms</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">## List of 7</span></span>
<span><span class="co">## $ modelName : chr "VVV"</span></span>
<span><span class="co">## $ prior : NULL</span></span>
<span><span class="co">## $ n : int 150</span></span>
<span><span class="co">## $ d : int 4</span></span>
<span><span class="co">## $ G : int 3</span></span>
<span><span class="co">## $ z : num [1:150, 1:3] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">## ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">## $ parameters:List of 3</span></span>
<span><span class="co">## - attr(*, "returnCode")= num 0</span></span>
<span><span class="va">es</span> <span class="op">=</span> <span class="fu">estep</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, modelName <span class="op">=</span> <span class="st">"VVV"</span>, </span>
<span>            parameters <span class="op">=</span> <span class="va">ms</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">es</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">## List of 7</span></span>
<span><span class="co">## $ modelName : chr "VVV"</span></span>
<span><span class="co">## $ n : int 150</span></span>
<span><span class="co">## $ d : int 4</span></span>
<span><span class="co">## $ G : int 3</span></span>
<span><span class="co">## $ z : num [1:150, 1:3] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">## ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">## $ parameters:List of 3</span></span>
<span><span class="co">## $ loglik : num -183</span></span>
<span><span class="co">## - attr(*, "returnCode")= num 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this example, the initial estimate of <code>z</code> for the M-step is a matrix of indicator variables corresponding to a discrete classification taken from the true classes contained in <code>iris$Species</code>. Here, we used the function <code>unmap()</code> <!-- \index{mclust!\code{unmap()}} --> to convert the classification into the corresponding matrix of indicator variables. The inverse function, called <code>map()</code>, <!-- \index{mclust!\code{map()}} --> converts a matrix in which each row sums to 1 into an integer vector specifying for each row the column index of the maximum. This last operation is basically the MAP when applied to the matrix of posterior conditional probabilities (see <a href="02_mixture.html#sec-map" class="quarto-xref"><span>Section 2.2.4</span></a>).</p>
</div>
</section><section id="further-considerations-in-cluster-analysis-via-mixture-modeling" class="level2" data-number="3.9"><h2 data-number="3.9" class="anchored" data-anchor-id="further-considerations-in-cluster-analysis-via-mixture-modeling">
<span class="header-section-number">3.9</span> Further Considerations in Cluster Analysis via Mixture Modeling</h2>
<p>Clustering can be affected by control parameter settings, such as convergence tolerances within the clustering functions, although the defaults are often adequate.</p>
<p>Control parameters used by the EM functions in <strong>mclust</strong> are set and retrieved using the function <code>emControl()</code>, <!-- \index{mclust!{emControl()}} --> These include:</p>
<ul>
<li><p><code>eps</code>: A tolerance value for terminating iterations due to ill-conditioning, such as near singularity in covariance matrices. By default this is set to <code>.Machine$double.eps</code>, the relative machine precision, which has the value <code>2.220446e-16</code> on IEEE-compliant machines.</p></li>
<li><p><code>tol</code>: A vector of length 2 giving iteration convergence tolerances. By default this is set to <code>c(1.0e-5, sqrt(.Machine$double.eps))</code>. The first value is the tolerance for the relative convergence of the log-likelihood in the EM algorithm, and the second value is the relative convergence tolerance for the M-step of those models that have an iterative M-step, namely the models <code>VEI</code>, <code>EVE</code>, <code>VEE</code>, <code>VVE</code>, and <code>VEV</code> (see <a href="02_mixture.html#tbl-models_df" class="quarto-xref">Table&nbsp;<span>2.2</span></a>).</p></li>
<li><p><code>itmax</code> : An integer vector of length two giving integer limits on the number of EM iterations and on the number of iterations in the inner loop for models with iterative M-step (see above). By default this is set to <code>c(.Machine$integer.max, .Machine$integer.max)</code>, allowing termination to be completely governed by the control parameter <code>tol</code>. A warning is issued if this limit is reached before the convergence criterion is satisfied.</p></li>
</ul>
<p>Although these control settings are in a sense hidden by the defaults, they may have a significant effect on results in some instances and should be taken into consideration in any analysis.</p>
<p>The <strong>mclust</strong> implementation includes various warning messages in cases of potential problems. These are issued if <code>mclust.options("warn")</code> is set to <code>TRUE</code> or specified directly in function calls. Note, however, that by default <code>mclust.options("warn") = FALSE</code>, so that these warning messages are suppressed.</p>
<p>Finally, it is important to take into account numerical issues in model-based cluster analysis, and more generally in GMM estimation. The computations for estimating the model parameters break down when the covariance corresponding to one or more components becomes ill-conditioned (singular or nearly singular), and cannot proceed if clusters contain only a few observations or if the observations they contain are nearly colinear. Estimation may also fail when one or more mixing proportions shrink to negligible values. Including a prior is often helpful in such situations (see <a href="07_miscellanea.html#sec-prior" class="quarto-xref"><span>Section 7.2</span></a>).</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Anderson:1935" class="csl-entry" role="listitem">
Anderson, E. 1935. <span>“The Irises of the <span>Gasp<span>é</span></span> <span>Peninsula</span>.”</span> <em>Bulletin of the American Iris Society</em> 59: 2–5.
</div>
<div id="ref-Banfield:Raftery:1993" class="csl-entry" role="listitem">
Banfield, J., and Adrian E. Raftery. 1993. <span>“Model-Based <span>G</span>aussian and Non-<span>G</span>aussian Clustering.”</span> <em>Biometrics</em> 49: 803–21.
</div>
<div id="ref-Basford:Greenway:McLachlan:Peel:1997" class="csl-entry" role="listitem">
Basford, K E, D R Greenway, G J McLachlan, and D Peel. 1997. <span>“Standard Errors of Fitted Component Means of Normal Mixtures.”</span> <em>Computational Statistics</em> 12 (1): 1–18.
</div>
<div id="ref-Celeux:Govaert:1995" class="csl-entry" role="listitem">
Celeux, G., and G. Govaert. 1995. <span>“<span>G</span>aussian Parsimonious Clustering Models.”</span> <em>Pattern Recognition</em> 28: 781–93.
</div>
<div id="ref-Coomans:Broeckaert:1986" class="csl-entry" role="listitem">
Coomans, D, and I Broeckaert. 1986. <em>Potential Pattern Recognition in Chemical and Medical Decision Making</em>. Letchworth, England: Research Studies Press.
</div>
<div id="ref-UCI:dataset" class="csl-entry" role="listitem">
Dua, Dheeru, and Casey Graff. 2017. <span>“<span>UCI</span> <span>Machine</span> <span>Learning</span> <span>Repository</span>.”</span> University of California, Irvine, School of Information; Computer Sciences. <a href="http://archive.ics.uci.edu/ml">http://archive.ics.uci.edu/ml</a>.
</div>
<div id="ref-Efron:1979" class="csl-entry" role="listitem">
Efron, Bradley. 1979. <span>“Bootstrap Methods: Another Look at the Jackknife.”</span> <em>Annals of Statistics</em> 7: 1–26.
</div>
<div id="ref-Forina:1986" class="csl-entry" role="listitem">
Forina, M., C. Armanino, M. Castino, and M. Ubigli. 1986. <span>“Multivariate Data Analysis as a Discriminating Method of the Origin of Wines.”</span> <em>Vitis</em> 25: 189–201. <a href="ftp://ftp.ics.uci.edu/pub/machine-learning-databases/wine">ftp://ftp.ics.uci.edu/pub/machine-learning-databases/wine</a>.
</div>
<div id="ref-Fraley:1998" class="csl-entry" role="listitem">
Fraley, Chris. 1998. <span>“Algorithms for Model-Based <span>G</span>aussian Hierarchical Clustering.”</span> <em><span>SIAM</span> Journal on Scientific Computing</em> 20 (1): 270–81.
</div>
<div id="ref-Fraley:Raftery:2007a" class="csl-entry" role="listitem">
Fraley, Chris, and Adrian E Raftery. 2007. <span>“Bayesian Regularization for Normal Mixture Estimation and Model-Based Clustering.”</span> <em>Journal of Classification</em> 24 (2): 155–81.
</div>
<div id="ref-Friedman:Rubin:1967" class="csl-entry" role="listitem">
Friedman, Herman P, and Jerrold Rubin. 1967. <span>“On Some Invariant Criteria for Grouping Data.”</span> <em>Journal of the American Statistical Association</em> 62 (320): 1159–78.
</div>
<div id="ref-Habbema:Hermans:vandenBroek:1974" class="csl-entry" role="listitem">
Habbema, J D F, J. Hermans, and K van den Broek. 1974. <span>“A Stepwise Discriminant Analysis Program Using Density Estimation.”</span> In <em>Proceedings in Computational Statistics</em>, 101–10. Vienna: Physica-Verlag: COMPSTAT.
</div>
<div id="ref-Hardle:1991" class="csl-entry" role="listitem">
Härdle, Wolfgang Karl. 1991. <em>Smoothing Techniques: With Implementation in <span>S</span></em>. Springer Science &amp; Business Media.
</div>
<div id="ref-Hastie:Tibshirani:Friedman:2009" class="csl-entry" role="listitem">
Hastie, T., R. Tibshirani, and J. H. Friedman. 2009. <em>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</em>. 2nd ed. Springer-Verlag. <a href="http://www-stat.stanford.edu/%7Etibs/ElemStatLearn/">http://www-stat.stanford.edu/%7Etibs/ElemStatLearn/</a>.
</div>
<div id="ref-Hubert:Arabie:1985" class="csl-entry" role="listitem">
Hubert, L., and P. Arabie. 1985. <span>“Comparing Partitions.”</span> <em>Journal of Classification</em> 2: 193–218.
</div>
<div id="ref-Rpkg:gclus" class="csl-entry" role="listitem">
Hurley, Catherine. 2019. <em><span class="nocase">gclus</span>: Clustering Graphics</em>. <a href="https://CRAN.R-project.org/package=gclus">https://CRAN.R-project.org/package=gclus</a>.
</div>
<div id="ref-McNeil:1977" class="csl-entry" role="listitem">
McNeil, D. R. 1977. <em>Interactive Data Analysis</em>. New York: Wiley.
</div>
<div id="ref-Posse:2001" class="csl-entry" role="listitem">
Posse, C. 2001. <span>“Hierarchical Model-Based Clustering for Large Datasets.”</span> <em>Journal of Computational and Graphical Statistics</em> 10 (3): 464–86.
</div>
<div id="ref-Reaven:Miller:1979" class="csl-entry" role="listitem">
Reaven, GM, and RG Miller. 1979. <span>“An Attempt to Define the Nature of Chemical Diabetes Using a Multidimensional Analysis.”</span> <em>Diabetologia</em> 16 (1): 17–24.
</div>
<div id="ref-Scott:Symons:1971" class="csl-entry" role="listitem">
Scott, AJ, and Michael J Symons. 1971. <span>“Clustering Methods Based on Likelihood Ratio Criteria.”</span> <em>Biometrics</em> 27 (2): 387–97.
</div>
<div id="ref-Scrucca:Raftery:2015" class="csl-entry" role="listitem">
Scrucca, L., and A. E. Raftery. 2015. <span>“Improved Initialisation of Model-Based Clustering Using <span>G</span>aussian Hierarchical Partitions.”</span> <em>Advances in Data Analysis and Classification</em> 4 (9): 447–60. <a href="https://doi.org/10.1007/s11634-015-0220-z">https://doi.org/10.1007/s11634-015-0220-z</a>.
</div>
<div id="ref-Scrucca:Fop:Murphy:Raftery:2016" class="csl-entry" role="listitem">
Scrucca, Luca, Michael Fop, Thomas Brendan Murphy, and Adrian E. Raftery. 2016. <span>“<span class="nocase">mclust</span> 5: Clustering, Classification and Density Estimation Using <span>G</span>aussian Finite Mixture Models.”</span> <em>The <span>R</span> Journal</em> 8 (1): 205–33. <a href="https://journal.r-project.org/archive/2016-1/scrucca-fop-murphy-etal.pdf">https://journal.r-project.org/archive/2016-1/scrucca-fop-murphy-etal.pdf</a>.
</div>
<div id="ref-Rpkg:rrcov" class="csl-entry" role="listitem">
Todorov, Valentin. 2022. <em><span class="nocase">rrcov</span>: Scalable Robust Estimators with High Breakdown Point</em>. <a href="https://CRAN.R-project.org/package=rrcov">https://CRAN.R-project.org/package=rrcov</a>.
</div>
<div id="ref-Rpkg:GDAdata" class="csl-entry" role="listitem">
Unwin, Antony. 2015. <em><span>GDAdata</span>: Datasets for the Book Graphical Data Analysis with <span>R</span></em>. <a href="https://CRAN.R-project.org/package=GDAdata">https://CRAN.R-project.org/package=GDAdata</a>.
</div>
<div id="ref-Ward:1963" class="csl-entry" role="listitem">
Ward, Joe H. 1963. <span>“Hierarchical Grouping to Optimize an Objective Function.”</span> <em>Journal of the American Statistical Association</em> 58 (301): 236–44.
</div>
<div id="ref-Rpkg:tourr" class="csl-entry" role="listitem">
Wickham, Hadley, and Dianne Cook. 2022. <em><span class="nocase">tourr</span>: Implement Tour Methods in r Code</em>. <a href="https://CRAN.R-project.org/package=tourr">https://CRAN.R-project.org/package=tourr</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/02_mixture.html" class="pagination-link" aria-label="Finite Mixture Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Finite Mixture Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/04_classification.html" class="pagination-link" aria-label="Mixture-Based Classification">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mixture-Based Classification</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Model-Based Clustering, Classification, and <br> Density Estimation Using mclust in R</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>