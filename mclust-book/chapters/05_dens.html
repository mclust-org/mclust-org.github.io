<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>5&nbsp; Model-Based Density Estimation – Model-Based Clustering, Classification, and Density Estimation 
Using mclust in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/06_graphics.html" rel="next">
<link href="../chapters/04_classification.html" rel="prev">
<link href="../images/cover.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/05_dens.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model-Based Density Estimation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Model-Based Clustering, Classification, and Density Estimation Using mclust in R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/00_preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Finite Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03_cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model-Based Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mixture-Based Classification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05_dens.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model-Based Density Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06_graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Visualizing Gaussian Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07_miscellanea.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Miscellanea</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/99_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#density-estimation" id="toc-density-estimation" class="nav-link active" data-scroll-target="#density-estimation"><span class="header-section-number">5.1</span> Density Estimation</a></li>
  <li><a href="#finite-mixture-modeling-for-density-estimation-with-mclust" id="toc-finite-mixture-modeling-for-density-estimation-with-mclust" class="nav-link" data-scroll-target="#finite-mixture-modeling-for-density-estimation-with-mclust"><span class="header-section-number">5.2</span> Finite Mixture Modeling for Density Estimation with mclust</a></li>
  <li>
<a href="#univariate-density-estimation" id="toc-univariate-density-estimation" class="nav-link" data-scroll-target="#univariate-density-estimation"><span class="header-section-number">5.3</span> Univariate Density Estimation</a>
  <ul class="collapse">
<li><a href="#diagnostics-for-univariate-density-estimation" id="toc-diagnostics-for-univariate-density-estimation" class="nav-link" data-scroll-target="#diagnostics-for-univariate-density-estimation"><span class="header-section-number">5.3.1</span> Diagnostics for Univariate Density Estimation</a></li>
  </ul>
</li>
  <li><a href="#sec-densityhd" id="toc-sec-densityhd" class="nav-link" data-scroll-target="#sec-densityhd"><span class="header-section-number">5.4</span> Density Estimation in Higher Dimensions</a></li>
  <li><a href="#sec-densbounded" id="toc-sec-densbounded" class="nav-link" data-scroll-target="#sec-densbounded"><span class="header-section-number">5.5</span> Density Estimation for Bounded Data</a></li>
  <li><a href="#sec-hdr" id="toc-sec-hdr" class="nav-link" data-scroll-target="#sec-hdr"><span class="header-section-number">5.6</span> Highest Density Regions</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-density" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model-Based Density Estimation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="hidden">
<p><span class="math display">\[
\DeclareMathOperator{\Real}{\mathbb{R}}
\DeclareMathOperator{\Proj}{\text{P}}
\DeclareMathOperator{\Exp}{\text{E}}
\DeclareMathOperator{\Var}{\text{Var}}
\DeclareMathOperator{\var}{\text{var}}
\DeclareMathOperator{\sd}{\text{sd}}
\DeclareMathOperator{\cov}{\text{cov}}
\DeclareMathOperator{\cor}{\text{cor}}
\DeclareMathOperator{\range}{\text{range}}
\DeclareMathOperator{\rank}{\text{rank}}
\DeclareMathOperator{\ind}{\perp\hspace*{-1.1ex}\perp}
\DeclareMathOperator{\CE}{\text{CE}}
\DeclareMathOperator{\BS}{\text{BS}}
\DeclareMathOperator{\ECM}{\text{ECM}}
\DeclareMathOperator{\BSS}{\text{BSS}}
\DeclareMathOperator{\WSS}{\text{WSS}}
\DeclareMathOperator{\TSS}{\text{TSS}}
\DeclareMathOperator{\BIC}{\text{BIC}}
\DeclareMathOperator{\ICL}{\text{ICL}}
\DeclareMathOperator{\CV}{\text{CV}}
\DeclareMathOperator{\diag}{\text{diag}}
\DeclareMathOperator{\se}{\text{se}}
\DeclareMathOperator{\Cov}{\text{Cov}}
\DeclareMathOperator{\boot}{\text{boot}}
\DeclareMathOperator{\LRTS}{\text{LRTS}}
\DeclareMathOperator{\Model}{\mathcal{M}}
\DeclareMathOperator*{\argmin}{arg\min}
\DeclareMathOperator*{\argmax}{arg\max}
\DeclareMathOperator{\vech}{vech}
\DeclareMathOperator{\tr}{tr}
\]</span></p>
<!-- \definecolor{quarto-callout-note-color}{HTML}{4477AA} -->
</div>
<p>Density estimation plays an important role in both applied data analysis and theoretical research in statistics. Finite mixture models provide a flexible semiparametric methodology for density estimation, where the unknown density can be regarded as a convex linear combination of one or more probability density functions. This chapter illustrates data examples where Gaussian mixtures are used for model-based univariate and multivariate density estimation.</p>
<section id="density-estimation" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="density-estimation">
<span class="header-section-number">5.1</span> Density Estimation</h2>
<p>Density estimation is a valuable tool for summarizing data distributions. A good density estimate can reveal important characteristics of the data as well as provide a useful exploratory tool. Broadly speaking, three alternative approaches can be distinguished: <em>parametric</em> density estimation, <em>nonparametric</em> density estimation, and <em>semiparametric</em> density estimation via finite mixture modeling.</p>
<p>In the parametric approach, a distribution is assumed for the density with unknown parameters that are estimated by fitting a parametric function to the observed data. In the nonparametric approach, no density function is assumed a priori; rather, its form is completely determined by the data. Histograms and kernel density estimation (KDE) are two popular methods that belong to this class, and in both the number of parameters generally grows with the sample size and dimensionality of the dataset <span class="citation" data-cites="Silverman:1998 Scott:2009">(<a href="99_references.html#ref-Silverman:1998" role="doc-biblioref">Silverman 1998</a>; <a href="99_references.html#ref-Scott:2009" role="doc-biblioref">Scott 2009</a>)</span>. For univariate data, functions <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code> and <code><a href="https://rdrr.io/r/stats/density.html">density()</a></code> are available in base R for nonparametric density estimation, and several other packages, such as <strong>KernSmooth</strong> <span class="citation" data-cites="Rpkg:KernSmooth">(<a href="99_references.html#ref-Rpkg:KernSmooth" role="doc-biblioref">Wand 2021</a>)</span>, <strong>ks</strong> <span class="citation" data-cites="Rpkg:ks">(<a href="99_references.html#ref-Rpkg:ks" role="doc-biblioref">Duong 2022</a>)</span>, and <strong>sm</strong> <span class="citation" data-cites="Rpkg:sm">(<a href="99_references.html#ref-Rpkg:sm" role="doc-biblioref">A. Bowman et al. 2022</a>)</span>, either include functionality or are devoted to this approach. However, extension to higher dimensions is less well established.</p>
<p>Finite mixture models provide a flexible semiparametric methodology for density estimation. In this approach, the unknown density is expressed as a convex linear combination of one or more probability density functions. The Gaussian mixture model (GMM), which assumes the Gaussian distribution for the underlying component densities, is a popular choice in this class of methods. GMMs can approximate any continuous density with arbitrary accuracy, provided the model has a sufficient number of components <span class="citation" data-cites="Ferguson:1983 Marron:Wand:1992 Escobar:West:1995 Roeder:Wasserman:1997 FruhwirthSchnatter:2006">(<a href="99_references.html#ref-Ferguson:1983" role="doc-biblioref">Ferguson 1983</a>; <a href="99_references.html#ref-Marron:Wand:1992" role="doc-biblioref">Marron and Wand 1992</a>; <a href="99_references.html#ref-Escobar:West:1995" role="doc-biblioref">Escobar and West 1995</a>; <a href="99_references.html#ref-Roeder:Wasserman:1997" role="doc-biblioref">Roeder and Wasserman 1997</a>; <a href="99_references.html#ref-FruhwirthSchnatter:2006" role="doc-biblioref">Frühwirth-Schnatter 2006</a>)</span>. The number of parameters increases with the number of components, as well as with the dimensionality of the data except in the simplest case.</p>
<!--
> "Using such mixtures, any distribution on the real line can be approximated to within any preassigned accuracy in the L\'{e}vy metric, and any density on %the real line can be approximated similarly in the $L_1$ norm."\
[@Ferguson:1983]

> "[...] the class of normal mixtures densities is a very broad one [since] any density can be approximated arbitrarily closely in various senses by a normal mixture."\
[@Marron:Wand:1992]

> "Finite mixture distributions can be used to derive arbitrarily accurate approximations to practically any given probability distribution, provided that the number of components is not limited."\ 
[@FruhwirthSchnatter:2006, p. 237]
-->
<p>Advantages of the Gaussian mixture modeling in this context include:</p>
<ul>
<li><p>No need to specify tuning parameters, such as the number of bins and the origin for histograms, or the bandwidth for kernel density estimation;</p></li>
<li><p>Efficient even for multidimensional data;</p></li>
<li><p>Maximum likelihood estimates are available.</p></li>
</ul>
<p>Disadvantages of the Gaussian mixture modeling approach include:</p>
<ul>
<li><p>Estimation via the EM algorithm may be slow and requires good starting values;</p></li>
<li><p>Bias-variance trade-off: many GMM components may be needed for approximating a distribution, increasing the variance of the estimates, while more parsimonious models reduce the variability but may introduce some bias.</p></li>
<li><p>The number of components to include is not known in advance.</p></li>
</ul></section><section id="finite-mixture-modeling-for-density-estimation-with-mclust" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="finite-mixture-modeling-for-density-estimation-with-mclust">
<span class="header-section-number">5.2</span> Finite Mixture Modeling for Density Estimation with mclust</h2>
<p>Consider a vector of random variables <span class="math inline">\(\boldsymbol{x}\)</span> taking values in the sample space <span class="math inline">\(\Real{^d}\)</span> with <span class="math inline">\(d \ge 1\)</span>, and assume that the probability density function can be written as a finite mixture density of <span class="math inline">\(G\)</span> components as in equation <a href="02_mixture.html#eq-mixture" class="quarto-xref">Equation&nbsp;<span>2.1</span></a>. The model adopted in this chapter assumes a Gaussian distribution for each component density, so the density of <span class="math inline">\(\boldsymbol{x}\)</span> can be written as <!-- \index{Gaussian mixture density estimation} --> <span class="math display">\[
f(\boldsymbol{x}) = \sum_{k=1}^G \pi_k \phi(\boldsymbol{x}; \boldsymbol{\mu}_k, \boldsymbol{\Sigma}_k),
\]</span> where <span class="math inline">\(\phi(\cdot)\)</span> is the (multivariate) Gaussian density with mean <span class="math inline">\(\boldsymbol{\mu}_k\)</span>, covariance matrix <span class="math inline">\(\boldsymbol{\Sigma}_k\)</span>, and mixing weight <span class="math inline">\(\pi_k\)</span> for component <span class="math inline">\(k\)</span> (<span class="math inline">\(\pi_k &gt; 0\)</span>, <span class="math inline">\(\sum_{k=1}^G \pi_k = 1\)</span>), with <span class="math inline">\(k=1,\dots,G\)</span>. This is essentially a GMM of the form given in <a href="02_mixture.html#eq-gaussmixture" class="quarto-xref">Equation&nbsp;<span>2.3</span></a>.</p>
<p>Gaussian finite mixture modeling is a general strategy for density estimation. Nonparametric kernel density estimation (KDE) can be viewed as a mixture of <span class="math inline">\(G = n\)</span> components with uniform weights: <span class="math inline">\(\pi_k = 1/n\)</span> <span class="citation" data-cites="Titterington:etal:1985">(<a href="99_references.html#ref-Titterington:etal:1985" role="doc-biblioref">Titterington, Smith, and Makov 1985, 28–29</a>)</span>. Compared to KDE, finite mixture modeling typically uses a smaller number of components and hence fewer parameters. Conversely, compared to fully parametric density estimation, finite mixture modeling has the potential advantage of using more parameters and so introducing less estimation bias.</p>
<p>Mixture modeling also has its drawbacks, such as increased learning complexity and the need for iterative numerical procedures (such as the EM algorithm) for estimation. In certain cases there can also be identifiability issues (see <a href="02_mixture.html#sec-mixissues" class="quarto-xref"><span>Section 2.1.2</span></a>).</p>
<p><strong>mclust</strong> provides a simple interface to Gaussian mixture models for univariate and multivariate density estimation through the <code><a href="https://mclust-org.github.io/mclust/reference/densityMclust.html">densityMclust()</a></code> <!-- \index{mclust!\code{densityMclust()}}  --> function. Available arguments and functionalities are analogous to those described in <a href="03_cluster.html#sec-clust_mclust" class="quarto-xref"><span>Section 3.2</span></a> for the <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust()</a></code> function in the clustering case. Several examples of its usage are provided in the following sections.</p>
</section><section id="univariate-density-estimation" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="univariate-density-estimation">
<span class="header-section-number">5.3</span> Univariate Density Estimation</h2>
<div id="exm-stamp" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.1</strong></span> &nbsp;&nbsp;<strong>Density estimation of Hidalgo stamp data</strong></p>
<p><span class="citation" data-cites="Izenman:Sommer:1988">Izenman and Sommer (<a href="99_references.html#ref-Izenman:Sommer:1988" role="doc-biblioref">1988</a>)</span> considered fitting a Gaussian mixture to the distribution of the thickness of stamps in the 1872 Hidalgo stamp issue of Mexico. The dataset is available in R package <strong>multimode</strong> <span class="citation" data-cites="Rpkg:multimode">(<a href="99_references.html#ref-Rpkg:multimode" role="doc-biblioref">Ameijeiras-Alonso et al. 2021</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"stamps1"</span>, package <span class="op">=</span> <span class="st">"multimode"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">stamps1</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    485 obs. of  2 variables:</span></span>
<span><span class="co">## $ thickness: num 0.06 0.064 0.064 0.065 0.066 0.068 0.069 0.069 0.069</span></span>
<span><span class="co">##    0.069 ...</span></span>
<span><span class="co">## $ year : Factor w/ 2 levels "1872","1873-1874": 2 2 2 2 2 1 1 1 1 2 ...</span></span>
<span><span class="va">Thickness</span> <span class="op">=</span> <span class="va">stamps1</span><span class="op">$</span><span class="va">thickness</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A density estimate based on GMMs can be obtained in <strong>mclust</strong> with the function <code><a href="https://mclust-org.github.io/mclust/reference/densityMclust.html">densityMclust()</a></code>, which also produces a plot of the estimated density:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dens</span> <span class="op">=</span> <span class="fu">densityMclust</span><span class="op">(</span><span class="va">Thickness</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The plot can be suppressed by setting the optional argument <code>plot = FALSE</code>. A summary <!-- \index{mclust!\code{summary.densityMclust()}} --> can be obtained as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dens</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## Density estimation via Gaussian finite mixture modeling </span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust V (univariate, unequal variance) model with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df    BIC    ICL</span></span>
<span><span class="co">##          1516.6 485  8 2983.8 2890.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2       3 </span></span>
<span><span class="co">## 0.26535 0.30179 0.43286 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##        1        2        3 </span></span>
<span><span class="co">## 0.072145 0.079346 0.099189 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">##            1            2            3 </span></span>
<span><span class="co">## 0.0000047749 0.0000031193 0.0001886446</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This summary output shows that the estimated model selected by BIC is a three-component mixture with different variances (<code>V</code>,3), and gives the values of the estimated parameters.</p>
<p>The density estimate can also be displayed with the associated <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> method. For instance, <a href="#fig-stamp1" class="quarto-xref">Figure&nbsp;<span>5.1</span></a> shows the estimated density drawn over a histogram of the observed data. The latter is added by providing the optional argument <code>data</code> and specifying the break points between histogram bars (in the base R <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code> function) by setting the argument <code>breaks</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">br</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Thickness</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Thickness</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">21</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens</span>, what <span class="op">=</span> <span class="st">"density"</span>, data <span class="op">=</span> <span class="va">Thickness</span>, breaks <span class="op">=</span> <span class="va">br</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-stamp1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-stamp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-stamp1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stamp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: Histogram of thickness for the Hidalgo 1872 <code>stamps1</code> dataset, with the GMM density estimate superimposed.
</figcaption></figure>
</div>
</div>
</div>
<p>Three modes are clearly visible in the plot. These appear at the values of the mean of each mixture component: one component with larger mean and dispersion of stamp thickness, and two components having thinner and less variable stamps:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">dens</span><span class="op">$</span><span class="va">parameters</span>, </span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>,</span>
<span>                sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">variance</span><span class="op">$</span><span class="va">sigmasq</span><span class="op">)</span>,</span>
<span>                CoefVar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">variance</span><span class="op">$</span><span class="va">sigmasq</span><span class="op">)</span><span class="op">/</span><span class="va">mean</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##       mean        sd CoefVar</span></span>
<span><span class="co">## 1 0.072145 0.0021852  3.0288</span></span>
<span><span class="co">## 2 0.079346 0.0017662  2.2259</span></span>
<span><span class="co">## 3 0.099189 0.0137348 13.8470</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> <!-- \index{mclust!\code{predict.MclustDA()}} --> method is associated with objects of class <code>"densityMclust"</code>, for computing either the overall density (<code>what = "dens"</code>, the default), or the individual (unweighted) mixture component densities (<code>what = "cdens"</code>) at specified data points. Densities are returned on the logarithmic scale if we set <code>logarithm = TRUE</code>. For instance:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.07</span>, <span class="fl">0.08</span>, <span class="fl">0.1</span>, <span class="fl">0.12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">dens</span>, newdata <span class="op">=</span> <span class="va">x</span>, what <span class="op">=</span> <span class="st">"dens"</span><span class="op">)</span></span>
<span><span class="co">## [1] 31.2340 68.4716 12.5509  3.9895</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">dens</span>, newdata <span class="op">=</span> <span class="va">x</span>, logarithm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## [1] 3.4415 4.2264 2.5298 1.3837</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">dens</span>, newdata <span class="op">=</span> <span class="va">x</span>, what <span class="op">=</span> <span class="st">"cdens"</span><span class="op">)</span></span>
<span><span class="co">##                1           2       3</span></span>
<span><span class="co">## [1,]  1.1275e+02  1.8734e-04  3.0362</span></span>
<span><span class="co">## [2,]  2.8553e-01  2.1093e+02 10.9450</span></span>
<span><span class="co">## [3,]  9.4735e-34  4.5561e-28 28.9956</span></span>
<span><span class="co">## [4,] 1.3055e-102 2.0026e-113  9.2166</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The matrix of posterior conditional probabilities is obtained by specifying <code>what = "z"</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">dens</span>, newdata <span class="op">=</span> <span class="va">x</span>, what <span class="op">=</span> <span class="st">"z"</span><span class="op">)</span></span>
<span><span class="co">##                1           2        3</span></span>
<span><span class="co">## [1,]  9.5792e-01  1.8102e-06 0.042077</span></span>
<span><span class="co">## [2,]  1.1065e-03  9.2970e-01 0.069191</span></span>
<span><span class="co">## [3,]  2.0029e-35  1.0955e-29 1.000000</span></span>
<span><span class="co">## [4,] 8.6832e-104 1.5149e-114 1.000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>stamps1</code> dataset contains additional information that can be used to shed light on the selected model. In particular, thickness measurements can be grouped according to the year of consignment: the first 289 stamps refer to the 1872 issue and the remaining 196 stamps to the years 1873–1874. We may draw a (suitably scaled) histogram for each year-of-consignment and then add the estimated component densities as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Year</span> <span class="op">=</span> <span class="va">stamps1</span><span class="op">$</span><span class="va">year</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span></span>
<span><span class="co">## Year</span></span>
<span><span class="co">##      1872 1873-1874 </span></span>
<span><span class="co">##       289       196</span></span>
<span><span class="va">h1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">Thickness</span><span class="op">[</span><span class="va">Year</span> <span class="op">==</span> <span class="st">"1872"</span><span class="op">]</span>, breaks <span class="op">=</span> <span class="va">br</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">h1</span><span class="op">$</span><span class="va">density</span> <span class="op">=</span> <span class="va">h1</span><span class="op">$</span><span class="va">density</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">h2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">Thickness</span><span class="op">[</span><span class="va">Year</span> <span class="op">==</span> <span class="st">"1873-1874"</span><span class="op">]</span>, breaks <span class="op">=</span> <span class="va">br</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">h2</span><span class="op">$</span><span class="va">density</span> <span class="op">=</span> <span class="va">h2</span><span class="op">$</span><span class="va">density</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Thickness</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">Thickness</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>, </span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Thickness</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">Thickness</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>, length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">cdens</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">dens</span>, <span class="va">x</span>, what <span class="op">=</span> <span class="st">"cdens"</span><span class="op">)</span></span>
<span><span class="va">cdens</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html">sweep</a></span><span class="op">(</span><span class="va">cdens</span>, <span class="fl">2</span>, <span class="va">dens</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">pro</span>, <span class="st">"*"</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">ylim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">h1</span><span class="op">$</span><span class="va">density</span>, <span class="va">h2</span><span class="op">$</span><span class="va">density</span>, <span class="va">cdens</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">h1</span>, xlab <span class="op">=</span> <span class="st">"Thickness"</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">""</span>, border <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="va">ylim</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">h2</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>, border <span class="op">=</span> <span class="st">"white"</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">cdens</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">col</span>, pch <span class="op">=</span> <span class="fl">15</span>, inset <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Overprinted years:"</span>, title.adj <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-stamp2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-stamp2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-stamp2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stamp2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: Histograms of thickness by overprinted year for the Hidalgo 1872 <code>stamps1</code> dataset, with mixture component-density estimates superimposed.
</figcaption></figure>
</div>
</div>
</div>
<p>The result is shown in <a href="#fig-stamp2" class="quarto-xref">Figure&nbsp;<span>5.2</span></a>. Stamps from 1872 show a two-part distribution, with one component corresponding to the largest thickness, and one whose distribution essentially overlaps with the bimodal distribution of stamps for the years 1873–1874.</p>
</div>
<div id="exm-acidity" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.2</strong></span> &nbsp;&nbsp;<strong>Density estimation of acidity data</strong></p>
<p>Consider the distribution of an acidity index measured on a sample of 155 lakes in the Northeastern United States. The data have been analyzed on the logarithmic scale using mixtures of normal distributions by <span class="citation" data-cites="Richardson:Green:1997">Richardson and Green (<a href="99_references.html#ref-Richardson:Green:1997" role="doc-biblioref">1997</a>)</span> and <span class="citation" data-cites="McLachlan:Peel:2000">(<a href="99_references.html#ref-McLachlan:Peel:2000" role="doc-biblioref">McLachlan and Peel 2000, sec. 6.6.2</a>)</span>. The dataset is included in the CRAN package <strong>BNPdensity</strong> <span class="citation" data-cites="Arbel:etal:2021 Rpkg:BNPdensity">(<a href="99_references.html#ref-Arbel:etal:2021" role="doc-biblioref">Arbel et al. 2021</a>; <a href="99_references.html#ref-Rpkg:BNPdensity" role="doc-biblioref">Barrios et al. 2021</a>)</span> and can be accessed as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"acidity"</span>, package <span class="op">=</span> <span class="st">"BNPdensity"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using BIC as the model selection criterion, the “best” estimated model with respect to both the variance structure and the number of components can be obtained as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu">mclustBIC</span><span class="op">(</span><span class="va">acidity</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##              E,2       V,3       V,2       E,5      E,3</span></span>
<span><span class="co">## BIC      -392.07 -397.9108 -399.6945 -400.6745 -402.183</span></span>
<span><span class="co">## BIC diff    0.00   -5.8385   -7.6222   -8.6022  -10.111</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>BIC supports the two-component model with equal variance across the components (<code>E</code>,2). This model can be estimated as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dens_E2</span> <span class="op">=</span> <span class="fu">densityMclust</span><span class="op">(</span><span class="va">acidity</span>, G <span class="op">=</span> <span class="fl">2</span>, modelNames <span class="op">=</span> <span class="st">"E"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dens_E2</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## Density estimation via Gaussian finite mixture modeling </span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust E (univariate, equal variance) model with 2 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC     ICL</span></span>
<span><span class="co">##         -185.95 155  4 -392.07 -398.56</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2 </span></span>
<span><span class="co">## 0.62336 0.37664 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##      1      2 </span></span>
<span><span class="co">## 4.3709 6.3202 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">##       1       2 </span></span>
<span><span class="co">## 0.18637 0.18637</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we provisionally assume a GMM with unequal variances and decide the number of mixture components via the bootstrap LRT discussed in <a href="02_mixture.html#sec-bootstrapLRT" class="quarto-xref"><span>Section 2.3.2</span></a> instead of the BIC:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mclustBootstrapLRT</span><span class="op">(</span><span class="va">acidity</span>, modelName <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------------- </span></span>
<span><span class="co">## Bootstrap sequential LRT for the number of mixture components </span></span>
<span><span class="co">## ------------------------------------------------------------- </span></span>
<span><span class="co">## Model        = V </span></span>
<span><span class="co">## Replications = 999 </span></span>
<span><span class="co">##             LRTS bootstrap p-value</span></span>
<span><span class="co">## 1 vs 2   77.0933             0.001</span></span>
<span><span class="co">## 2 vs 3   16.9140             0.005</span></span>
<span><span class="co">## 3 vs 4    5.1838             0.301</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>LRT suggests a three-component Gaussian mixture (<code>V</code>,3), which was a fairly close second-best fit according to BIC. This (<code>V</code>,3) model can be estimated as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dens_V3</span> <span class="op">=</span> <span class="fu">densityMclust</span><span class="op">(</span><span class="va">acidity</span>, G <span class="op">=</span> <span class="fl">3</span>, modelNames <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dens_V3</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## Density estimation via Gaussian finite mixture modeling </span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust V (univariate, unequal variance) model with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC     ICL</span></span>
<span><span class="co">##         -178.78 155  8 -397.91 -458.86</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2       3 </span></span>
<span><span class="co">## 0.34061 0.31406 0.34534 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##      1      2      3 </span></span>
<span><span class="co">## 4.2040 4.6796 6.3809 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">##        1        2        3 </span></span>
<span><span class="co">## 0.044195 0.338309 0.178276</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The parameter estimates for the GMMs are available from the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> output, and the corresponding density functions can be plotted <!-- \index{mclust!\code{plot.densityMclust()}}  --> with the following code:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens_E2</span>, what <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dens_E2</span><span class="op">$</span><span class="va">density</span>, <span class="va">dens_V3</span><span class="op">$</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">acidity</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens_V3</span>, what <span class="op">=</span> <span class="st">"density"</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dens_E2</span><span class="op">$</span><span class="va">density</span>, <span class="va">dens_V3</span><span class="op">$</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">acidity</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-acidity_dens" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-acidity_dens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-acidity_dens" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-acidity_dens-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-acidity_dens-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-acidity_dens-1.png" id="fig-acidity_dens-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-acidity_dens">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-acidity_dens-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-acidity_dens" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-acidity_dens-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-acidity_dens-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-acidity_dens-2.png" id="fig-acidity_dens-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-acidity_dens">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-acidity_dens-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-acidity_dens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Density estimates provided by (a) the model (<code>E</code>,2) supported by BIC and (b) the model (<code>V</code>,3) supported by the LRT for the <code>acidity</code> data.
</figcaption></figure>
</div>
<p><a href="#fig-acidity_dens" class="quarto-xref">Figure&nbsp;<span>5.3</span></a> shows the plots of the estimated densities. The two models largely agree, with the exception of a somewhat different shape for some lower-range values. In particular, both densities indicate a bimodal distribution.</p>
</div>
<section id="diagnostics-for-univariate-density-estimation" class="level3" data-number="5.3.1"><h3 data-number="5.3.1" class="anchored" data-anchor-id="diagnostics-for-univariate-density-estimation">
<span class="header-section-number">5.3.1</span> Diagnostics for Univariate Density Estimation</h3>
<p>Two diagnostic plots for density estimation are available for univariate data <span class="citation" data-cites="Loader:1999">(for details see <a href="99_references.html#ref-Loader:1999" role="doc-biblioref">Loader 1999, 87–90</a>)</span>. The first plot is a graph of the estimated cumulative distribution function (CDF) against the empirical distribution function. The second is a Q-Q plot of the sample quantiles against the quantiles computed from the estimated density. For a GMM, the estimated CDF is just the weighted sum of individual CDFs for each component. It can be obtained in <strong>mclust</strong> via the function <code><a href="https://mclust-org.github.io/mclust/reference/cdfMclust.html">cdfMclust()</a></code>. <!-- \index{mclust!\code{cdfMclust()}} --></p>
<div id="exm-acidity2" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.3</strong></span> &nbsp;&nbsp;<strong>Diagnostic for density estimation of acidity data</strong></p>
<p>Recalling <a href="#exm-acidity" class="quarto-xref">Example&nbsp;<span>5.2</span></a> on <code>acidity</code> data, diagnostic plots for the (<code>E</code>,2) model can be obtained as follows:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens_E2</span>, what <span class="op">=</span> <span class="st">"diagnostic"</span>, type <span class="op">=</span> <span class="st">"cdf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens_E2</span>, what <span class="op">=</span> <span class="st">"diagnostic"</span>, type <span class="op">=</span> <span class="st">"qq"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-acidity_E2_diagn" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-acidity_E2_diagn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-acidity_E2_diagn" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-acidity_E2_diagn-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-acidity_E2_diagn-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-acidity_E2_diagn-1.png" id="fig-acidity_E2_diagn-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-acidity_E2_diagn">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-acidity_E2_diagn-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-acidity_E2_diagn" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-acidity_E2_diagn-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-acidity_E2_diagn-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-acidity_E2_diagn-2.png" id="fig-acidity_E2_diagn-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-acidity_E2_diagn">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-acidity_E2_diagn-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-acidity_E2_diagn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: Density estimate diagnostics for the (<code>E</code>,2) model estimated for the <code>acidity</code> data: (a) estimated CDF and empirical distribution function, (b) Q-Q plot of sample quantiles vs.&nbsp;quantiles from density estimation.
</figcaption></figure>
</div>
<p>Similarly, for the model (<code>V</code>,3):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens_V3</span>, what <span class="op">=</span> <span class="st">"diagnostic"</span>, type <span class="op">=</span> <span class="st">"cdf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens_V3</span>, what <span class="op">=</span> <span class="st">"diagnostic"</span>, type <span class="op">=</span> <span class="st">"qq"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-acidity_V3_diagn" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-acidity_V3_diagn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-acidity_V3_diagn" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-acidity_V3_diagn-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-acidity_V3_diagn-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-acidity_V3_diagn-1.png" id="fig-acidity_V3_diagn-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-acidity_V3_diagn">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-acidity_V3_diagn-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-acidity_V3_diagn" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-acidity_V3_diagn-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-acidity_V3_diagn-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-acidity_V3_diagn-2.png" id="fig-acidity_V3_diagn-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-acidity_V3_diagn">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-acidity_V3_diagn-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-acidity_V3_diagn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: Density estimate diagnostics for the (<code>V</code>,3) model estimated for the <code>acidity</code> data: (a) estimated CDF and empirical distribution function, (b) Q-Q plot of sample quantiles vs.&nbsp;quantiles from density estimation.
</figcaption></figure>
</div>
<p><a href="#fig-acidity_E2_diagn-1" class="quarto-xref">Figure&nbsp;<span>5.4 (a)</span></a> and <a href="#fig-acidity_V3_diagn-1" class="quarto-xref">Figure&nbsp;<span>5.5 (a)</span></a> compare the estimated CDFs to the empirical CDF. <a href="#fig-acidity_E2_diagn-2" class="quarto-xref">Figure&nbsp;<span>5.4 (b)</span></a> and <a href="#fig-acidity_V3_diagn-2" class="quarto-xref">Figure&nbsp;<span>5.5 (b)</span></a> show the corresponding Q-Q plots for the two models. Both types of diagnostics seem to suggest a better fit to the observed data for the more complex model, with perhaps one outlying point corresponding to the smallest value.</p>
</div>
</section></section><section id="sec-densityhd" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="sec-densityhd">
<span class="header-section-number">5.4</span> Density Estimation in Higher Dimensions</h2>
<p>In principle, density estimation in higher dimensions is straightforward with <strong>mclust</strong>. The structure imposed by the Gaussian components allows a parsimonious representation of the underlying density, especially when compared to KDE approaches. However, density estimation in high dimensions is problematic in general. Another issue is that visualizing densities beyond three dimensions is difficult. Following the suggestion of <span class="citation" data-cites="Scott:2009">(<a href="99_references.html#ref-Scott:2009" role="doc-biblioref">Scott 2009, 217</a>)</span>, we should investigate “density estimation in several dimensions rather than in very high dimensions”.</p>
<div id="exm-iris-dens" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.4</strong></span> &nbsp;&nbsp;<strong>Density estimation of Old Faithful data</strong></p>
<p>Consider the Old Faithful data described in <a href="03_cluster.html#exm-oldfaithful" class="quarto-xref">Example&nbsp;<span>3.4</span></a>}. A scatterplot of the data is shown in <a href="#fig-faithful-1" class="quarto-xref">Figure&nbsp;<span>5.6 (a)</span></a>. This and the corresponding density estimate can be obtained with the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"faithful"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span><span class="va">dens</span> <span class="op">=</span> <span class="fu">densityMclust</span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dens</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## Density estimation via Gaussian finite mixture modeling </span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust EEE (ellipsoidal, equal volume, shape and orientation) model</span></span>
<span><span class="co">## with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC     ICL</span></span>
<span><span class="co">##         -1126.3 272 11 -2314.3 -2357.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2       3 </span></span>
<span><span class="co">## 0.16568 0.35637 0.47795 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##              [,1]    [,2]    [,3]</span></span>
<span><span class="co">## eruptions  3.7931  2.0376  4.4632</span></span>
<span><span class="co">## waiting   77.5211 54.4912 80.8334</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">## [,,1]</span></span>
<span><span class="co">##           eruptions waiting</span></span>
<span><span class="co">## eruptions  0.078254  0.4802</span></span>
<span><span class="co">## waiting    0.480198 33.7671</span></span>
<span><span class="co">## [,,2]</span></span>
<span><span class="co">##           eruptions waiting</span></span>
<span><span class="co">## eruptions  0.078254  0.4802</span></span>
<span><span class="co">## waiting    0.480198 33.7671</span></span>
<span><span class="co">## [,,3]</span></span>
<span><span class="co">##           eruptions waiting</span></span>
<span><span class="co">## eruptions  0.078254  0.4802</span></span>
<span><span class="co">## waiting    0.480198 33.7671</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Model selection based on the BIC selects a three-component mixture with common covariance matrix (<code>EEE</code>,3). One component is used to model the group of observations having both low duration and low waiting times, whereas two components are needed to approximate the skewed distribution of the observations with larger duration and waiting times.</p>
<div id="fig-faithful" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-faithful-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful-1.png" id="fig-faithful-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful-2.png" id="fig-faithful-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful-3" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful-3.png" id="fig-faithful-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful-4" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful-4.png" id="fig-faithful-4" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-faithful-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.6: Scatterplot of the Old Faithful data (a), <strong>mclust</strong> density estimate represented as contour levels (b), image plot of density estimate (c), and perspective plot of the bivariate density estimate (d).
</figcaption></figure>
</div>
<p>For two-dimensional data, the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> <!-- `mclust!\code{plot.densityMclust()`}  --> method for the argument <code>what = "density"</code> is by default a contour plot of the density estimate, as shown in <a href="#fig-faithful-2" class="quarto-xref">Figure&nbsp;<span>5.6 (b)</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens</span>, what <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A bivariate density estimate may also be plotted using an image plot or a perspective plot (see <a href="#fig-faithful-3" class="quarto-xref">Figure&nbsp;<span>5.6 (c)</span></a> and <a href="#fig-faithful-4" class="quarto-xref">Figure&nbsp;<span>5.6 (d)</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens</span>, what <span class="op">=</span> <span class="st">"density"</span>, type <span class="op">=</span> <span class="st">"image"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens</span>, what <span class="op">=</span> <span class="st">"density"</span>, type <span class="op">=</span> <span class="st">"persp"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the above code we specified the <code>type</code> of density plot to produce. Several optional arguments for customizing the plots are available; for a complete description see <code><a href="https://mclust-org.github.io/mclust/reference/plot.densityMclust.html">help("plot.densityMclust")</a></code> and <code><a href="https://mclust-org.github.io/mclust/reference/surfacePlot.html">help("surfacePlot")</a></code>. More details on producing graphical displays with <strong>mclust</strong> are discussed in <a href="06_graphics.html#sec-display2" class="quarto-xref"><span>Section 6.2</span></a> and <a href="06_graphics.html#sec-displayhd" class="quarto-xref"><span>Section 6.3</span></a>.</p>
<p>Another useful approach to visualizing multivariate densities involves summarizing a density estimate with (possibly disjoint) regions of the sample space covering a specified probability. These are called Highest Density Regions (HDRs) <!-- \index{highest density regions (HDRs)} --> by <span class="citation" data-cites="Hyndman:1996">Hyndman (<a href="99_references.html#ref-Hyndman:1996" role="doc-biblioref">1996</a>)</span>; for details on the definition and the computational implementation see <a href="#sec-hdr" class="quarto-xref"><span>Section 5.6</span></a>.<br>
In <strong>mclust</strong>, HDRs can be easily obtained by specifying <code>type = "hdr"</code> in the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function applied to an object returned by a <code><a href="https://mclust-org.github.io/mclust/reference/densityMclust.html">densityMclust()</a></code> function call:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens</span>, what <span class="op">=</span> <span class="st">"density"</span>, type <span class="op">=</span> <span class="st">"hdr"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-faithful_hdr" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-faithful_hdr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful_hdr-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-faithful_hdr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.7: Highest density regions from the density estimated on the <code>faithful</code> data at probability levels 0.25, 0.5, and 0.75.
</figcaption></figure>
</div>
</div>
</div>
</div>
<p>For higher dimensional datasets <code><a href="https://mclust-org.github.io/mclust/reference/densityMclust.html">densityMclust()</a></code> provides graphical displays of density estimates using density contour, image, and perspective plots for pairs of variables arranged in a matrix.</p>
<div id="exm-aircraft" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.5</strong></span> &nbsp;&nbsp;<strong>Density estimation on principal components of the aircraft data</strong></p>
<p>Consider the dataset <code>aircraft</code>, available in the <strong>sm</strong> package <span class="citation" data-cites="Rpkg:sm">(<a href="99_references.html#ref-Rpkg:sm" role="doc-biblioref">A. Bowman et al. 2022</a>)</span> for R, giving measurements on six physical characteristics of twentieth-century aircraft. Following the analysis of <span class="citation" data-cites="Bowman:Azzalini:1997">A. W. Bowman and Azzalini (<a href="99_references.html#ref-Bowman:Azzalini:1997" role="doc-biblioref">1997, sec. 1.3</a>)</span>, we consider the principal components computed from the data on the log scale for the time period 1956–1984:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"aircraft"</span>, package <span class="op">=</span> <span class="st">"sm"</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">aircraft</span>, subset <span class="op">=</span> <span class="op">(</span><span class="va">Period</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span>, select <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PCA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">X</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">PCA</span><span class="op">)</span></span>
<span><span class="co">## Importance of components:</span></span>
<span><span class="co">##                          PC1   PC2    PC3     PC4     PC5     PC6</span></span>
<span><span class="co">## Standard deviation     2.085 1.064 0.6790 0.16892 0.15239 0.08771</span></span>
<span><span class="co">## Proportion of Variance 0.725 0.189 0.0769 0.00476 0.00387 0.00128</span></span>
<span><span class="co">## Cumulative Proportion  0.725 0.913 0.9901 0.99485 0.99872 1.00000</span></span>
<span><span class="va">PCA</span><span class="op">$</span><span class="va">rotation</span>       <span class="co"># loadings</span></span>
<span><span class="co">##             PC1       PC2      PC3        PC4       PC5       PC6</span></span>
<span><span class="co">## Power  -0.45612  0.262445  0.11357 -0.2267760 -0.565774 -0.581940</span></span>
<span><span class="co">## Span   -0.37433 -0.540127  0.32461 -0.5305967  0.417040 -0.085530</span></span>
<span><span class="co">## Length -0.46737 -0.088898  0.21657  0.7885789  0.260671 -0.192237</span></span>
<span><span class="co">## Weight -0.47409  0.036498  0.17017 -0.0121226 -0.365831  0.781647</span></span>
<span><span class="co">## Speed  -0.29394  0.731054 -0.15713 -0.2121675  0.551014  0.076387</span></span>
<span><span class="co">## Range  -0.34963 -0.309371 -0.88384  0.0045952 -0.024057 -0.016386</span></span>
<span><span class="va">Z</span> <span class="op">=</span> <span class="va">PCA</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>   <span class="co"># PCA projection</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Consider the fit of a GMM on the first three principal components (PCs), which explain 99% of total variability. The BIC criterion indicates a number of candidate models with almost the same support from the data.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BIC</span> <span class="op">=</span> <span class="fu">mclustBIC</span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BIC</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##            VEE,5        VVE,4      VEI,6     VVE,3      VEE,4</span></span>
<span><span class="co">## BIC      -1958.7 -1958.752723 -1961.8724 -1962.876 -1965.7162</span></span>
<span><span class="co">## BIC diff     0.0    -0.014737    -3.1344    -4.138    -6.9782</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We fit the simpler three-component model with varying volume and shape (<code>VVE</code>), and plot the estimated density (see <a href="#fig-aircraft" class="quarto-xref">Figure&nbsp;<span>5.8</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">densAircraft</span> <span class="op">=</span> <span class="fu">densityMclust</span><span class="op">(</span><span class="va">Z</span>, G <span class="op">=</span> <span class="fl">3</span>, modelNames <span class="op">=</span> <span class="st">"VVE"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">densAircraft</span>, what <span class="op">=</span> <span class="st">"density"</span>, type <span class="op">=</span> <span class="st">"hdr"</span>, </span>
<span>     data <span class="op">=</span> <span class="va">Z</span>, points.cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-aircraft" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-aircraft-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-aircraft-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aircraft-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.8: Scatterplot matrix of selected principal components of the <code>aircraft</code> data with bivariate highest density regions at probability levels 0.25, 0.5, and 0.75.
</figcaption></figure>
</div>
</div>
</div>
<p>The default probability levels <span class="math inline">\(0.25\)</span>, <span class="math inline">\(0.5\)</span>, and <span class="math inline">\(0.75\)</span> are used in these plots (for details see <a href="#sec-hdr" class="quarto-xref"><span>Section 5.6</span></a>). The plots are arranged in a symmetric matrix, where each off-diagonal panel shows the bivariate marginal density estimate. Data points have been also added to the upper-diagonal panels by providing the matrix of principal components to the optional argument <code>data</code>. The presence of several modes is clearly evident from this figure.</p>
</div>
</section><section id="sec-densbounded" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="sec-densbounded">
<span class="header-section-number">5.5</span> Density Estimation for Bounded Data</h2>
<p>Finite mixtures of Gaussian distributions provide a flexible model for density estimation when the continuous variables under investigation have no boundaries. However, in practical applications variables may be partially bounded (taking non-negative values) or completely bounded (taking values in the unit interval). In this case, the standard Gaussian finite mixture model assigns non-zero densities to any possible value, even to those outside the ranges where the variables are defined, hence resulting in potentially severe bias.</p>
<p>A transformation-based approach for Gaussian mixture modeling in the case of bounded variables has been recently proposed <span class="citation" data-cites="Scrucca:2019">(<a href="99_references.html#ref-Scrucca:2019" role="doc-biblioref">Scrucca 2019</a>)</span>. The basic idea is to carry out density estimation not on the original data <span class="math inline">\(\boldsymbol{x}\)</span> with bounded support <span class="math inline">\(\mathcal{S}_{\mathcal{X}} \subset \Real^d\)</span>, but on the transformed data <span class="math inline">\(\boldsymbol{y}= t(\boldsymbol{x}; \boldsymbol{\lambda})\)</span> having unbounded support <span class="math inline">\(\mathcal{S}_{\mathcal{Y}}\)</span>. A <em>range-power transformation</em> <!-- \index{range-power transformation for bound\-ed da\-ta} --> is used for <span class="math inline">\(t(\cdot ; \boldsymbol{\lambda})\)</span>. This is a monotonic transformation which depends on parameters <span class="math inline">\(\boldsymbol{\lambda}\)</span> and maps <span class="math inline">\(\mathcal{S}_{\mathcal{X}}\)</span> to <span class="math inline">\(\mathcal{S}_{\mathcal{Y}}\)</span>. The range part of the transformation differs depending on whether a variable has only a lower bound or has both a lower and an upper bound, while the power part of the transformation involves the well-known Box-Cox transformation <span class="citation" data-cites="Box:Cox:1964">(<a href="99_references.html#ref-Box:Cox:1964" role="doc-biblioref">Box and Cox 1964</a>)</span>. Once the density on the transformed scale is estimated, the density for the original data can be obtained by a change of variables using the Jacobian of the transformation. Both the transformation parameters and the parameters of the Gaussian mixture are jointly estimated by the EM algorithm. For more details see <span class="citation" data-cites="Scrucca:2019">Scrucca (<a href="99_references.html#ref-Scrucca:2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>The methodology briefly outlined above is implemented in the R package <strong>mclustAddons</strong> <span class="citation" data-cites="Rpkg:mclustAddons">(<a href="99_references.html#ref-Rpkg:mclustAddons" role="doc-biblioref">Scrucca 2022</a>)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mclust-org.github.io/mclustAddons/">"mclustAddons"</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="exm-suicide" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.6</strong></span> &nbsp;&nbsp;<strong>Density estimation of suicide data</strong></p>
<p>The dataset gives the lengths (in days) of 86 spells of psychiatric treatment undergone by control patients in a suicide risk study <span class="citation" data-cites="Silverman:1998">(<a href="99_references.html#ref-Silverman:1998" role="doc-biblioref">Silverman 1998</a>)</span>. Since the variable can only take positive values, in the following we contrast the density estimated ignoring this fact with the estimate obtained using the approach outlined above.</p>
<p>The following code estimates the density using the function <code><a href="https://mclust-org.github.io/mclust/reference/densityMclust.html">densityMclust()</a></code> with its default settings:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"suicide"</span>, package <span class="op">=</span> <span class="st">"mclustAddons"</span><span class="op">)</span></span>
<span><span class="va">dens</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/densityMclust.html">densityMclust</a></span><span class="op">(</span><span class="va">suicide</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">suicide</span><span class="op">)</span>            <span class="co"># add data points at the bottom of the graph</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co"># draw a vertical line at the natural boundary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting density is shown in <a href="#fig-suicide_dens-1" class="quarto-xref">Figure&nbsp;<span>5.9 (a)</span></a>. This is clearly unsatisfactory because it assigns nonzero density to negative values and exhibits a bimodal distribution, the latter being an artifact due to failure to account for the non-negativity.</p>
<p>The function <code><a href="https://mclust-org.github.io/mclustAddons/reference/densityMclustBounded.html">densityMclustBounded()</a></code> <!-- \index{mclust!\code{densityMclustBounded()}}  --> can be used for improved density estimation by specifying the lower bound of the variable:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bdens</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclustAddons/reference/densityMclustBounded.html">densityMclustBounded</a></span><span class="op">(</span><span class="va">suicide</span>, lbound <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bdens</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ── Density estimation for bounded data via GMMs ─────────── </span></span>
<span><span class="co">##            </span></span>
<span><span class="co">## Boundaries: suicide</span></span>
<span><span class="co">##       lower       0</span></span>
<span><span class="co">##       upper     Inf</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model E (univariate, equal variance) model with 1 component</span></span>
<span><span class="co">## on the transformation scale:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood  n df   BIC   ICL</span></span>
<span><span class="co">##         -497.82 86  3 -1009 -1009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                             suicide</span></span>
<span><span class="co">## Range-power transformation: 0.19293</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">## 1 </span></span>
<span><span class="co">## 1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##      1 </span></span>
<span><span class="co">## 6.7001 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">##      1 </span></span>
<span><span class="co">## 7.7883</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">bdens</span>, what <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">suicide</span><span class="op">)</span>            <span class="co"># add data points at the bottom of the graph</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co"># draw a vertical line at the natural boundary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The estimated parameter of the range-power transformation is equal to <span class="math inline">\(0.19\)</span>, and on the transformed scale the optimal GMM is a model with a single mixture component. The corresponding density estimate on the original scale of the variable is shown in <a href="#fig-suicide_dens-2" class="quarto-xref">Figure&nbsp;<span>5.9 (b)</span></a>. As the plot shows, accounting for the natural boundary of the variable better represents the underlying density of the data.</p>
<div id="fig-suicide_dens" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-suicide_dens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-suicide_dens" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-suicide_dens-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-suicide_dens-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-suicide_dens-1.png" id="fig-suicide_dens-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-suicide_dens">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-suicide_dens-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-suicide_dens" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-suicide_dens-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-suicide_dens-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-suicide_dens-2.png" id="fig-suicide_dens-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-suicide_dens">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-suicide_dens-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-suicide_dens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.9: Density estimates for the <code>suicide</code> data. Panel (a) shows the default estimate which ignores the lower boundary of the variable, while panel (b) shows the density estimated accounting for the natural boundary of the variable.
</figcaption></figure>
</div>
</div>
<div id="exm-racial" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.7</strong></span> &nbsp;&nbsp;<strong>Density estimation of racial data</strong></p>
<p>This dataset provides the proportion of white student enrollment in 56 school districts in Nassau County (Long Island, New York, USA), for the 1992–1993 school year <span class="citation" data-cites="Simonoff:1996">(<a href="99_references.html#ref-Simonoff:1996" role="doc-biblioref">Simonoff 1996, sec. 3.2</a>)</span>. Because each observation is a proportion, the density estimate for this data should not fall outside the <span class="math inline">\([0,1]\)</span> range.</p>
<p>The following code reads the data, performs density estimation by specifying both the lower and upper bounds of the variable under study, and plots the data and the estimated density:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"racial"</span>, package <span class="op">=</span> <span class="st">"mclustAddons"</span><span class="op">)</span></span>
<span><span class="va">bdens</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclustAddons/reference/densityMclustBounded.html">densityMclustBounded</a></span><span class="op">(</span><span class="va">racial</span><span class="op">$</span><span class="va">PropWhite</span>, lbound <span class="op">=</span> <span class="fl">0</span>, ubound <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">bdens</span>, what <span class="op">=</span> <span class="st">"density"</span>, </span>
<span>     lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"dodgerblue2"</span>,</span>
<span>     data <span class="op">=</span> <span class="va">racial</span><span class="op">$</span><span class="va">PropWhite</span>, breaks <span class="op">=</span> <span class="fl">15</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Proportion of white students enrolled in schools"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">racial</span><span class="op">$</span><span class="va">PropWhite</span><span class="op">)</span>        <span class="co"># add data points at the bottom of the graph</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co"># draw a vertical line at the natural boundary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-racial_dens" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-racial_dens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-racial_dens-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-racial_dens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.10: Density estimate for the <code>racial</code> data obtained by taking into account the natural boundary of the proportion.
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-racial_dens" class="quarto-xref">Figure&nbsp;<span>5.10</span></a> displays the estimated density, showing that the majority of the schools have at least 70% of white students, but there is also a small peak near the lower boundary containing schools with almost 0% of white students.</p>
</div>
</section><section id="sec-hdr" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="sec-hdr">
<span class="header-section-number">5.6</span> Highest Density Regions</h2>
<p>Density curves are a very effective and useful way to show the distribution of values in a dataset. For two-dimensional data, perspective and contour plots represent a standard way to visualize densities (see for instance <a href="#fig-faithful" class="quarto-xref">Figure&nbsp;<span>5.6</span></a>). An alternative method is discussed by <span class="citation" data-cites="Hyndman:1996">Hyndman (<a href="99_references.html#ref-Hyndman:1996" role="doc-biblioref">1996</a>)</span>, who proposed the use of <em>Highest Density Regions</em> (HDRs) <!-- \index{highest density regions (HDRs)}  --> for summarizing probability distributions. These are defined as the (possibly disjoint) regions of the sample space covering a specified probability level.</p>
<p>Let <span class="math inline">\(f(x)\)</span> be the density function of a random variable <span class="math inline">\(X\)</span>; then the <span class="math inline">\(100(1-\alpha)\%\)</span> HDR is the subset <span class="math inline">\(R(f_\alpha)\)</span> of the sample space of <span class="math inline">\(X\)</span> such that <span class="math display">\[
R(f_\alpha) = \{x : f(x) \ge f_\alpha \},
\]</span> where <span class="math inline">\(f_\alpha\)</span> is the largest value such that <span class="math inline">\(\Pr( X \in R(f_\alpha)) \ge 1-\alpha\)</span>.</p>
<p>For estimating <span class="math inline">\(R(f_\alpha)\)</span>, <span class="citation" data-cites="Hyndman:1996">Hyndman (<a href="99_references.html#ref-Hyndman:1996" role="doc-biblioref">1996</a>)</span> proposed considering the <span class="math inline">\((1-\alpha)\)</span>-quantile of the density function evaluated at the observed data points. The accuracy of this method depends on the sample size, so for small to moderate sample sizes the degree of accuracy can be improved by enlarging the set of observations with additional simulated data points.</p>
<p>For example, consider the density of a univariate two-component Gaussian mixture defined with the following code and shown in <a href="#fig-hdr_mixdens" class="quarto-xref">Figure&nbsp;<span>5.11</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>  <span class="fl">0.7</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="va">f</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, to <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hdr_mixdens" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-hdr_mixdens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hdr_mixdens-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hdr_mixdens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.11: Density of the univariate two-component Gaussian mixture <span class="math inline">\(f(x) = 0.7\phi(x | \mu = 0, \sigma = 1) + 0.3\phi(x | \mu = 4, \sigma = 1)\)</span>.
</figcaption></figure>
</div>
</div>
</div>
<p>A simulated dataset drawn from this mixture can be obtained as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">par</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.3</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>           variance <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclustVariance.html">mclustVariance</a></span><span class="op">(</span><span class="st">"E"</span>, G <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">par</span><span class="op">$</span><span class="va">variance</span><span class="op">$</span><span class="va">sigmasq</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim</a></span><span class="op">(</span>modelName <span class="op">=</span> <span class="st">"E"</span>, parameters <span class="op">=</span> <span class="va">par</span>, n <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first column returned by <code><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim()</a></code> contains the (randomly generated) classification and is therefore omitted. For details of the procedure, see <a href="07_miscellanea.html#sec-sim" class="quarto-xref"><span>Section 7.4</span></a>.</p>
<p>The highest density regions corresponding to specified probability levels can be computed using the function <code><a href="https://mclust-org.github.io/mclust/reference/hdrlevels.html">hdrlevels()</a></code>, <!-- \index{mclust!\code{hdrlevels()}} --> and then plotted as follows:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">hdr</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/hdrlevels.html">hdrlevels</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">prob</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##      25%      50%      75%      95% </span></span>
<span><span class="co">## 0.250682 0.158753 0.096956 0.048063</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="va">f</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, to <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">prob</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">*</span><span class="fl">100</span>, <span class="st">"% HDR"</span><span class="op">)</span>, adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">hdr</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">hdr</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-hdr_levels" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-hdr_levels-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hdr_levels" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hdr_levels-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hdr_levels-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hdr_levels-1.png" id="fig-hdr_levels-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hdr_levels">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hdr_levels-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hdr_levels" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hdr_levels-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hdr_levels-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hdr_levels-2.png" id="fig-hdr_levels-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hdr_levels">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hdr_levels-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hdr_levels" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hdr_levels-3" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hdr_levels-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hdr_levels-3.png" id="fig-hdr_levels-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hdr_levels">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hdr_levels-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hdr_levels" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-hdr_levels-4" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hdr_levels-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-hdr_levels-4.png" id="fig-hdr_levels-4" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-hdr_levels">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hdr_levels-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hdr_levels-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.12: Highest density regions at specified probability levels from the density of a univariate two-component Gaussian mixture.
</figcaption></figure>
</div>
<p>The resulting plots are shown in <a href="#fig-hdr_levels" class="quarto-xref">Figure&nbsp;<span>5.12</span></a>.</p>
<p>In general the true density function is unknown, so that an estimate must be used, but the procedure remains essentially unchanged. For instance, we may estimate the density with <strong>mclust</strong> and then obtain the HDR levels as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dens</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/densityMclust.html">densityMclust</a></span><span class="op">(</span><span class="va">x</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/hdrlevels.html">hdrlevels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">dens</span>, <span class="va">x</span><span class="op">)</span>, <span class="va">prob</span><span class="op">)</span></span>
<span><span class="co">##      25%      50%      75%      95% </span></span>
<span><span class="co">## 0.251234 0.159436 0.096781 0.048798</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Rpkg:multimode" class="csl-entry" role="listitem">
Ameijeiras-Alonso, Jose, Rosa M. Crujeiras, Alberto Rodríguez-Casal, The R Core Team 1996-2012, and The R Foundation 2005. 2021. <em><span class="nocase">multimode</span>: Mode Testing and Exploring</em>. <a href="https://CRAN.R-project.org/package=multimode">https://CRAN.R-project.org/package=multimode</a>.
</div>
<div id="ref-Arbel:etal:2021" class="csl-entry" role="listitem">
Arbel, Julyan, Guillaume Kon Kam King, Antonio Lijoi, Luis Nieto-Barajas, and Igor Prünster. 2021. <span>“<span>BNPdensity</span>: Bayesian Nonparametric Mixture Modelling in <span>R</span>.”</span> <em>Australian &amp; New Zealand Journal of Statistics</em> 63 (3): 542–64.
</div>
<div id="ref-Rpkg:BNPdensity" class="csl-entry" role="listitem">
Barrios, Ernesto, Guillaume Kon Kam King, Antonio Lijoi, Luis E. Nieto-Barajas, and Igor Prünster. 2021. <em><span>BNPdensity</span>: Ferguson-Klass Type Algorithm for Posterior Normalized Random Measures</em>. <a href="https://doi.org/10.1111/anzs.12342">https://doi.org/10.1111/anzs.12342</a>.
</div>
<div id="ref-Bowman:Azzalini:1997" class="csl-entry" role="listitem">
Bowman, A. W., and A. Azzalini. 1997. <em>Applied Smoothing Techniques for Data Analysis</em>. Oxford: Oxford University Press.
</div>
<div id="ref-Rpkg:sm" class="csl-entry" role="listitem">
Bowman, Adrian, Adelchi Azzalini. Ported to R by B. D. Ripley up to version 2.0, version 2.1 by Adrian Bowman, Adelchi Azzalini, and version 2.2 by Adrian Bowman. 2022. <em><span class="nocase">sm</span>: Smoothing Methods for Nonparametric Regression and Density Estimation</em>. <a href="https://CRAN.R-project.org/package=sm">https://CRAN.R-project.org/package=sm</a>.
</div>
<div id="ref-Box:Cox:1964" class="csl-entry" role="listitem">
Box, G. E., and D. R. Cox. 1964. <span>“An Analysis of Transformations.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 26 (2): 211–52.
</div>
<div id="ref-Rpkg:ks" class="csl-entry" role="listitem">
Duong, Tarn. 2022. <em><span class="nocase">ks</span>: Kernel Smoothing</em>. <a href="https://CRAN.R-project.org/package=ks">https://CRAN.R-project.org/package=ks</a>.
</div>
<div id="ref-Escobar:West:1995" class="csl-entry" role="listitem">
Escobar, Michael D, and Mike West. 1995. <span>“Bayesian Density Estimation and Inference Using Mixtures.”</span> <em>Journal of the American Statistical Association</em> 90 (430): 577–88.
</div>
<div id="ref-Ferguson:1983" class="csl-entry" role="listitem">
Ferguson, Thomas. 1983. <span>“Bayesian Density Estimation by Mixtures of Normal Distributions.”</span> In <em>Recent Advances in Statistics</em>, edited by M. Haseeb Rizvi, Jagdish S. Rustagi, and David Siegmund, 287–302. Academic Press.
</div>
<div id="ref-FruhwirthSchnatter:2006" class="csl-entry" role="listitem">
Frühwirth-Schnatter, Sylvia. 2006. <em>Finite Mixture and Markov Switching Models</em>. Springer.
</div>
<div id="ref-Hyndman:1996" class="csl-entry" role="listitem">
Hyndman, Rob J. 1996. <span>“Computing and Graphing Highest Density Regions.”</span> <em>The American Statistician</em> 50 (2): 120–26.
</div>
<div id="ref-Izenman:Sommer:1988" class="csl-entry" role="listitem">
Izenman, Alan J, and Charles J Sommer. 1988. <span>“Philatelic Mixtures and Multimodal Densities.”</span> <em>Journal of the American Statistical Association</em> 83 (404): 941–53.
</div>
<div id="ref-Loader:1999" class="csl-entry" role="listitem">
Loader, C. 1999. <em>Local Regression and Likelihood</em>. New York: Springer Verlag.
</div>
<div id="ref-Marron:Wand:1992" class="csl-entry" role="listitem">
Marron, J Steve, and Matt P Wand. 1992. <span>“Exact Mean Integrated Squared Error.”</span> <em>Annals of Statistics</em> 20 (2): 712–36.
</div>
<div id="ref-McLachlan:Peel:2000" class="csl-entry" role="listitem">
McLachlan, G. J., and D. Peel. 2000. <em>Finite Mixture Models</em>. New York: Wiley.
</div>
<div id="ref-Richardson:Green:1997" class="csl-entry" role="listitem">
Richardson, Sylvia, and Peter J Green. 1997. <span>“On <span>Bayesian</span> Analysis of Mixtures with an Unknown Number of Components (with Discussion).”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 59 (4): 731–92.
</div>
<div id="ref-Roeder:Wasserman:1997" class="csl-entry" role="listitem">
Roeder, K., and L. Wasserman. 1997. <span>“Practical <span>B</span>ayesian Density Estimation Using Mixtures of Normals.”</span> <em>Journal of the American Statistical Association</em> 92 (439): 894–902.
</div>
<div id="ref-Scott:2009" class="csl-entry" role="listitem">
Scott, David W. 2009. <em>Multivariate Density Estimation: Theory, Practice, and Visualization</em>. 2nd ed. John Wiley &amp; Sons.
</div>
<div id="ref-Scrucca:2019" class="csl-entry" role="listitem">
Scrucca, Luca. 2019. <span>“A Transformation-Based Approach to <span>G</span>aussian Mixture Density Estimation for Bounded Data.”</span> <em>Biometrical Journal</em> 61 (4): 1–16. <a href="https://doi.org/10.1002/bimj.201800174">https://doi.org/10.1002/bimj.201800174</a>.
</div>
<div id="ref-Rpkg:mclustAddons" class="csl-entry" role="listitem">
———. 2022. <em><span class="nocase">mclustAddons</span>: Addons for the ’Mclust’ Package</em>. <a href="https://CRAN.R-project.org/package=mclustAddons">https://CRAN.R-project.org/package=mclustAddons</a>.
</div>
<div id="ref-Silverman:1998" class="csl-entry" role="listitem">
Silverman, Bernard W. 1998. <em>Density Estimation for Statistics and Data Analysis</em>. Chapman &amp; Hall/CRC.
</div>
<div id="ref-Simonoff:1996" class="csl-entry" role="listitem">
Simonoff, J S. 1996. <em>Smoothing Methods in Statistics</em>. Springer.
</div>
<div id="ref-Titterington:etal:1985" class="csl-entry" role="listitem">
Titterington, D Michael, Adrian FM Smith, and Udi E Makov. 1985. <em>Statistical Analysis of Finite Mixture Distributions</em>. Chichester; New York: John Wiley &amp; Sons.
</div>
<div id="ref-Rpkg:KernSmooth" class="csl-entry" role="listitem">
Wand, Matt. 2021. <em><span>KernSmooth</span>: Functions for Kernel Smoothing Supporting Wand &amp; Jones (1995)</em>. <a href="https://CRAN.R-project.org/package=KernSmooth">https://CRAN.R-project.org/package=KernSmooth</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/04_classification.html" class="pagination-link" aria-label="Mixture-Based Classification">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mixture-Based Classification</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/06_graphics.html" class="pagination-link" aria-label="Visualizing Gaussian Mixture Models">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Visualizing Gaussian Mixture Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Model-Based Clustering, Classification, and <br> Density Estimation Using mclust in R</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>