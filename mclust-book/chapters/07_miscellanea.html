<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>7&nbsp; Miscellanea – Model-Based Clustering, Classification, and Density Estimation 
Using mclust in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/99_references.html" rel="next">
<link href="../chapters/06_graphics.html" rel="prev">
<link href="../images/cover.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/07_miscellanea.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Miscellanea</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Model-Based Clustering, Classification, and Density Estimation Using mclust in R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/00_preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Finite Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03_cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model-Based Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mixture-Based Classification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05_dens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model-Based Density Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06_graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Visualizing Gaussian Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07_miscellanea.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Miscellanea</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/99_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-noise_outliers" id="toc-sec-noise_outliers" class="nav-link active" data-scroll-target="#sec-noise_outliers"><span class="header-section-number">7.1</span> Accounting for Noise and Outliers</a></li>
  <li>
<a href="#sec-prior" id="toc-sec-prior" class="nav-link" data-scroll-target="#sec-prior"><span class="header-section-number">7.2</span> Using a Prior for Regularization</a>
  <ul class="collapse">
<li><a href="#sec-mclustprior" id="toc-sec-mclustprior" class="nav-link" data-scroll-target="#sec-mclustprior"><span class="header-section-number">7.2.1</span> Adding a Prior in mclust</a></li>
  </ul>
</li>
  <li>
<a href="#sec-nongausclust" id="toc-sec-nongausclust" class="nav-link" data-scroll-target="#sec-nongausclust"><span class="header-section-number">7.3</span> Non-Gaussian Clusters from GMMs</a>
  <ul class="collapse">
<li><a href="#sec-clustcombi" id="toc-sec-clustcombi" class="nav-link" data-scroll-target="#sec-clustcombi"><span class="header-section-number">7.3.1</span> Combining Gaussian Mixture Components for Clustering</a></li>
  <li><a href="#sec-gmmhd" id="toc-sec-gmmhd" class="nav-link" data-scroll-target="#sec-gmmhd"><span class="header-section-number">7.3.2</span> Identifying Connected Components in GMMs</a></li>
  </ul>
</li>
  <li><a href="#sec-sim" id="toc-sec-sim" class="nav-link" data-scroll-target="#sec-sim"><span class="header-section-number">7.4</span> Simulation from Mixture Densities</a></li>
  <li><a href="#large-datasets" id="toc-large-datasets" class="nav-link" data-scroll-target="#large-datasets"><span class="header-section-number">7.5</span> Large Datasets</a></li>
  <li><a href="#high-dimensional-data" id="toc-high-dimensional-data" class="nav-link" data-scroll-target="#high-dimensional-data"><span class="header-section-number">7.6</span> High-Dimensional Data</a></li>
  <li><a href="#missing-data" id="toc-missing-data" class="nav-link" data-scroll-target="#missing-data"><span class="header-section-number">7.7</span> Missing Data</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-miscellanea" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Miscellanea</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="hidden">
<p><span class="math display">\[
\DeclareMathOperator{\Real}{\mathbb{R}}
\DeclareMathOperator{\Proj}{\text{P}}
\DeclareMathOperator{\Exp}{\text{E}}
\DeclareMathOperator{\Var}{\text{Var}}
\DeclareMathOperator{\var}{\text{var}}
\DeclareMathOperator{\sd}{\text{sd}}
\DeclareMathOperator{\cov}{\text{cov}}
\DeclareMathOperator{\cor}{\text{cor}}
\DeclareMathOperator{\range}{\text{range}}
\DeclareMathOperator{\rank}{\text{rank}}
\DeclareMathOperator{\ind}{\perp\hspace*{-1.1ex}\perp}
\DeclareMathOperator{\CE}{\text{CE}}
\DeclareMathOperator{\BS}{\text{BS}}
\DeclareMathOperator{\ECM}{\text{ECM}}
\DeclareMathOperator{\BSS}{\text{BSS}}
\DeclareMathOperator{\WSS}{\text{WSS}}
\DeclareMathOperator{\TSS}{\text{TSS}}
\DeclareMathOperator{\BIC}{\text{BIC}}
\DeclareMathOperator{\ICL}{\text{ICL}}
\DeclareMathOperator{\CV}{\text{CV}}
\DeclareMathOperator{\diag}{\text{diag}}
\DeclareMathOperator{\se}{\text{se}}
\DeclareMathOperator{\Cov}{\text{Cov}}
\DeclareMathOperator{\boot}{\text{boot}}
\DeclareMathOperator{\LRTS}{\text{LRTS}}
\DeclareMathOperator{\Model}{\mathcal{M}}
\DeclareMathOperator*{\argmin}{arg\min}
\DeclareMathOperator*{\argmax}{arg\max}
\DeclareMathOperator{\vech}{vech}
\DeclareMathOperator{\tr}{tr}
\]</span></p>
<!-- \definecolor{quarto-callout-note-color}{HTML}{4477AA} -->
</div>
<p>In this chapter a range of other issues is discussed, including accounting for outliers and noise. The use of Bayesian methods is presented for avoiding singularities in mixture modeling by adding a prior. The problem of non-Gaussian clusters is addressed by introducing two approaches, one based on combining Gaussian mixture components according to an entropy criterion and one based on identifying connected components. Simulation from mixture models is also discussed briefly, as well as handling of large datasets, high-dimensional data, and missing data. Several data examples are used for illustrating the implementation of the methods in <strong>mclust</strong>.</p>
<section id="sec-noise_outliers" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="sec-noise_outliers">
<span class="header-section-number">7.1</span> Accounting for Noise and Outliers</h2>
<p>In the finite mixture framework, noisy data are characterized by the presence of outlying observations that do not belong to any mixture component. There are two main ways to accommodate noise and outliers in a mixture model:</p>
<ul>
<li><p>Adding one or more components to the mixture to represent noise and modifying the EM algorithm accordingly to estimate parameters <span class="citation" data-cites="Dasgupta:Raftery:1998 Fraley:Raftery:1998">(<a href="99_references.html#ref-Dasgupta:Raftery:1998" role="doc-biblioref">Dasgupta and Raftery 1998</a>; <a href="99_references.html#ref-Fraley:Raftery:1998" role="doc-biblioref">C. Fraley and Raftery 1998</a>)</span>.</p></li>
<li><p>Modeling by mixtures of distributions with heavier tails than the Gaussian, such as a mixture of <span class="math inline">\(t\)</span> distributions <span class="citation" data-cites="McLachlan:Peel:2000">(<a href="99_references.html#ref-McLachlan:Peel:2000" role="doc-biblioref">McLachlan and Peel 2000</a>)</span>.</p></li>
</ul>
<p>Some other alternatives for robust Gaussian mixture modeling are proposed in <span class="citation" data-cites="GarciaEscudero:etal:2008">Garcı́a-Escudero et al. (<a href="99_references.html#ref-GarciaEscudero:etal:2008" role="doc-biblioref">2008</a>)</span>, <span class="citation" data-cites="Punzo:McNicholas:2016">Punzo and McNicholas (<a href="99_references.html#ref-Punzo:McNicholas:2016" role="doc-biblioref">2016</a>)</span>, <span class="citation" data-cites="Coretto:Hennig:2016">Coretto and Hennig (<a href="99_references.html#ref-Coretto:Hennig:2016" role="doc-biblioref">2016</a>)</span>, and <span class="citation" data-cites="Dotto:Farcomeni:2019">Dotto and Farcomeni (<a href="99_references.html#ref-Dotto:Farcomeni:2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>In <strong>mclust</strong>, the strategy for accommodating noise is to include a constant–rate Poisson process mixture component to represent the noise, <!-- \index{Poisson constant–rate process for noise component} --> resulting in the following mixture log-likelihood <span id="eq-noise"><span class="math display">\[
\ell(\boldsymbol{\Psi}, \pi_0) = \sum_{i=1}^n \log
  \left\{ \frac{\pi_0}{V} +
          \sum_{k=1}^{G} \pi_k \phi (\boldsymbol{x}_i \mid \boldsymbol{\mu}_k, \boldsymbol{\Sigma}_k)
\right\},
\tag{7.1}\]</span></span> where <span class="math inline">\(V\)</span> is the hypervolume of the data region, and <span class="math inline">\(\pi_k \ge 0\)</span> are the mixing weights under the constraint <span class="math inline">\(\sum_{k=0}^{G} \pi_k = 1\)</span>. An observation contributes <span class="math inline">\(1/V\)</span> to the likelihood if it belongs to the noise component; otherwise its contribution comes from the Gaussian components. This model has been used successfully in a number of applications <span class="citation" data-cites="Banfield:Raftery:1993 Dasgupta:Raftery:1998 Campbell:etal:1997 Campbell:etal:1999">(<a href="99_references.html#ref-Banfield:Raftery:1993" role="doc-biblioref">Banfield and Raftery 1993</a>; <a href="99_references.html#ref-Dasgupta:Raftery:1998" role="doc-biblioref">Dasgupta and Raftery 1998</a>; <a href="99_references.html#ref-Campbell:etal:1997" role="doc-biblioref">J. Campbell et al. 1997</a>; <a href="99_references.html#ref-Campbell:etal:1999" role="doc-biblioref">J. G. Campbell et al. 1999</a>)</span>.</p>
<p>The model-fitting procedure is as follows. Given a preliminary noise assignment for the observations, model-based hierarchical clustering is applied to the correspondingly denoised data to obtain initial clustering partitions for the Gaussian portion of the mixture model. EM is then initialized, using the preliminary noise, together with the hierarchical clustering assignment for each number of clusters specified.</p>
<p>The effectiveness of this approach hinges on obtaining a good initial specification of the noise. Some possible strategies for initial denoising include methods based on Voronoï tessellation <span class="citation" data-cites="Allard:Fraley:1997">(<a href="99_references.html#ref-Allard:Fraley:1997" role="doc-biblioref">Allard and Fraley 1997</a>)</span>, nearest neighbors <span class="citation" data-cites="Byers:Raftery:1998">(<a href="99_references.html#ref-Byers:Raftery:1998" role="doc-biblioref">Byers and Raftery 1998</a>)</span>, and robust covariance estimation <span class="citation" data-cites="Wang:Raftery:2002">(<a href="99_references.html#ref-Wang:Raftery:2002" role="doc-biblioref">Wang and Raftery 2002</a>)</span>.</p>
<div id="exm-noise" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.1</strong></span> &nbsp;&nbsp;<strong>Clustering with noisy minefields data</strong></p>
<p><span class="citation" data-cites="Dasgupta:Raftery:1998">Dasgupta and Raftery (<a href="99_references.html#ref-Dasgupta:Raftery:1998" role="doc-biblioref">1998</a>)</span> discussed the problem of detecting surface-laid minefields from an aircraft image. The main goal was to distinguish the mines from the clutter (metal objects or rocks). As an example, consider the simulated minefield data with clutter analyzed in <span class="citation" data-cites="Fraley:Raftery:1998">C. Fraley and Raftery (<a href="99_references.html#ref-Fraley:Raftery:1998" role="doc-biblioref">1998</a>)</span> and available in <strong>mclust</strong>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"chevron"</span>, package <span class="op">=</span> <span class="st">"mclust"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">chevron</span><span class="op">)</span></span>
<span><span class="co">##    class           x                y         </span></span>
<span><span class="co">##  data :350   Min.   :  1.18   Min.   :  1.01  </span></span>
<span><span class="co">##  noise:754   1st Qu.: 34.39   1st Qu.: 27.51  </span></span>
<span><span class="co">##              Median : 58.82   Median : 49.50  </span></span>
<span><span class="co">##              Mean   : 61.09   Mean   : 56.71  </span></span>
<span><span class="co">##              3rd Qu.: 86.52   3rd Qu.: 86.67  </span></span>
<span><span class="co">##              Max.   :127.49   Max.   :127.86</span></span>
<span><span class="va">noise</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">chevron</span>, <span class="va">class</span> <span class="op">==</span> <span class="st">"noise"</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="va">chevron</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">X</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">X</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">noise</span>, <span class="st">"grey"</span>, <span class="st">"black"</span><span class="op">)</span>, </span>
<span>     pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">noise</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-chevron1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-chevron1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-chevron1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-chevron1-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-chevron1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-chevron1-1.png" id="fig-chevron1-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-chevron1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-chevron1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-chevron1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-chevron1-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-chevron1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-chevron1-2.png" id="fig-chevron1-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-chevron1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-chevron1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chevron1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: Simulated minefield data (a), marked to distinguish the known noise (b).
</figcaption></figure>
</div>
<p>The plot of simulated minefield data is shown in panel (a) of <a href="#fig-chevron1" class="quarto-xref">Figure&nbsp;<span>7.1</span></a>, while panel (b) displays the dataset with noise (clutter) marked by a grey cross. Note that about 70% of the data points are clutter, and the true minefield is contained within the chevron-shaped area, consisting of two intersecting rectangles.</p>
<p>To include noise in modeling with <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust()</a></code> or <code><a href="https://mclust-org.github.io/mclust/reference/mclustBIC.html">mclustBIC()</a></code>, an initial guess of the noise observations must be supplied via the <code>noise</code> component of the <code>initialization</code> argument. <!-- \index{mclust!\code{noise}} --> The function <code><a href="https://rdrr.io/pkg/prabclus/man/NNclean.html">NNclean()</a></code> in the R package <strong>prabclus</strong> <span class="citation" data-cites="Rpkg:prabclus">(<a href="99_references.html#ref-Rpkg:prabclus" role="doc-biblioref">Hennig and Hausdorf 2020</a>)</span> is an implementation of the methodology proposed by <span class="citation" data-cites="Byers:Raftery:1998">Byers and Raftery (<a href="99_references.html#ref-Byers:Raftery:1998" role="doc-biblioref">1998</a>)</span>. Under the assumption that the noise is distributed as a homogeneous Poisson point process and that the remaining data is also distributed as a homogeneous Poisson process but with higher intensity on a (possibly disconnected) subregion, the observed <span class="math inline">\(k\)</span>th nearest neighbor distances are modeled as a mixture of two transformed Gamma distributions with parameters estimated by the EM algorithm. The observed points can then be assigned to either the noise or higher-density component depending on the estimated posterior probabilities.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://www.unibo.it/sitoweb/christian.hennig/en/">"prabclus"</a></span><span class="op">)</span></span>
<span><span class="va">nnc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/prabclus/man/NNclean.html">NNclean</a></span><span class="op">(</span><span class="va">X</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">nnc</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   0   1 </span></span>
<span><span class="co">## 662 442</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clPairs.html">clPairs</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">nnc</span><span class="op">$</span><span class="va">z</span>, colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkgrey"</span>, <span class="st">"black"</span><span class="op">)</span>, symbols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This example uses <span class="math inline">\(k=5\)</span> nearest neighbors to detect the noise, which amounts to <span class="math inline">\(662/1104 \approx 60\%\)</span> of the observed data points. The resulting denoised data is shown in <a href="#fig-chevron2-1" class="quarto-xref">Figure&nbsp;<span>7.2 (a)</span></a>}. With this initial estimate of the noise, a GMM is fitted with the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modNoise</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">X</span>, initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>noise <span class="op">=</span> <span class="op">(</span><span class="va">nnc</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modNoise</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##           EEV,2       EVE,2       EVV,2</span></span>
<span><span class="co">## BIC      -21128 -21128.2301 -21134.7385</span></span>
<span><span class="co">## BIC diff      0     -0.4463     -6.9546</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model-based clustering procedure with the noise component selects the (<code>EEV</code>,2) model, closely followed by the (<code>EVE</code>,2) model. In both cases two clusters are correctly identified. A summary of the estimated model with the highest BIC and the corresponding classification plot are obtained as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modNoise</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust EEV (ellipsoidal, equal volume and shape) model with 2</span></span>
<span><span class="co">## components and a noise term: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood    n df    BIC    ICL</span></span>
<span><span class="co">##          -10525 1104 11 -21128 -21507</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1   2   0 </span></span>
<span><span class="co">## 160 151 793 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2       0 </span></span>
<span><span class="co">## 0.12290 0.12618 0.75091 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##     [,1]   [,2]</span></span>
<span><span class="co">## x 71.473 39.519</span></span>
<span><span class="co">## y 36.310 31.566</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">## [,,1]</span></span>
<span><span class="co">##         x       y</span></span>
<span><span class="co">## x  195.85 -176.99</span></span>
<span><span class="co">## y -176.99  197.30</span></span>
<span><span class="co">## [,,2]</span></span>
<span><span class="co">##        x      y</span></span>
<span><span class="co">## x 183.00 176.47</span></span>
<span><span class="co">## y 176.47 210.15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Hypervolume of noise component:</span></span>
<span><span class="co">## 16022</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">chevron</span><span class="op">$</span><span class="va">class</span>, <span class="va">modNoise</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">##        </span></span>
<span><span class="co">##           0   1   2 Sum</span></span>
<span><span class="co">##   data   50 156 144 350</span></span>
<span><span class="co">##   noise 743   4   7 754</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modNoise</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The summary output consists of the usual statistics for the selected GMM, plus an estimate of the hypervolume associated with the noise component. The classification obtained is shown in <a href="#fig-chevron2" class="quarto-xref">Figure&nbsp;<span>7.2</span></a>, which reflects the generating process for the data quite well. The cross-tabulation of the estimated classification and the known data labels shows that most of the clutter is correctly identified, as is the true minefield. The sensitivity is <span class="math inline">\(= 743/754 = 98.54\%\)</span>, and the specificity is <span class="math inline">\(= (156+144)/350 = 85.71\%\)</span>.</p>
<div id="fig-chevron2" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-chevron2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-chevron2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-chevron2-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-chevron2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-chevron2-1.png" id="fig-chevron2-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-chevron2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-chevron2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-chevron2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-chevron2-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-chevron2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-chevron2-2.png" id="fig-chevron2-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-chevron2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-chevron2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chevron2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.2: Model-based clustering of a simulated minefield with noise: (a) initial denoised minefield data; (b) model-based clustering partition obtained with the noise component.
</figcaption></figure>
</div>
<p>By default <strong>mclust</strong> uses the function <code><a href="https://mclust-org.github.io/mclust/reference/hypvol.html">hypvol()</a></code> <!-- \index{mclust!\code{hypvol()}}  --> to compute the hypervolume <!-- \index{hypervolume} --> <span class="math inline">\(V\)</span> in <a href="#eq-noise" class="quarto-xref">Equation&nbsp;<span>7.1</span></a>. This gives a simple approximation to the hypervolume of a multivariate dataset by taking the minimum of the volume hyperrectangle (box) containing the observed data and the box obtained from principal components. In other words, the estimate is the minimum of the Cartesian product of the variable intervals and the Cartesian product of the corresponding projection onto principal components.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/hypvol.html">hypvol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co">## [1] 16022</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Another option is to compute the <em>ellipsoid hull</em>, <!-- \index{ellipsoid hull} --> namely the ellipsoid of minimal volume such that all observed points lie either inside or on the boundary of the ellipsoid. This method is available via the function <code><a href="https://rdrr.io/pkg/cluster/man/ellipsoidhull.html">ellipsoidhull()</a></code> from the <strong>cluster</strong> R package <span class="citation" data-cites="Rpkg:cluster">(<a href="99_references.html#ref-Rpkg:cluster" role="doc-biblioref">Maechler et al. 2022</a>)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/cluster/">"cluster"</a></span><span class="op">)</span></span>
<span><span class="va">ehull</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/ellipsoidhull.html">ellipsoidhull</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/volume.ellipsoid.html">volume</a></span><span class="op">(</span><span class="va">ehull</span><span class="op">)</span></span>
<span><span class="co">## [1] 23150</span></span>
<span><span class="va">modNoise.ehull</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">X</span>, Vinv <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/volume.ellipsoid.html">volume</a></span><span class="op">(</span><span class="va">ehull</span><span class="op">)</span>,</span>
<span>                         initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>noise <span class="op">=</span> <span class="op">(</span><span class="va">nnc</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modNoise.ehull</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VVE (ellipsoidal, equal orientation) model with 3 components and</span></span>
<span><span class="co">## a noise term: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood    n df    BIC    ICL</span></span>
<span><span class="co">##          -10777 1104 17 -21673 -22618</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1   2   3   0 </span></span>
<span><span class="co">## 187 192 302 423</span></span>
<span><span class="va">tab</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">chevron</span><span class="op">$</span><span class="va">class</span>, <span class="va">modNoise.ehull</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="va">tab</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">##        </span></span>
<span><span class="co">##           0   1   2   3 Sum</span></span>
<span><span class="co">##   data    0 164 164  22 350</span></span>
<span><span class="co">##   noise 423  23  28 280 754</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this case the number of clusters identified is too large, yielding a poor recovery of the noise component (sensitivity <span class="math inline">\(= 423/754 = 56.1\%\)</span>, and specificity <span class="math inline">\(= (164+164+22)/350 = 100\%\)</span>). This behavior is a consequence of the ellipsoid hull over-estimating the data volume (to be expected because the noise is distributed over a square, so that a larger volume ellipsoid is needed to contain all the data points). The hyperrectangle approach discussed above would in all cases be a better approximation to the data volume than the ellipsoid hull. However, the volume of the convex hull of the data better approximates the data volume than either of these approaches.</p>
<p>The following code obtains the volume of the convex hull <!-- \index{convex hull volume}  --> for the bivariate minefield simulated data, using the <code><a href="https://rdrr.io/pkg/geometry/man/convhulln.html">convhulln()</a></code> function from package <strong>geometry</strong> <span class="citation" data-cites="Rpkg:geometry">(<a href="99_references.html#ref-Rpkg:geometry" role="doc-biblioref">Habel et al. 2022</a>)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://davidcsterratt.github.io/geometry/">"geometry"</a></span><span class="op">)</span></span>
<span><span class="va">chull</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/geometry/man/convhulln.html">convhulln</a></span><span class="op">(</span><span class="va">X</span>, options <span class="op">=</span> <span class="st">"FA"</span><span class="op">)</span></span>
<span><span class="va">chull</span><span class="op">$</span><span class="va">vol</span></span>
<span><span class="co">## [1] 15828</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--
CF: I also think that I should have used the log hypervolume, rather than the reciprocal  hypervolume, as input to `Mclust()`. 
Probably not practical to change at this point, but maybe we can add `Vlog` as an additional argument at some point.
-->
<p>The reciprocal of this value may be used as input for the argument <code>Vinv</code> of function <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modNoise.chull</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">X</span>, Vinv <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">chull</span><span class="op">$</span><span class="va">vol</span>,</span>
<span>                        initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>noise <span class="op">=</span> <span class="op">(</span><span class="va">nnc</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modNoise.chull</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust EEV (ellipsoidal, equal volume and shape) model with 2</span></span>
<span><span class="co">## components and a noise term: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood    n df    BIC    ICL</span></span>
<span><span class="co">##          -10515 1104 11 -21108 -21487</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1   2   0 </span></span>
<span><span class="co">## 157 149 798</span></span>
<span><span class="va">tab</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">chevron</span><span class="op">$</span><span class="va">class</span>, <span class="va">modNoise.chull</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="va">tab</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">##        </span></span>
<span><span class="co">##           0   1   2 Sum</span></span>
<span><span class="co">##   data   55 153 142 350</span></span>
<span><span class="co">##   noise 743   4   7 754</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For this dataset, the default value of the hypervolume and that computed using <code><a href="https://rdrr.io/pkg/geometry/man/convhulln.html">convhulln()</a></code> are quite close, so the corresponding estimated models provide essentially the same fit.</p>
<p>An issue with the convex hull is that it may not be practical to compute in high dimensions. Moreover, implementations without the option to return the logarithm could result in overflow or underflow depending on the scaling of the data.</p>
<!--
BM: Quick question. Wouldn't the convex hull have smallest volume? Or is my intuition wrong here?
CF: The convex hull would have the smallest volume among the options given, but it may be expensive to compute (certainly true in high-dimensions). The ellipsoid hull of the data would always be larger than the default rectangular approach --- no reason to consider it as an option.
-->
<p>Other strategies for obtaining an initial noise estimate could be adopted. The function <code><a href="https://rdrr.io/pkg/covRobust/man/cov.nnve.html">cov.nnve()</a></code> in the contributed R package <strong>covRobust</strong> <span class="citation" data-cites="Rpkg:covRobust">(<a href="99_references.html#ref-Rpkg:covRobust" role="doc-biblioref">Wang, Raftery, and Fraley 2017</a>)</span> is an implementation of robust covariance estimation via nearest neighbor cleaning <!-- \index{nearest neighbor cleaning robust covariance}  --> <span class="citation" data-cites="Wang:Raftery:2002">(<a href="99_references.html#ref-Wang:Raftery:2002" role="doc-biblioref">Wang and Raftery 2002</a>)</span>. An example of its usage is the following:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"covRobust"</span><span class="op">)</span></span>
<span><span class="va">nnve</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/covRobust/man/cov.nnve.html">cov.nnve</a></span><span class="op">(</span><span class="va">X</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">nnve</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    0    1 </span></span>
<span><span class="co">##    5 1099</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the case of <span class="math inline">\(k = 5\)</span> nearest neighbors, only <span class="math inline">\(5/1104 \approx 0.05\%\)</span> of data is classified as noise. A relatively good clustering model is nevertheless obtained with this initial estimate of the noise:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modNoise.nnve</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">X</span>, initialization <span class="op">=</span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>noise <span class="op">=</span> <span class="op">(</span><span class="va">nnve</span><span class="op">$</span><span class="va">classification</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modNoise.nnve</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##           EEV,2        EVE,2       EVV,2</span></span>
<span><span class="co">## BIC      -21128 -21128.20252 -21134.8273</span></span>
<span><span class="co">## BIC diff      0     -0.36423     -6.9891</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modNoise.nnve</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust EEV (ellipsoidal, equal volume and shape) model with 2</span></span>
<span><span class="co">## components and a noise term: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood    n df    BIC    ICL</span></span>
<span><span class="co">##          -10525 1104 11 -21128 -21509</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1   2   0 </span></span>
<span><span class="co">## 160 150 794</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">chevron</span><span class="op">$</span><span class="va">class</span>, <span class="va">modNoise.nnve</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">##        </span></span>
<span><span class="co">##           0   1   2 Sum</span></span>
<span><span class="co">##   data   51 153 146 350</span></span>
<span><span class="co">##   noise 743   7   4 754</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Although the final model is somewhat different from the one previously selected, this one also has 2 components, and the classification of data as signal or noise is almost identical (sensitivity <span class="math inline">\(= 743/754 = 98.54\%\)</span>, and specificity <span class="math inline">\(= (153+146)/350 = 85.43\%\)</span>). By increasing the number of nearest neighbors <span class="math inline">\(k\)</span> for the initial noise estimate, the results for the <code><a href="https://rdrr.io/pkg/covRobust/man/cov.nnve.html">cov.nnve()</a></code> denoising approach those obtained with <code>NNclean</code>.</p>
</div>
<div id="exm-outliers" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.2</strong></span> &nbsp;&nbsp;<strong>Clustering with outliers on simulated data</strong></p>
<p><span class="citation" data-cites="Peel:McLachlan:2000">Peel and McLachlan (<a href="99_references.html#ref-Peel:McLachlan:2000" role="doc-biblioref">2000</a>)</span> developed a simulation-based example in the context of fitting of mixtures of (multivariate) <span class="math inline">\(t\)</span> distributions to model data containing observations with longer than normal tails or atypical observations. The data used in their example is generated as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">Sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>                dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## , , 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]  2.0  0.5</span></span>
<span><span class="co">## [2,]  0.5  0.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]    1  0.0</span></span>
<span><span class="co">## [2,]    0  0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]  2.0 -0.5</span></span>
<span><span class="co">## [2,] -0.5  0.5</span></span>
<span><span class="va">var.decomp</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/sigma2decomp.html">sigma2decomp</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">var.decomp</span><span class="op">)</span></span>
<span><span class="co">## List of 7</span></span>
<span><span class="co">## $ sigma : num [1:2, 1:2, 1:3] 2 0.5 0.5 0.5 1 0 0 0.1 2 -0.5 ...</span></span>
<span><span class="co">## $ d : int 2</span></span>
<span><span class="co">## $ modelName : chr "VVI"</span></span>
<span><span class="co">## $ G : int 3</span></span>
<span><span class="co">## $ scale : num [1:3] 0.866 0.316 0.866</span></span>
<span><span class="co">## $ shape : num [1:2, 1:3] 2.484 0.403 3.162 0.316 2.484 ...</span></span>
<span><span class="co">## $ orientation: num [1:2, 1:2] -0.957 -0.29 0.29 -0.957</span></span>
<span><span class="va">par</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>            mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            variance <span class="op">=</span> <span class="va">var.decomp</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">variance</span><span class="op">$</span><span class="va">modelName</span>, parameters <span class="op">=</span> <span class="va">par</span>, n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">noise</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">50</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">noise</span><span class="op">)</span></span>
<span><span class="va">cluster</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clPairs.html">clPairs</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">cluster</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>        colors <span class="op">=</span> <span class="st">"black"</span>, symbols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the code above we used the function <code><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim()</a></code> to simulate 200 observations from a GMM with the specified mixing probabilities <code>pro</code>, component means <code>mean</code>, and variance decomposition <code>var.decomp</code> obtained using the function <code><a href="https://mclust-org.github.io/mclust/reference/sigma2decomp.html">sigma2decomp()</a></code> (see <a href="#sec-sim" class="quarto-xref"><span>Section 7.4</span></a>). Then, we added 50 outlying observations from a uniform distribution on <span class="math inline">\((-10,10)\)</span>. The simulated data is shown in <a href="#fig-PeelMcLachSim-1" class="quarto-xref">Figure&nbsp;<span>7.3 (a)</span></a>.</p>
<p>We apply the same procedure adopted for noisy data in <a href="#exm-noise" class="quarto-xref">Example&nbsp;<span>7.1</span></a>. We get an initial estimate of the outlying observations with <code><a href="https://rdrr.io/pkg/prabclus/man/NNclean.html">NNclean()</a></code>, and then we apply <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust()</a></code> to all the data using this estimate of noise in the initialization step:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nnc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/prabclus/man/NNclean.html">NNclean</a></span><span class="op">(</span><span class="va">X</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">modNoise</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">X</span>, initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>noise <span class="op">=</span> <span class="op">(</span><span class="va">nnc</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modNoise</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##            VEI,3      VEE,3      VVI,3</span></span>
<span><span class="co">## BIC      -2243.8 -2249.2536 -2253.0499</span></span>
<span><span class="co">## BIC diff     0.0    -5.4888    -9.2851</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modNoise</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VEI (diagonal, equal shape) model with 3 components and a noise</span></span>
<span><span class="co">## term: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC     ICL</span></span>
<span><span class="co">##         -1083.2 250 14 -2243.8 -2267.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3  0 </span></span>
<span><span class="co">## 66 63 74 47 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##       1       2       3       0 </span></span>
<span><span class="co">## 0.25532 0.24244 0.28647 0.21578 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##        [,1]     [,2]     [,3]</span></span>
<span><span class="co">## x1 2.968281 -0.40142 -3.13151</span></span>
<span><span class="co">## x2 0.022729  3.01644  0.13098</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">## [,,1]</span></span>
<span><span class="co">##        x1      x2</span></span>
<span><span class="co">## x1 0.7887 0.00000</span></span>
<span><span class="co">## x2 0.0000 0.12971</span></span>
<span><span class="co">## [,,2]</span></span>
<span><span class="co">##       x1      x2</span></span>
<span><span class="co">## x1 1.896 0.00000</span></span>
<span><span class="co">## x2 0.000 0.31181</span></span>
<span><span class="co">## [,,3]</span></span>
<span><span class="co">##        x1      x2</span></span>
<span><span class="co">## x1 1.9577 0.00000</span></span>
<span><span class="co">## x2 0.0000 0.32195</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Hypervolume of noise component:</span></span>
<span><span class="co">## 377.35</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The clusters identified are shown in <a href="#fig-PeelMcLachSim-2" class="quarto-xref">Figure&nbsp;<span>7.3 (b)</span></a>, and the following code can be used to plot the result and obtain the confusion matrix:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modNoise</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cluster</span>, Classification <span class="op">=</span> <span class="va">modNoise</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##        Classification</span></span>
<span><span class="co">## cluster  0  1  2  3</span></span>
<span><span class="co">##       0 45  0  3  2</span></span>
<span><span class="co">##       1  2  0 60  0</span></span>
<span><span class="co">##       2  0 64  0  0</span></span>
<span><span class="co">##       3  0  2  0 72</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This shows that the three groups (labeled “1”, “2”, “3”) and the outlying observations (labeled “0”) have been well identified.</p>
<div id="fig-PeelMcLachSim" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-PeelMcLachSim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-PeelMcLachSim" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-PeelMcLachSim-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-PeelMcLachSim-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-PeelMcLachSim-1.png" id="fig-PeelMcLachSim-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-PeelMcLachSim">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-PeelMcLachSim-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-PeelMcLachSim" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-PeelMcLachSim-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-PeelMcLachSim-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-PeelMcLachSim-2.png" id="fig-PeelMcLachSim-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-PeelMcLachSim">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-PeelMcLachSim-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PeelMcLachSim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.3: Model-based clustering of a bivariate mixture of normal distributions with outlying observations: (a) the simulated data; (b) model-based clustering partition obtained with the noise component. The small black points represent the simulated noise in (a) and the estimated noise in (b).
</figcaption></figure>
</div>
</div>
</section><section id="sec-prior" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="sec-prior">
<span class="header-section-number">7.2</span> Using a Prior for Regularization</h2>
<p>Maximum likelihood estimation for Gaussian mixtures using the EM algorithm may fail as the result of singularities or degeneracies. These problems can arise depending on the data and the starting values for the EM algorithm, as well as the model parameterizations and number of components specified for the mixture.</p>
<p>To address these situations, <span class="citation" data-cites="Fraley:Raftery:2007a">Chris Fraley and Raftery (<a href="99_references.html#ref-Fraley:Raftery:2007a" role="doc-biblioref">2007</a>)</span> proposed replacing the maximum likelihood estimate (MLE) by a maximum a posteriori (MAP) estimate, <!-- \index{maximum a posteriori estimate} --> also estimated by the EM algorithm. A highly dispersed proper conjugate prior <!-- \index{conjugate prior for GMMs} --> is used, containing a small fraction of one observation’s worth of information. The resulting method avoids degeneracies and singularities, but when these are not present it gives similar results to the standard maximum likelihood method. The prior also has the effect of smoothing noisy behavior of the BIC, which is often observed in conjunction with instability in estimation.</p>
<p>For univariate data, a Gaussian prior on the mean (conditional on the variance) is used: <span id="eq-univariatePriorMean"><span class="math display">\[
\begin{align}
\mu \mid \sigma^2
&amp; \sim \mathcal{N}(\mu_{\scriptscriptstyle \mathcal{P}}, \sigma^2/\kappa_{\scriptscriptstyle \mathcal{P}})
   \nonumber\\
&amp; \propto
   \left(\sigma^2\right)^{-\frac{1}{2}}
         \exp\left\{ - \frac{\kappa_{\scriptscriptstyle \mathcal{P}}}{2\sigma^2}
         \left(\mu - \mu_{\scriptscriptstyle \mathcal{P}}\right)^2
   \right\},  
\end{align}
\tag{7.2}\]</span></span> and an inverse gamma prior on the variance: <span id="eq-univariatePriorVar"><span class="math display">\[
\begin{align}
\sigma^2
&amp; \sim \mbox{inverseGamma}(\nu_{\scriptscriptstyle \mathcal{P}}/2, \varsigma^2_{\scriptscriptstyle \mathcal{P}}/2)
  \nonumber\\
&amp; \propto
  \left(\sigma^2\right)^{-\frac{\nu_{\scriptscriptstyle \mathcal{P}}+2}{2}}
        \exp \left\{ -\frac{\varsigma^2_{\scriptscriptstyle \mathcal{P}}}{2\sigma^2}
   \right\}.
\end{align}
\tag{7.3}\]</span></span></p>
<p>For multivariate data, a Gaussian prior on the mean (conditional on the covariance matrix) is used: <span id="eq-multivariatePriorMean"><span class="math display">\[
\begin{align}
\boldsymbol{\mu}\mid \boldsymbol{\Sigma}
&amp; \sim \mathcal{N}(\boldsymbol{\mu}_{\scriptscriptstyle \mathcal{P}}, \boldsymbol{\Sigma}/\kappa_{\scriptscriptstyle \mathcal{P}})
  \nonumber\\
&amp; \propto
  \left|\boldsymbol{\Sigma}\right|^{-\frac{1}{2}}
  \exp\left\{ -\frac{\kappa_{\scriptscriptstyle \mathcal{P}}}{2}
              \tr\left(\left(\boldsymbol{\mu}- \boldsymbol{\mu}_{\scriptscriptstyle \mathcal{P}}\right){}^{\!\top}
                       \boldsymbol{\Sigma}^{-1}
                       \left(\boldsymbol{\mu}- \boldsymbol{\mu}_{\scriptscriptstyle \mathcal{P}}\right)
                  \right)
      \right\},
\end{align}
\tag{7.4}\]</span></span> together with an inverse Wishart prior on the covariance matrix: <span id="eq-multivariatePriorVar"><span class="math display">\[
\begin{align}
\boldsymbol{\Sigma}
&amp; \sim \mbox{inverseWishart}(\nu_{\scriptscriptstyle \mathcal{P}}, \boldsymbol{\Lambda}_{\scriptscriptstyle \mathcal{P}})
  \nonumber\\
&amp; \propto
  \left|\boldsymbol{\Sigma}\right|^{-\frac{\nu_{\scriptscriptstyle \mathcal{P}}+d+1}{2}}
  \exp\left\{ -\frac{1}{2}
              \tr\left(\boldsymbol{\Sigma}^{-1} \boldsymbol{\Lambda}_{\scriptscriptstyle \mathcal{P}}^{-1}
                 \right)
      \right\}.
\end{align}
\tag{7.5}\]</span></span></p>
<p>The hyperparameters <span class="math inline">\(\mu_{\scriptscriptstyle \mathcal{P}}\)</span> (in the univariate case) or <span class="math inline">\(\boldsymbol{\mu}_{\scriptscriptstyle \mathcal{P}}\)</span> (in the multivariate case), <span class="math inline">\(\kappa_{\scriptscriptstyle \mathcal{P}}\)</span>, and <span class="math inline">\(\nu_{\scriptscriptstyle \mathcal{P}}\)</span> are called the <em>mean</em>, <em>shrinkage</em>, and <em>degrees of freedom</em>, respectively. Parameters <span class="math inline">\(\varsigma^2_{\scriptscriptstyle \mathcal{P}}\)</span> (a scalar, in the univariate case) and <span class="math inline">\(\boldsymbol{\Lambda}_{\scriptscriptstyle \mathcal{P}}\)</span> (a matrix, in the multivariate case) are the <em>scale</em> of the prior distribution. These priors are called <em>conjugate priors</em> for the normal distribution because the posterior can be expressed as the product of a normal distribution and an inverse gamma or Wishart distribution.</p>
<p>When a prior is included, a modified version of the BIC must be used to select the number of mixture components and the model parameterization. The BIC is computed as described in <a href="02_mixture.html#sec-infocrit" class="quarto-xref"><span>Section 2.3.1</span></a>, but with the log-likelihood evaluated at the MAP instead of at the MLE. Further details on model-based clustering using prior distributions can be found in <span class="citation" data-cites="Fraley:Raftery:2007a">Chris Fraley and Raftery (<a href="99_references.html#ref-Fraley:Raftery:2007a" role="doc-biblioref">2007</a>)</span>.</p>
<section id="sec-mclustprior" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="sec-mclustprior">
<span class="header-section-number">7.2.1</span> Adding a Prior in mclust</h3>
<p>Although maximum likelihood estimation is the default, functions such as <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust()</a></code> and <code><a href="https://mclust-org.github.io/mclust/reference/mclustBIC.html">mclustBIC()</a></code> have a <code>prior</code> argument that allows specification of a conjugate prior on the means and variances of the type described above. <strong>mclust</strong> provides two functions to facilitate inclusion of a prior:</p>
<ul>
<li><p><code><a href="https://mclust-org.github.io/mclust/reference/priorControl.html">priorControl()</a></code> <!-- \index{mclust!\code{priorControl()}} --> supplies input for the <code>prior</code> argument. It gives the name of the function that defines the desired conjugate prior and specifies values for its arguments.</p></li>
<li><p><code><a href="https://mclust-org.github.io/mclust/reference/defaultPrior.html">defaultPrior()</a></code> <!-- \index{mclust!\code{defaultPrior()}} --> is the default function named in <code><a href="https://mclust-org.github.io/mclust/reference/priorControl.html">priorControl()</a></code>, as well as a template for specifying conjugate priors in <strong>mclust</strong>.</p></li>
</ul>
<p>The <code><a href="https://mclust-org.github.io/mclust/reference/defaultPrior.html">defaultPrior()</a></code> function has the following arguments:</p>
<ul>
<li><p><code>data</code> A numeric vector, matrix, or data frame of observations.</p></li>
<li><p><code>G</code> An integer value specifying the number of mixture components.</p></li>
<li><p><code>modelName</code> A character string indicating the model to be fitted. Note that in the multivariate case only 10 out of 14 models are available, as indicated in <a href="03_cluster.html#tbl-mclust" class="quarto-xref">Table&nbsp;<span>3.1</span></a>.</p></li>
</ul>
<p>The following optional arguments can also be specified:</p>
<ul>
<li><p><code>mean</code> A single value <span class="math inline">\(\mu_{\scriptscriptstyle \mathcal{P}}\)</span> or a vector <span class="math inline">\(\boldsymbol{\mu}_{\scriptscriptstyle \mathcal{P}}\)</span> of values for the mean parameter of the prior. By default, the sample mean of each variable is used.</p></li>
<li><p><code>shrinkage</code> The shrinkage parameter <span class="math inline">\(\kappa_{\scriptscriptstyle \mathcal{P}}\)</span> for the prior on the mean. By default, <code>shrinkage = 0.01</code>. The posterior mean <span class="math display">\[
\frac{n_k \bar{\boldsymbol{x}}_k + \kappa_{\scriptscriptstyle \mathcal{P}}\boldsymbol{\mu}_{\scriptscriptstyle \mathcal{P}}}{\kappa_{\scriptscriptstyle \mathcal{P}}+ n_k},
\]</span> can be viewed as adding <span class="math inline">\(\kappa_{\scriptscriptstyle \mathcal{P}}\)</span> observations with value <span class="math inline">\(\boldsymbol{\mu}_{\scriptscriptstyle \mathcal{P}}\)</span> to each group in the data. The default value was determined by experimentation; values close to and larger than 1 caused large perturbations in the modeling in cases where there were no missing BIC values without the prior. The value <span class="math inline">\(\kappa_{\scriptscriptstyle \mathcal{P}}= 0.01\)</span> resulted in BIC curves that appeared to be smooth extensions of their counterparts without the prior. By setting <code>shrinkage = 0</code> or <code>shrinkage = NA</code> no prior is assumed for the mean.</p></li>
<li><p><code>dof</code> The degrees of freedom <span class="math inline">\(\nu_{\scriptscriptstyle \mathcal{P}}\)</span> for the prior on the variance. By analogy to the univariate case, the marginal prior distribution of <span class="math inline">\(\boldsymbol{\mu}\)</span> is a <span class="math inline">\(t\)</span> distribution centered at <span class="math inline">\(\boldsymbol{\mu}_{\scriptscriptstyle \mathcal{P}}\)</span> with <span class="math inline">\(\nu_{\scriptscriptstyle \mathcal{P}}- d + 1\)</span> degrees of freedom. The mean of this distribution is <span class="math inline">\(\boldsymbol{\mu}_{\scriptscriptstyle \mathcal{P}}\)</span> provided that <span class="math inline">\(\nu_{\scriptscriptstyle \mathcal{P}}&gt; d\)</span>, and it has a finite covariance matrix provided <span class="math inline">\(\nu_{\scriptscriptstyle \mathcal{P}}&gt; d + 1\)</span> <span class="citation" data-cites="Schafer:1997">(see, for example, <a href="99_references.html#ref-Schafer:1997" role="doc-biblioref">Joseph L. Schafer 1997</a>)</span>. By default, <span class="math inline">\(\nu_{\scriptscriptstyle \mathcal{P}}= d+2\)</span>, the smallest integer value for the degrees of freedom that gives a finite covariance matrix.</p></li>
<li><p><code>scale</code> The scale parameter for the prior on the variance.<br>
For univariate models and multivariate spherical or diagonal models, it is computed by default as <span class="math display">\[
\varsigma^2_{\scriptscriptstyle \mathcal{P}}= \frac{\tr(\boldsymbol{S})/d}{G^{2/d}},
\]</span> which is the average of the diagonal elements of the empirical covariance matrix <span class="math inline">\(\boldsymbol{S}\)</span> of the data, divided by the square of the number of components to the <span class="math inline">\(1/d\)</span> power. This is roughly equivalent to partitioning the range of the data into <span class="math inline">\(G\)</span> intervals of fairly equal size.<br>
For multivariate ellipsoidal models, it is computed by default as <span class="math display">\[
\boldsymbol{\Lambda}_{\scriptscriptstyle \mathcal{P}}= \frac{\boldsymbol{S}}{G^{2/d}},
\]</span> the covariance matrix, divided by the square of the number of components to the <span class="math inline">\(1/d\)</span> power.</p></li>
</ul>
<div id="exm-dens_prior_galaxies" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.3</strong></span> &nbsp;&nbsp;<strong>Density estimation with a prior on the Galaxies data</strong></p>
<p>Consider the data on the estimated velocity (km/sec) of 82 galaxies in the Corona Borealis region from <span class="citation" data-cites="Roeder:1990">Kathryn Roeder (<a href="99_references.html#ref-Roeder:1990" role="doc-biblioref">1990</a>)</span>, available in the <strong>MASS</strong> package <span class="citation" data-cites="Venables:Ripley:2013 Rpkg:MASS">(<a href="99_references.html#ref-Venables:Ripley:2013" role="doc-biblioref">Venables and Ripley 2013</a>; <a href="99_references.html#ref-Rpkg:MASS" role="doc-biblioref">Ripley 2022</a>)</span>. The interest lies in the identification of multimodality as evidence for clustering structures in the pattern of expansion.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"galaxies"</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span></span>
<span><span class="co"># now fix a typographical error in the data</span></span>
<span><span class="co"># see help("galaxies", package = "MASS")</span></span>
<span><span class="va">galaxies</span><span class="op">[</span><span class="fl">78</span><span class="op">]</span> <span class="op">=</span> <span class="fl">26960</span> </span>
<span><span class="va">galaxies</span> <span class="op">=</span> <span class="va">galaxies</span> <span class="op">/</span> <span class="fl">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We start the analysis with no prior, but using multiple random starts and retaining the best estimated fit in terms of BIC:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BIC</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">BIC0</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclustBIC.html">mclustBIC</a></span><span class="op">(</span><span class="va">galaxies</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>hcPairs <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/hcRandomPairs.html">hcRandomPairs</a></span><span class="op">(</span><span class="va">galaxies</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">BIC</span>  <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclustBICupdate.html">mclustBICupdate</a></span><span class="op">(</span><span class="va">BIC</span>, <span class="va">BIC0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BIC</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##              V,6       V,3       V,5       V,4       E,6</span></span>
<span><span class="co">## BIC      -440.06 -442.2177 -442.5948 -443.8970 -447.4629</span></span>
<span><span class="co">## BIC diff    0.00   -2.1543   -2.5314   -3.8335   -7.3994</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BIC</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/densityMclust.html">densityMclust</a></span><span class="op">(</span><span class="va">galaxies</span>, x <span class="op">=</span> <span class="va">BIC</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## Density estimation via Gaussian finite mixture modeling </span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust V (univariate, unequal variance) model with 6 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood  n df     BIC    ICL</span></span>
<span><span class="co">##         -182.57 82 17 -440.06 -447.6</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##        1        2        3        4        5        6 </span></span>
<span><span class="co">## 0.403204 0.085366 0.024390 0.024355 0.036585 0.426099 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##       1       2       3       4       5       6 </span></span>
<span><span class="co">## 19.7881  9.7101 16.1270 26.9775 33.0443 22.9162 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">##          1          2          3          4          5          6 </span></span>
<span><span class="co">## 0.45348851 0.17851527 0.00184900 0.00030625 0.84956356 1.45114183</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"density"</span>, data <span class="op">=</span> <span class="va">galaxies</span>, breaks <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">galaxies</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model with the largest BIC has 6 components, each with a different variance. Components with very small mixing weights correspond to narrow spikes in the density estimate (see <a href="#fig-galaxies1" class="quarto-xref">Figure&nbsp;<span>7.4</span></a>), suggesting them to be spurious.</p>
<div id="fig-galaxies1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-galaxies1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-galaxies1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-galaxies1-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-galaxies1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-galaxies1-1.png" id="fig-galaxies1-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-galaxies1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-galaxies1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-galaxies1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-galaxies1-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-galaxies1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-galaxies1-2.png" id="fig-galaxies1-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-galaxies1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-galaxies1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-galaxies1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.4: BIC plot without the prior (a) and density estimate for the (<code>V</code>,6) model selected according to BIC for the <code>galaxies</code> dataset.
</figcaption></figure>
</div>
<p>The previous analysis can be modified by including the prior as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BICp</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">BIC0p</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclustBIC.html">mclustBIC</a></span><span class="op">(</span><span class="va">galaxies</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                     prior <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/priorControl.html">priorControl</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>hcPairs <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/hcRandomPairs.html">hcRandomPairs</a></span><span class="op">(</span><span class="va">galaxies</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">BICp</span>  <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclustBICupdate.html">mclustBICupdate</a></span><span class="op">(</span><span class="va">BICp</span>, <span class="va">BIC0p</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BICp</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##              V,3      V,4       E,6       E,7       E,3</span></span>
<span><span class="co">## BIC      -443.96 -445.153 -447.6407 -450.6451 -452.0662</span></span>
<span><span class="co">## BIC diff    0.00   -1.196   -3.6833   -6.6878   -8.1088</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BICp</span><span class="op">)</span></span>
<span></span>
<span><span class="va">modp</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/densityMclust.html">densityMclust</a></span><span class="op">(</span><span class="va">galaxies</span>, x <span class="op">=</span> <span class="va">BICp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modp</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## Density estimation via Gaussian finite mixture modeling </span></span>
<span><span class="co">## ------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust V (univariate, unequal variance) model with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Prior: defaultPrior() </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood  n df     BIC     ICL</span></span>
<span><span class="co">##         -204.35 82  8 -443.96 -443.96</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##        1        2        3 </span></span>
<span><span class="co">## 0.085366 0.036585 0.878050 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##      1      2      3 </span></span>
<span><span class="co">##  9.726 33.004 21.404 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">##       1       2       3 </span></span>
<span><span class="co">## 0.36949 0.70599 4.51272</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modp</span>, what <span class="op">=</span> <span class="st">"density"</span>, data <span class="op">=</span> <span class="va">galaxies</span>, breaks <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">galaxies</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-galaxies2" class="quarto-xref">Figure&nbsp;<span>7.5</span></a> shows the BIC trace and the density estimate for the selected model. By including the prior, BIC fairly clearly chooses the model with three components and unequal variances. This is in agreement with other analyses reported in the literature <span class="citation" data-cites="Roeder:Wasserman:1997 Fraley:Raftery:2007a">(<a href="99_references.html#ref-Roeder:Wasserman:1997" role="doc-biblioref">K. Roeder and Wasserman 1997</a>; <a href="99_references.html#ref-Fraley:Raftery:2007a" role="doc-biblioref">Chris Fraley and Raftery 2007</a>)</span>.</p>
<div id="fig-galaxies2" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-galaxies2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-galaxies2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-galaxies2-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-galaxies2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-galaxies2-1.png" id="fig-galaxies2-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-galaxies2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-galaxies2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-galaxies2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-galaxies2-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-galaxies2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-galaxies2-2.png" id="fig-galaxies2-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-galaxies2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-galaxies2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-galaxies2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.5: BIC plot with the prior (a) and density estimate for the (<code>V</code>,3) model selected according to the BIC (based on the MAP, not the MLE) for the <code>galaxies</code> dataset.
</figcaption></figure>
</div>
<p>As explained in <a href="#sec-mclustprior" class="quarto-xref"><span>Section 7.2.1</span></a>, the function <code><a href="https://mclust-org.github.io/mclust/reference/priorControl.html">priorControl()</a></code> is provided for specifying a prior and its parameters. When used with its default settings, it specifies another function called <code><a href="https://mclust-org.github.io/mclust/reference/defaultPrior.html">defaultPrior()</a></code> which can serve as a template for alternative priors. An example of the result of a call to <code><a href="https://mclust-org.github.io/mclust/reference/defaultPrior.html">defaultPrior()</a></code> for the final model selected is shown below:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/defaultPrior.html">defaultPrior</a></span><span class="op">(</span><span class="va">galaxies</span>, G <span class="op">=</span> <span class="fl">3</span>, modelName <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span></span>
<span><span class="co">## $shrinkage</span></span>
<span><span class="co">## [1] 0.01</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mean</span></span>
<span><span class="co">## [1] 20.831</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $dof</span></span>
<span><span class="co">## [1] 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $scale</span></span>
<span><span class="co">## [1] 2.3187</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exm-cluster_prior_olive" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.4</strong></span> &nbsp;&nbsp;<strong>Clustering with a prior on the Italian olive oils data</strong></p>
<p>Consider the olive oils dataset presented in <a href="04_classification.html#exm-olive" class="quarto-xref">Example&nbsp;<span>4.8</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"olive"</span>, package <span class="op">=</span> <span class="st">"pgmm"</span><span class="op">)</span></span>
<span><span class="co"># recode of labels for Region and Area</span></span>
<span><span class="va">Regions</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"South"</span>, <span class="st">"Sardinia"</span>, <span class="st">"North"</span><span class="op">)</span></span>
<span><span class="va">Areas</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"North Apulia"</span>, <span class="st">"Calabria"</span>, <span class="st">"South Apulia"</span>, <span class="st">"Sicily"</span>, </span>
<span>           <span class="st">"Inland Sardinia"</span>, <span class="st">"Coastal Sardinia"</span>, <span class="st">"East Liguria"</span>, </span>
<span>           <span class="st">"West Liguria"</span>, <span class="st">"Umbria"</span><span class="op">)</span></span>
<span><span class="va">olive</span><span class="op">$</span><span class="va">Region</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">olive</span><span class="op">$</span><span class="va">Region</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, labels <span class="op">=</span> <span class="va">Regions</span><span class="op">)</span></span>
<span><span class="va">olive</span><span class="op">$</span><span class="va">Area</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">olive</span><span class="op">$</span><span class="va">Area</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, labels <span class="op">=</span> <span class="va">Areas</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">olive</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Area</span>, <span class="va">Region</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##                   Region</span></span>
<span><span class="co">## Area               South Sardinia North</span></span>
<span><span class="co">##   North Apulia        25        0     0</span></span>
<span><span class="co">##   Calabria            56        0     0</span></span>
<span><span class="co">##   South Apulia       206        0     0</span></span>
<span><span class="co">##   Sicily              36        0     0</span></span>
<span><span class="co">##   Inland Sardinia      0       65     0</span></span>
<span><span class="co">##   Coastal Sardinia     0       33     0</span></span>
<span><span class="co">##   East Liguria         0        0    50</span></span>
<span><span class="co">##   West Liguria         0        0    50</span></span>
<span><span class="co">##   Umbria               0        0    51</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We model the data on the standardized scale as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">olive</span><span class="op">[</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BIC</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclustBIC.html">mclustBIC</a></span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##           VVE,14     VVE,11    VVE,13</span></span>
<span><span class="co">## BIC      -4461.6 -4471.3336 -4480.081</span></span>
<span><span class="co">## BIC diff     0.0    -9.6941   -18.442</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BIC</span>, legendArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bottomright"</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BICp</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclustBIC.html">mclustBIC</a></span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, prior <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/priorControl.html">priorControl</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BICp</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##            VVV,6    VVV,7    VVV,5</span></span>
<span><span class="co">## BIC      -5446.7 -5584.27 -5590.59</span></span>
<span><span class="co">## BIC diff     0.0  -137.55  -143.86</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BICp</span>, legendArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bottomright"</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-olive1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-olive1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-olive1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-olive1-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-olive1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-olive1-1.png" id="fig-olive1-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-olive1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-olive1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-olive1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-olive1-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-olive1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-olive1-2.png" id="fig-olive1-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-olive1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-olive1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-olive1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.6: BIC plot without prior (a) and with prior (b) for the olive oil data.
</figcaption></figure>
</div>
<p>The BIC plots without and with a prior are shown in <a href="#fig-olive1" class="quarto-xref">Figure&nbsp;<span>7.6</span></a>. Without a prior, the model selected has a large number of mixture components, and a fairly poor clustering accuracy:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">X</span>, x <span class="op">=</span> <span class="va">BIC</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VVE (ellipsoidal, equal orientation) model with 14 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n  df     BIC     ICL</span></span>
<span><span class="co">##         -1389.6 572 265 -4461.6 -4504.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 </span></span>
<span><span class="co">## 29 51 34 65 54 90 66 32 11 29 16 41 38 16</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>Region <span class="op">=</span> <span class="va">olive</span><span class="op">$</span><span class="va">Region</span>, cluster <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##           cluster</span></span>
<span><span class="co">## Region      1  2  3  4  5  6  7  8  9 10 11 12 13 14</span></span>
<span><span class="co">##   South    29 51 34 65 54 90  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">##   Sardinia  0  0  0  0  0  0 66 32  0  0  0  0  0  0</span></span>
<span><span class="co">##   North     0  0  0  0  0  0  0  0 11 29 16 41 38 16</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span><span class="op">(</span><span class="va">olive</span><span class="op">$</span><span class="va">Region</span>, <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.24185</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>Area <span class="op">=</span> <span class="va">olive</span><span class="op">$</span><span class="va">Area</span>, cluster <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##                   cluster</span></span>
<span><span class="co">## Area                1  2  3  4  5  6  7  8  9 10 11 12 13 14</span></span>
<span><span class="co">##   North Apulia     23  0  1  1  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">##   Calabria          0 48  2  6  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">##   South Apulia      0  0  6 57 53 90  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">##   Sicily            6  3 25  1  1  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">##   Inland Sardinia   0  0  0  0  0  0 65  0  0  0  0  0  0  0</span></span>
<span><span class="co">##   Coastal Sardinia  0  0  0  0  0  0  1 32  0  0  0  0  0  0</span></span>
<span><span class="co">##   East Liguria      0  0  0  0  0  0  0  0  0  1  4 41  4  0</span></span>
<span><span class="co">##   West Liguria      0  0  0  0  0  0  0  0  0  0  0  0 34 16</span></span>
<span><span class="co">##   Umbria            0  0  0  0  0  0  0  0 11 28 12  0  0  0</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span><span class="op">(</span><span class="va">olive</span><span class="op">$</span><span class="va">Area</span>, <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.54197</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model selected when the prior is included has 6 components with unconstrained variances and a much improved clustering accuracy:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modp</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">X</span>, x <span class="op">=</span> <span class="va">BICp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modp</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VVV (ellipsoidal, varying volume, shape, and orientation) model</span></span>
<span><span class="co">## with 6 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Prior: defaultPrior() </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n  df     BIC     ICL</span></span>
<span><span class="co">##         -1869.4 572 269 -5446.7 -5451.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1   2   3   4   5   6 </span></span>
<span><span class="co">## 127 196  98  36  58  57</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>Region <span class="op">=</span> <span class="va">olive</span><span class="op">$</span><span class="va">Region</span>, cluster <span class="op">=</span> <span class="va">modp</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##           cluster</span></span>
<span><span class="co">## Region       1   2   3   4   5   6</span></span>
<span><span class="co">##   South    127 196   0   0   0   0</span></span>
<span><span class="co">##   Sardinia   0   0  98   0   0   0</span></span>
<span><span class="co">##   North      0   0   0  36  58  57</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span><span class="op">(</span><span class="va">olive</span><span class="op">$</span><span class="va">Region</span>, <span class="va">modp</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.56313</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>Area <span class="op">=</span> <span class="va">olive</span><span class="op">$</span><span class="va">Area</span>, cluster <span class="op">=</span> <span class="va">modp</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##                   cluster</span></span>
<span><span class="co">## Area                 1   2   3   4   5   6</span></span>
<span><span class="co">##   North Apulia      25   0   0   0   0   0</span></span>
<span><span class="co">##   Calabria          56   0   0   0   0   0</span></span>
<span><span class="co">##   South Apulia      10 196   0   0   0   0</span></span>
<span><span class="co">##   Sicily            36   0   0   0   0   0</span></span>
<span><span class="co">##   Inland Sardinia    0   0  65   0   0   0</span></span>
<span><span class="co">##   Coastal Sardinia   0   0  33   0   0   0</span></span>
<span><span class="co">##   East Liguria       0   0   0   0  43   7</span></span>
<span><span class="co">##   West Liguria       0   0   0   0   0  50</span></span>
<span><span class="co">##   Umbria             0   0   0  36  15   0</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span><span class="op">(</span><span class="va">olive</span><span class="op">$</span><span class="va">Area</span>, <span class="va">modp</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.78261</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The clusters identified correspond approximately to the areas of origin of the olive oil samples. One cluster encompasses both the inland and coastal areas of Sardinia, and two clusters include the southern regions, with one almost completely composed of the south of Apulia. Another three clusters correspond to northern regions: one for all the olive oils from west Liguria and a few from east Liguria, one mostly composed of east Liguria and a few from Umbria, and the last cluster composed only of olive oils from Umbria.</p>
</div>
</section></section><section id="sec-nongausclust" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="sec-nongausclust">
<span class="header-section-number">7.3</span> Non-Gaussian Clusters from GMMs</h2>
<p>Cluster analysis aims to identify groups of similar observations that are relatively separated from each other. In the model-based approach to clustering, data is modeled by a finite mixture of density functions belonging to a given parametric class. Each component is typically associated with a group or cluster. This framework can be extended to non-Gaussian clusters by modeling them with more than one mixture component. This problem was addressed by <span class="citation" data-cites="Baudry:etal:2010">Baudry et al. (<a href="99_references.html#ref-Baudry:etal:2010" role="doc-biblioref">2010</a>)</span>, who proposed a method based on an entropy criterion for hierarchically combining mixture components to form clusters. <!-- \index{combining mixture components}. --> <span class="citation" data-cites="Hennig:2010">Hennig (<a href="99_references.html#ref-Hennig:2010" role="doc-biblioref">2010</a>)</span> also discussed hierarchical merging methods based on unimodality and misclassification probabilities. Another approach based on the identification of cluster cores corresponding to regions of high density is introduced by <span class="citation" data-cites="Scrucca:2016">Scrucca (<a href="99_references.html#ref-Scrucca:2016" role="doc-biblioref">2016</a>)</span>.</p>
<section id="sec-clustcombi" class="level3" data-number="7.3.1"><h3 data-number="7.3.1" class="anchored" data-anchor-id="sec-clustcombi">
<span class="header-section-number">7.3.1</span> Combining Gaussian Mixture Components for Clustering</h3>
<p>The function <code><a href="https://mclust-org.github.io/mclust/reference/clustCombi.html">clustCombi()</a></code> <!-- \index{mclust!\code{clustCombi()}}  --> provides a means for obtaining models with clusters represented by multiple mixture components, as illustrated below.</p>
<div id="exm-merge_sim_data" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.5</strong></span> &nbsp;&nbsp;<strong>Merging Gaussian mixture components on simulated data</strong></p>
<p>Consider the following simulated two-dimensional dataset with overlapping components as discussed in <span class="citation" data-cites="Baudry:etal:2010">Baudry et al. (<a href="99_references.html#ref-Baudry:etal:2010" role="doc-biblioref">2010, sec. 4.1</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Baudry_etal_2010_JCGS_examples"</span>, package <span class="op">=</span> <span class="st">"mclust"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ex4.1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ex4-1_fig1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ex4-1_fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ex4-1_fig1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex4-1_fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.7: The <code>ex4.1</code> simulated dataset.
</figcaption></figure>
</div>
</div>
</div>
<p>A sample of 600 observations was generated from a mixture of six Gaussian components, although it would be reasonable to conclude from the spatial distribution of the data that there are only four clusters. The data is shown in <a href="#fig-ex4-1_fig1" class="quarto-xref">Figure&nbsp;<span>7.7</span></a>. Two of the clusters are formed from overlapping axis-aligned components (diagonal covariance matrices), while the remaining two clusters are elliptical but not axis-aligned.</p>
<p>The estimated model maximizing the BIC criterion is the following:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod_ex4.1</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">ex4.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_ex4.1</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust EEV (ellipsoidal, equal volume and shape) model with 6</span></span>
<span><span class="co">## components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC     ICL</span></span>
<span><span class="co">##         -1957.8 600 25 -4075.5 -4248.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1   2   3   4   5   6 </span></span>
<span><span class="co">##  78 122 121 107 132  40</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code><a href="https://mclust-org.github.io/mclust/reference/clustCombi.html">clustCombi()</a></code>, following the methodology described in <span class="citation" data-cites="Baudry:etal:2010">Baudry et al. (<a href="99_references.html#ref-Baudry:etal:2010" role="doc-biblioref">2010</a>)</span>, combines the mixture components hierarchically according to an entropy criterion. The estimated models with numbers of classes ranging from a single class to the number of components selected by BIC are returned as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">CLUSTCOMBI</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clustCombi.html">clustCombi</a></span><span class="op">(</span><span class="va">mod_ex4.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">CLUSTCOMBI</span><span class="op">)</span></span>
<span><span class="co">## ----------------------------------------------------</span></span>
<span><span class="co">## Combining Gaussian mixture components for clustering </span></span>
<span><span class="co">## ----------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust model name: EEV </span></span>
<span><span class="co">## Number of components: 6 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Combining steps:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Step | Classes combined at this step | Class labels after this step</span></span>
<span><span class="co">## -------|-------------------------------|-----------------------------</span></span>
<span><span class="co">##    0   |              ---              | 1 2 3 4 5 6 </span></span>
<span><span class="co">##    1   |             3 &amp; 4             | 1 2 3 5 6 </span></span>
<span><span class="co">##    2   |             1 &amp; 6             | 1 2 3 5 </span></span>
<span><span class="co">##    3   |             3 &amp; 5             | 1 2 3 </span></span>
<span><span class="co">##    4   |             1 &amp; 2             | 1 3 </span></span>
<span><span class="co">##    5   |             1 &amp; 3             | 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The summary output shows the mixture model <code>EEV</code> with 6 components selected by the BIC criterion, followed by information describing the combining steps. The hierarchy of combined components can be displayed graphically as follows (see <a href="#fig-ex4-1_clustcombi" class="quarto-xref">Figure&nbsp;<span>7.8</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">CLUSTCOMBI</span>, <span class="va">ex4.1</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ex4-1_clustcombi" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ex4-1_clustcombi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ex4-1_clustcombi-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex4-1_clustcombi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.8: Hierarchy of mixture component combinations for the <code>ex4.1</code> dataset.
</figcaption></figure>
</div>
</div>
</div>
<p>The process of merging mixture components can also be represented using tree diagrams:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">CLUSTCOMBI</span>, what <span class="op">=</span> <span class="st">"tree"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">CLUSTCOMBI</span>, what <span class="op">=</span> <span class="st">"tree"</span>, type <span class="op">=</span> <span class="st">"rectangle"</span>, yaxis <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-ex4-1_clustcombitree" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ex4-1_clustcombitree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-ex4-1_clustcombitree" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-ex4-1_clustcombitree-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-ex4-1_clustcombitree-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ex4-1_clustcombitree-1.png" id="fig-ex4-1_clustcombitree-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-ex4-1_clustcombitree">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ex4-1_clustcombitree-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-ex4-1_clustcombitree" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-ex4-1_clustcombitree-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-ex4-1_clustcombitree-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ex4-1_clustcombitree-2.png" id="fig-ex4-1_clustcombitree-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-ex4-1_clustcombitree">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ex4-1_clustcombitree-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex4-1_clustcombitree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.9: Dendrogram tree plots of the merging structure of mixture component combinations for the simulated <code>ex4.1</code> dataset.
</figcaption></figure>
</div>
<p><a href="#fig-ex4-1_clustcombitree-1" class="quarto-xref">Figure&nbsp;<span>7.9 (a)</span></a> shows the resulting tree obtained using the default arguments, <code>type = "triangle"</code> and <code>yaxis = "entropy"</code>. The first argument controls the type of dendrogram to plot; two options are available, namely, <code>"triangle"</code> and <code>"rectangle"</code>. The second argument controls the quantity to appear on the <span class="math inline">\(y\)</span>-axis; by default one minus the normalized entropy at each merging step is used. The option <code>yaxis = "step"</code> is also available to simply represent heights as successive steps, as shown in <a href="#fig-ex4-1_clustcombitree-2" class="quarto-xref">Figure&nbsp;<span>7.9 (b)</span></a>.</p>
<p>The clustering structures obtained with <code><a href="https://mclust-org.github.io/mclust/reference/clustCombi.html">clustCombi()</a></code> can be compared on substantive grounds or by selecting the number of clusters via a piecewise linear regression fit to the (possibly rescaled) “entropy plot”. An automatic procedure to help the user to select the optimal number of clusters using the above methodology based on the entropy is available through the function <code><a href="https://mclust-org.github.io/mclust/reference/clustCombiOptim.html">clustCombiOptim()</a></code>. <!-- \index{mclust!\code{clustCombiOptim()}}  --> For example, the following code</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">optimClust</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clustCombiOptim.html">clustCombiOptim</a></span><span class="op">(</span><span class="va">CLUSTCOMBI</span>, reg <span class="op">=</span> <span class="fl">2</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">optimClust</span><span class="op">)</span></span>
<span><span class="co">## List of 3</span></span>
<span><span class="co">## $ numClusters.combi: int 4</span></span>
<span><span class="co">## $ z.combi : num [1:600, 1:4] 1.00 1.00 5.78e-04 1.85e-42 3.85e-35 ...</span></span>
<span><span class="co">## $ cluster.combi : num [1:600] 1 1 2 3 3 4 4 3 3 2 ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ex4-1_clustcombioptim" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ex4-1_clustcombioptim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ex4-1_clustcombioptim-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex4-1_clustcombioptim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.10: Entropy plot for selecting the final clustering by merging mixture components for the simulated <code>ex4.1</code> dataset.
</figcaption></figure>
</div>
</div>
</div>
<p>produces the entropy plot in <a href="#fig-ex4-1_clustcombioptim" class="quarto-xref">Figure&nbsp;<span>7.10</span></a> and returns a list containing the number of clusters (<code>numClusters.combi</code>), the probabilities (<code>z.combi</code>) obtained by summing posterior conditional probabilities over merged components, and the clustering labels (<code>cluster.combi</code>) obtained by merging the mixture components. The optional argument <code>reg</code> is used to specify the number of segments to use in the piecewise linear regression fit. Possible choices are <code>2</code> (the default, for a model with two segments or one change point) and <code>3</code> (for a model with three segments or two change points). The entropy plot clearly suggests a four-cluster solution.</p>
</div>
<!-- \enlargethispage{2ex} -->
<!-- \clearpage -->
</section><section id="sec-gmmhd" class="level3" data-number="7.3.2"><h3 data-number="7.3.2" class="anchored" data-anchor-id="sec-gmmhd">
<span class="header-section-number">7.3.2</span> Identifying Connected Components in GMMs</h3>
<p>A limitation of approaches that successively combine mixture components is that, once merged, components cannot subsequently be reallocated to different clusters at a later stage of the algorithm.</p>
<p>Among the several definitions of “cluster” available in the literature, <span class="citation" data-cites="Hartigan:1975">(<a href="99_references.html#ref-Hartigan:1975" role="doc-biblioref">Hartigan 1975, 205</a>)</span> proposed that “[…] clusters may be thought of as regions of high density separated from other such regions by regions of low density.” From this perspective, <span class="citation" data-cites="Scrucca:2016">Scrucca (<a href="99_references.html#ref-Scrucca:2016" role="doc-biblioref">2016</a>)</span> defined high density clusters as connected components of density level sets. <!-- \index{connected components of high density level sets (GMMHD)}  --> Starting with a density estimate obtained from a Gaussian finite mixture model, cluster cores — those data points which form the core of the clusters — are obtained from the connected components at a given density level. A mode function gives the number of connected components as the level is varied. Once cluster cores are identified, the remaining observations are allocated to those cluster cores for which the probability of cluster membership is the highest. Details are provided in <span class="citation" data-cites="Scrucca:2016">Scrucca (<a href="99_references.html#ref-Scrucca:2016" role="doc-biblioref">2016</a>)</span> and implemented in the <code><a href="https://mclust-org.github.io/mclust/reference/gmmhd.html">gmmhd()</a></code> <!-- \index{mclust!\code{gmmhd()}}  --> function available in <strong>mclust</strong>. A non-parametric variant proposed by <span class="citation" data-cites="Azzalini:Menardi:2014">Azzalini and Menardi (<a href="99_references.html#ref-Azzalini:Menardi:2014" role="doc-biblioref">2014</a>)</span> is implemented in <strong>pdfCluster</strong> <span class="citation" data-cites="Rpkg:pdfCluster">(<a href="99_references.html#ref-Rpkg:pdfCluster" role="doc-biblioref">Menardi and Azzalini 2022</a>)</span>.</p>
<div id="exm-hd-oldfaithfull" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.6</strong></span> &nbsp;&nbsp;<strong>Identifying high density clusters on the Old Faithful data</strong></p>
<p>As a first example, consider the Old Faithful data described in <a href="03_cluster.html#exm-oldfaithful" class="quarto-xref">Example&nbsp;<span>3.4</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"faithful"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clPairs.html">clPairs</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclust-internal.html">as.densityMclust</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>, what <span class="op">=</span> <span class="st">"density"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-gmmhd_faithful-1" class="quarto-xref">Figure&nbsp;<span>7.11 (a)</span></a> shows the clustering partition obtained from the best estimated GMM according to BIC. The model selected is (<code>EEE</code>,3), a mixture of three components with common full covariance matrix. The portion of the data with high values for both <code>waiting</code> and <code>eruptions</code> is fitted with two Gaussian components. However, there appear to be two separate groups of points in the data as a whole, and the corresponding bivariate density estimate shown in <a href="#fig-gmmhd_faithful-1" class="quarto-xref">Figure&nbsp;<span>7.11 (a)</span></a> indicates the presence of two separate regions of high density.</p>
<p>The GMMHD approach <span class="citation" data-cites="Scrucca:2016">(<a href="99_references.html#ref-Scrucca:2016" role="doc-biblioref">Scrucca 2016</a>)</span> briefly outlined at the beginning of this section is implemented in the <code><a href="https://mclust-org.github.io/mclust/reference/gmmhd.html">gmmhd()</a></code> function available in <strong>mclust</strong>. This function requires as input an object returned by <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust()</a></code> or <code><a href="https://mclust-org.github.io/mclust/reference/densityMclust.html">densityMclust()</a></code> as the initial GMM. Many other input parameters can be set, and the interested reader should consult the documentation available through <code><a href="https://mclust-org.github.io/mclust/reference/gmmhd.html">help("gmmhd")</a></code>.</p>
<p>We apply the GMMHD algorithm to our example by invoking function <code><a href="https://mclust-org.github.io/mclust/reference/gmmhd.html">gmmhd()</a></code> and producing its summary output as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">GMMHD</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/gmmhd.html">gmmhd</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">GMMHD</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------------</span></span>
<span><span class="co">## GMM with high-density connected components for clustering </span></span>
<span><span class="co">## ---------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initial model:  Mclust (EEE,3)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cluster cores:</span></span>
<span><span class="co">##    1    2 &lt;NA&gt; </span></span>
<span><span class="co">##  166   91   15 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Final clustering:</span></span>
<span><span class="co">##   1   2 </span></span>
<span><span class="co">## 178  94</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Starting with the density estimate from the initial (<code>EEE</code>,3) Gaussian mixture model, <code><a href="https://mclust-org.github.io/mclust/reference/gmmhd.html">gmmhd()</a></code> computes the empirical mode function and the connected components at different density levels, which are then used to identify cluster cores. <a href="#fig-gmmhd_faithful-2" class="quarto-xref">Figure&nbsp;<span>7.11 (b)</span></a> plots the number of modes as a function of the proportion of data points above a threshold density level. There is a clear indication of a bimodal distribution. <a href="#fig-gmmhd_faithful-3" class="quarto-xref">Figure&nbsp;<span>7.11 (c)</span></a> shows the points assigned to the cluster cores, as well as the remaining data points not initially allocated.</p>
<p>The summary above shows that 166 and 91 observations have been assigned to the two cluster cores, and that 15 points were initially unlabeled. <a href="#fig-gmmhd_faithful-4" class="quarto-xref">Figure&nbsp;<span>7.11 (d)</span></a> shows the final clustering obtained after the unlabeled data have also been allocated to the cluster cores. <a href="#fig-gmmhd_faithful-2" class="quarto-xref">Figure&nbsp;<span>7.11 (b)</span></a>–<a href="#fig-gmmhd_faithful-4" class="quarto-xref">Figure&nbsp;<span>7.11 (d)</span></a> can be produced with the following commands:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">GMMHD</span>, what <span class="op">=</span> <span class="st">"mode"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">GMMHD</span>, what <span class="op">=</span> <span class="st">"cores"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">GMMHD</span>, what <span class="op">=</span> <span class="st">"clusters"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-gmmhd_faithful" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-gmmhd_faithful-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gmmhd_faithful" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-gmmhd_faithful-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-gmmhd_faithful-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-gmmhd_faithful-1.png" id="fig-gmmhd_faithful-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-gmmhd_faithful">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-gmmhd_faithful-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gmmhd_faithful" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-gmmhd_faithful-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-gmmhd_faithful-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-gmmhd_faithful-2.png" id="fig-gmmhd_faithful-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-gmmhd_faithful">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-gmmhd_faithful-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gmmhd_faithful" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-gmmhd_faithful-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-gmmhd_faithful-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-gmmhd_faithful-3.png" id="fig-gmmhd_faithful-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-gmmhd_faithful">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-gmmhd_faithful-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gmmhd_faithful" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-gmmhd_faithful-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-gmmhd_faithful-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-gmmhd_faithful-4.png" id="fig-gmmhd_faithful-4" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-gmmhd_faithful">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-gmmhd_faithful-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gmmhd_faithful-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.11: Identification of connected components for the Old Faithful data: (a) clustering and density contours for the initial GMM; (b) mode function; (c) cluster cores (marked as <span class="math inline">\(\bullet\)</span> and <span class="math inline">\(\square\)</span>) and unlabeled data (marked as <span class="math inline">\(\circ\)</span>); (d) final clustering obtained after unlabeled data have been allocated.
</figcaption></figure>
</div>
</div>
<div id="exm-sim_data" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.7</strong></span> &nbsp;&nbsp;<strong>Simulated data</strong> {.unnumbered #sec-sim_data}</p>
<p>We now compare the results of the GMMHD procedure with the component combination methods of <a href="#sec-clustcombi" class="quarto-xref"><span>Section 7.3.1</span></a> on the simulated dataset from that section.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Baudry_etal_2010_JCGS_examples"</span>, package <span class="op">=</span> <span class="st">"mclust"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">ex4.1</span><span class="op">)</span></span>
<span><span class="va">GMMHD</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/gmmhd.html">gmmhd</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">GMMHD</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------------</span></span>
<span><span class="co">## GMM with high-density connected components for clustering </span></span>
<span><span class="co">## ---------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initial model:  Mclust (EEV,6)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cluster cores:</span></span>
<span><span class="co">##    1    2    3    4 &lt;NA&gt; </span></span>
<span><span class="co">##  100  116  111  206   67 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Final clustering:</span></span>
<span><span class="co">##   1   2   3   4 </span></span>
<span><span class="co">## 118 133 122 227</span></span>
<span><span class="va">optimClust</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clustCombiOptim.html">clustCombiOptim</a></span><span class="op">(</span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clustCombi.html">clustCombi</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>, reg <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>GMMHD <span class="op">=</span> <span class="va">GMMHD</span><span class="op">$</span><span class="va">cluster</span>, CLUSTCOMBI <span class="op">=</span> <span class="va">optimClust</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">##      CLUSTCOMBI</span></span>
<span><span class="co">## GMMHD   1   2   3   4</span></span>
<span><span class="co">##     1 118   0   0   0</span></span>
<span><span class="co">##     2   0   0   1 132</span></span>
<span><span class="co">##     3   0 122   0   0</span></span>
<span><span class="co">##     4   0   0 227   0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The GMMHD procedure identifies essentially the same four clusters as <code><a href="https://mclust-org.github.io/mclust/reference/clustCombi.html">clustCombi()</a></code>, with the exception of a single point on the edge of the two clusters on the left of graphs in <a href="#fig-ex4-1_clustcombi" class="quarto-xref">Figure&nbsp;<span>7.8</span></a>.</p>
</div>
</section></section><section id="sec-sim" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="sec-sim">
<span class="header-section-number">7.4</span> Simulation from Mixture Densities</h2>
<p>Given the parameters of a mixture model, data can be simulated from that model for evaluation and verification. The <strong>mclust</strong> function <code><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim()</a></code> <!-- \index{mclust!\code{sim()}}  --> enables simulation from all of the structured GMMs supported. Besides the model, <code><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim()</a></code> allows a seed to be input for reproducibility.</p>
<div id="exm-sim_data_galaxies" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.8</strong></span> &nbsp;&nbsp;<strong>Simulating data from GMM estimated from the Old Faithful data</strong></p>
<p>In the example below we simulate two different datasets of the same size as the <code>faithful</code> dataset from the model returned by <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span><span class="va">sim0</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim</a></span><span class="op">(</span>modelName <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">modelName</span>, </span>
<span>            parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>            n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">sim1</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim</a></span><span class="op">(</span>modelName <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">modelName</span>, </span>
<span>            parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>            n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results can be plotted as follows (graphs not shown):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">xlim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">sim0</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">sim1</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ylim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">sim0</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, <span class="va">sim1</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclust2Dplot.html">mclust2Dplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim0</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>             classification <span class="op">=</span> <span class="va">sim0</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclust2Dplot.html">mclust2Dplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim1</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>             classification <span class="op">=</span> <span class="va">sim1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that <code><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim()</a></code> produces a dataset in which the first column is the true classification:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sim0</span><span class="op">)</span></span>
<span><span class="co">##      group     x1     x2</span></span>
<span><span class="co">## [1,]     1 4.1376 71.918</span></span>
<span><span class="co">## [2,]     3 4.4703 77.198</span></span>
<span><span class="co">## [3,]     3 4.5090 74.671</span></span>
<span><span class="co">## [4,]     2 1.9596 49.380</span></span>
<span><span class="co">## [5,]     1 4.0607 78.773</span></span>
<span><span class="co">## [6,]     3 4.3597 82.190</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="large-datasets" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="large-datasets">
<span class="header-section-number">7.5</span> Large Datasets</h2>
<p>Gaussian mixture modeling may in practice be too slow to be applied directly to datasets having a large number of observations or cases. In order to extend the method to larger datasets, both <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust()</a></code> and <code><a href="https://mclust-org.github.io/mclust/reference/mclustBIC.html">mclustBIC()</a></code> include a provision for using a subsample of the data in the initial hierarchical clustering phase before applying the EM algorithm to the full dataset. Other functions in the <strong>mclust</strong> package also have this feature. Some alternatives for handling large datasets are discussed by <span class="citation" data-cites="Wehrens:Buydens:Fraley:Raftery:2004">Wehrens et al. (<a href="99_references.html#ref-Wehrens:Buydens:Fraley:Raftery:2004" role="doc-biblioref">2004</a>)</span> and <span class="citation" data-cites="Fraley:Raftery:Wehrens:2005">C. Fraley, Raftery, and Wehrens (<a href="99_references.html#ref-Fraley:Raftery:Wehrens:2005" role="doc-biblioref">2005</a>)</span>.</p>
<p>Starting with version 5.4 of <strong>mclust</strong>, a subsample of size specified by <code>mclust.options("subset")</code> is used in the initial hierarchical clustering phase. The default subset size is 2000. The subsampling can be removed by the command <code>mclust.options(subset = Inf)</code>. The subset size can be specified for all the models in the current session through the <code>subset</code> <!-- \index{mclust!\code{subset}} --> argument to <code><a href="https://mclust-org.github.io/mclust/reference/mclust.options.html">mclust.options()</a></code>. Furthermore, the subsampling approach can also be implemented in the <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust()</a></code> function by setting <code>initialization = list(subset = s)</code>, where <code>s</code> is a vector of logical values or numerical indices specifying the subset of data to be used in the initial hierarchical clustering phase.</p>
<div id="exm-dens_sim_large_data" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.9</strong></span> &nbsp;&nbsp;<strong>Clustering on a simulated large dataset</strong></p>
<p>Consider a simulated dataset of <span class="math inline">\(n=10 000\)</span> points from a three-component Gaussian mixture with common covariance matrix. First, we create a list, <code>par</code>, of the model parameters to be used in the simulation:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">par</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  pro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="op">-</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  variance <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/sigma2decomp.html">sigma2decomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">1.5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>                          G <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span></span>
<span><span class="co">## List of 3</span></span>
<span><span class="co">## $ pro : num [1:3] 0.5 0.3 0.2</span></span>
<span><span class="co">## $ mean : num [1:2, 1:3] 0 0 3 3 -4 1</span></span>
<span><span class="co">## $ variance:List of 7</span></span>
<span><span class="co">## ..$ sigma : num [1:2, 1:2, 1:3] 1 0.6 0.6 1.5 1 0.6 0.6 1.5 1 0.6 ...</span></span>
<span><span class="co">## ..$ d : int 2</span></span>
<span><span class="co">## ..$ modelName : chr "EEI"</span></span>
<span><span class="co">## ..$ G : num 3</span></span>
<span><span class="co">## ..$ scale : num 1.07</span></span>
<span><span class="co">## ..$ shape : num [1:2] 1.78 0.562</span></span>
<span><span class="co">## ..$ orientation: num [1:2, 1:2] 0.555 0.832 -0.832 0.555</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then simulate the data with the <code><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim()</a></code> function as described in <a href="#sec-sim" class="quarto-xref"><span>Section 7.4</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/sim.html">sim</a></span><span class="op">(</span>modelName <span class="op">=</span> <span class="st">"EEI"</span>, parameters <span class="op">=</span> <span class="va">par</span>, n <span class="op">=</span> <span class="fl">10000</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">cluster</span> <span class="op">=</span> <span class="va">sim</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="va">sim</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following code is used to fit GMMs with no subsampling, using the default subsampling, and a random sample of 1000 observations provided to the <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust()</a></code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclust.options.html">mclust.options</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>  <span class="co"># no subsetting</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span>mod1 <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">## 172.981   0.936 173.866</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##              EEI,3         EEE,3        EVI,3</span></span>
<span><span class="co">## BIC      -76523.89 -76531.836803 -76541.59835</span></span>
<span><span class="co">## BIC diff      0.00     -7.948006    -17.70955</span></span>
<span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/mclust.options.html">mclust.options</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>  <span class="co"># reset to default setting</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span>mod2 <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##  user  system elapsed </span></span>
<span><span class="co">## 14.247   0.196  14.395 </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##              EEI,3         EEE,3        EVI,3</span></span>
<span><span class="co">## BIC      -76524.09 -76531.845624 -76541.89691</span></span>
<span><span class="co">## BIC diff      0.00     -7.754063    -17.80535</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>  <span class="co"># one-time subsetting</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span>mod3 <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">x</span>, initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="va">s</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##   user  system elapsed </span></span>
<span><span class="co">## 12.091   0.146  12.197 </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">## Best BIC values:</span></span>
<span><span class="co">##              EEI,3         EEE,3        VEI,3</span></span>
<span><span class="co">## BIC      -76524.17 -76532.043460 -76541.78983</span></span>
<span><span class="co">## BIC diff      0.00     -7.874412    -17.62078</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Function <code><a href="https://rdrr.io/r/base/system.time.html">system.time()</a></code> gives a rough indication of the computational effort associated without and with subsampling. In the latter case, using a random sample of 20% of the full set of observations, we have been able to obtain a <span class="math inline">\(10\)</span> fold speedup, ending up with essentially the same final clustering model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">classification</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##       1    2    3</span></span>
<span><span class="co">##  1 5090    0    0</span></span>
<span><span class="co">##  2    0    0 3007</span></span>
<span><span class="co">##  3   10 1893    0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The same strategies that we have described for clustering very large datasets can also be used for classification. First, discriminant analysis with <code><a href="https://mclust-org.github.io/mclust/reference/MclustDA.html">MclustDA()</a></code> can be performed on a subset of the data. Then, the remaining data points can be classified (in reasonable sized blocks) using the associated <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> method.</p>
</section><section id="high-dimensional-data" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="high-dimensional-data">
<span class="header-section-number">7.6</span> High-Dimensional Data</h2>
<p>Models in which the orientation is allowed to vary between components (<code>EEV</code>, <code>VEV</code>, <code>EVV</code>, and <code>VVV</code>), have <span class="math inline">\({\cal O}(d^2)\)</span> parameters per cluster, where <span class="math inline">\(d\)</span> is the dimension of the data (see <a href="02_mixture.html#tbl-models_df" class="quarto-xref">Table&nbsp;<span>2.2</span></a> and <a href="02_mixture.html#fig-nMclustParams" class="quarto-xref">Figure&nbsp;<span>2.3</span></a>). For this reason, <strong>mclust</strong> may not work well or may otherwise be inefficient for these models when applied to high-dimensional data. It may still be possible to analyze such data with <strong>mclust</strong> by restricting to models with fewer parameters (spherical or diagonal models) or else by applying a dimension-reduction technique such as principal components analysis. Moreover, some of the more parsimonious models (spherical, diagonal, or fixed covariance) can be applied to datasets in which the number of observations is less than the data dimension.</p>
</section><section id="missing-data" class="level2" data-number="7.7"><h2 data-number="7.7" class="anchored" data-anchor-id="missing-data">
<span class="header-section-number">7.7</span> Missing Data</h2>
<p>At present, <strong>mclust</strong> has no direct provision for handling missing values in data. However, a function <code><a href="https://mclust-org.github.io/mclust/reference/imputeData.html">imputeData()</a></code> <!-- \index{mclust!\code{imputeData()}}  --> for creating datasets with missing data imputations using the <strong>mix</strong> R package <span class="citation" data-cites="Rpkg:mix">(<a href="99_references.html#ref-Rpkg:mix" role="doc-biblioref">Joseph L. Schafer 2022</a>)</span> has been added to the <strong>mclust</strong> package.</p>
<p>The algorithm used in <code><a href="https://mclust-org.github.io/mclust/reference/imputeData.html">imputeData()</a></code> starts with a preliminary maximum likelihood estimation step to obtain model parameters for the subset of complete observations in the data. These are used as initial values for a data augmentation step for generating posterior draws of parameters via Markov Chain Monte Carlo. Finally, missing values are imputed with simulated values drawn from the predictive distribution of the missing data given the observed data and the simulated parameters.</p>
<div id="exm-imp_child_devel" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.10</strong></span> &nbsp;&nbsp;<strong>Imputation on the child development data</strong></p>
<p>The <code>stlouis</code> dataset, available in the <strong>mix</strong> package, provides data from an observational study to assess the affects of parental psychological disorders on child development. Here we use <code><a href="https://mclust-org.github.io/mclust/reference/imputeData.html">imputeData()</a></code> to fill in missing values in the continuous portion of the <code>stlouis</code> dataset; we remove the first 3 categorical variables, because <strong>mclust</strong> is intended for continuous variables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"stlouis"</span>, package <span class="op">=</span> <span class="st">"mix"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">stlouis</span><span class="op">[</span>, <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>, row.names <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##    42    27</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##            R1      V1      R2      V2</span></span>
<span><span class="co">## FALSE 0.30435 0.43478 0.23188 0.24638</span></span>
<span><span class="co">## TRUE  0.69565 0.56522 0.76812 0.75362</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The dataset contains only 27 complete cases out of 69 observations (39%). For each variable, the percentage of missing values ranges from 23% to 43%. The pattern of missing values can be displayed graphically using the following code (see <a href="#fig-stlouis_missing" class="quarto-xref">Figure&nbsp;<span>7.12</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">var</span>, y <span class="op">=</span> <span class="va">obs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">missing</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightgrey"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Variables"</span>, y <span class="op">=</span> <span class="st">"Observations"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-stlouis_missing" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-stlouis_missing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-stlouis_missing-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stlouis_missing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.12: Image plot of the missing values pattern for the <code>stlouis</code> dataset.
</figcaption></figure>
</div>
</div>
</div>
<p>A single imputation of simulated values drawn from the predictive distribution of the missing data is easily obtained as</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ximp</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/imputeData.html">imputeData</a></span><span class="op">(</span><span class="va">x</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the values obtained for the missing entries will vary depending on the random number seed set as argument in the <code><a href="https://mclust-org.github.io/mclust/reference/imputeData.html">imputeData()</a></code> function call. By default, a randomly chosen seed is used.</p>
<p>Missing data imputations can be visualized with the function <code><a href="https://mclust-org.github.io/mclust/reference/imputePairs.html">imputePairs()</a></code> <!-- \index{mclust!\code{imputePairs()}}  --> as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/imputePairs.html">imputePairs</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">ximp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-stlouis_imputePairs" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-stlouis_imputePairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-stlouis_imputePairs-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stlouis_imputePairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.13: Pairs plot showing an instance of applying <code><a href="https://mclust-org.github.io/mclust/reference/imputeData.html">imputeData()</a></code> to the continuous variables in the <code>stlouis</code> dataset. The open black circles correspond to non-missing data, while the filled red circles correspond to imputed missing values.
</figcaption></figure>
</div>
</div>
</div>
<p>The corresponding pairs plot is shown in <a href="#fig-stlouis_imputePairs" class="quarto-xref">Figure&nbsp;<span>7.13</span></a>.</p>
</div>
<p>It is usually desirable to combine multiple imputations in analyses involving missing data. See <span class="citation" data-cites="Schafer:1997">Joseph L. Schafer (<a href="99_references.html#ref-Schafer:1997" role="doc-biblioref">1997</a>)</span>, <span class="citation" data-cites="Little:Rubin:2002">Little and Rubin (<a href="99_references.html#ref-Little:Rubin:2002" role="doc-biblioref">2002</a>)</span>, and <span class="citation" data-cites="vanBuuren:2011">van Buuren and Groothuis-Oudshoorn (<a href="99_references.html#ref-vanBuuren:2011" role="doc-biblioref">2011</a>)</span> for details and references on multiple imputation. Besides <strong>mix</strong>, R packages for handling missing data include <strong>Amelia</strong> <span class="citation" data-cites="Honaker:etal:2011">(<a href="99_references.html#ref-Honaker:etal:2011" role="doc-biblioref">Honaker, King, and Blackwell 2011</a>)</span> and <strong>mice</strong> <span class="citation" data-cites="vanBuuren:2012">(<a href="99_references.html#ref-vanBuuren:2012" role="doc-biblioref">van Buuren 2012</a>)</span>.</p>
<div id="exm-imp_cluster_iris" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.11</strong></span> &nbsp;&nbsp;<strong>Clustering with missing values on the Iris data</strong></p>
<p>We now illustrate a model-based clustering analysis in the presence of missing values. Consider the <code>iris</code> data, and suppose that we want to fit a three-component model with common full covariance matrix. The model using the full set of observations is obtained as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">x</span>, G <span class="op">=</span> <span class="fl">3</span>, modelNames <span class="op">=</span> <span class="st">"EEE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##             </span></span>
<span><span class="co">##               1  2  3</span></span>
<span><span class="co">##   setosa     50  0  0</span></span>
<span><span class="co">##   versicolor  0 48  2</span></span>
<span><span class="co">##   virginica   0  1 49</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.94101</span></span>
<span><span class="va">mod</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">mean</span>  <span class="co"># component means</span></span>
<span><span class="co">##               [,1]   [,2]   [,3]</span></span>
<span><span class="co">## Sepal.Length 5.006 5.9426 6.5749</span></span>
<span><span class="co">## Sepal.Width  3.428 2.7607 2.9811</span></span>
<span><span class="co">## Petal.Length 1.462 4.2596 5.5394</span></span>
<span><span class="co">## Petal.Width  0.246 1.3194 2.0254</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we assume that the interest is in the final clustering partition and in the corresponding component means. Other mixture parameters, such as mixing probabilities and (co)variances, can be dealt with analogously.</p>
<p>Now, let us randomly designate 10% of the data values as missing:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">isMissing</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                    replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">isMissing</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>cmpObs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## cmpObs</span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##    50   100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The last command shows that 100 out of 150 observations have no missing values. We can use multiple imputation to create <code>nImp</code> complete datasets by replacing the missing values with plausible data values. Then, an (EEE,3) clustering model is fitted to each of these datasets, and the results are pooled to get the final estimates.</p>
<p>A couple of issues should be mentioned. First, a well-known issue of finite mixture modeling is nonidentifiability of the components due to invariance to relabeling. This is solved in the code below using <code><a href="https://mclust-org.github.io/mclust/reference/imputeData.html">matchCluster()</a></code>, which takes the first clustering result as a template for adjusting the labeling of the successive clusters. The adjusted ordering is also used for matching the other estimated parameters.</p>
<p>A second issue is related to how pooling of results is carried out at the end of the imputation procedure. For the clustering labels, the majority vote rule is used as implemented in function <code><a href="https://mclust-org.github.io/mclust/reference/majorityVote.html">majorityVote()</a></code>, whereas a simple average of estimates is calculated for pooling results for the mean parameters.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nImp</span>  <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">muImp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">3</span>, <span class="va">nImp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">clImp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">nImp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nImp</span><span class="op">)</span></span>
<span><span class="op">{</span> </span>
<span>  <span class="va">xImp</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/imputeData.html">imputeData</a></span><span class="op">(</span><span class="va">x</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">modImp</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">xImp</span>, G <span class="op">=</span> <span class="fl">3</span>, modelNames <span class="op">=</span> <span class="st">"EEE"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">clImp</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">modImp</span><span class="op">$</span><span class="va">classification</span></span>
<span>  <span class="va">mcl</span> <span class="op">=</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/imputeData.html">matchCluster</a></span><span class="op">(</span><span class="va">clImp</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">modImp</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span>  <span class="va">clImp</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span>  <span class="op">=</span> <span class="va">mcl</span><span class="op">$</span><span class="va">cluster</span></span>
<span>  <span class="va">muImp</span><span class="op">[</span>, , <span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">modImp</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span>, <span class="va">mcl</span><span class="op">$</span><span class="va">ord</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># majority rule</span></span>
<span><span class="va">cl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">clImp</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/majorityVote.html">majorityVote</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">majority</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="va">cl</span><span class="op">)</span></span>
<span><span class="co">##             cl</span></span>
<span><span class="co">##               1  2  3</span></span>
<span><span class="co">##   setosa     50  0  0</span></span>
<span><span class="co">##   versicolor  0 49  1</span></span>
<span><span class="co">##   virginica   0  5 45</span></span>
<span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="va">cl</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.88579</span></span>
<span></span>
<span><span class="co"># pooled estimate of cluster means</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">muImp</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">##         [,1]   [,2]   [,3]</span></span>
<span><span class="co">## [1,] 4.99885 5.9388 6.5667</span></span>
<span><span class="co">## [2,] 3.44614 2.7684 2.9675</span></span>
<span><span class="co">## [3,] 1.48357 4.2783 5.5453</span></span>
<span><span class="co">## [4,] 0.25557 1.3333 2.0267</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is interesting to note that both the final clustering obtained by majority vote and cluster means obtained by pooling results from imputed datasets are quite close to those obtained on the original dataset.</p>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Allard:Fraley:1997" class="csl-entry" role="listitem">
Allard, Denis, and Chris Fraley. 1997. <span>“Nonparametric Maximum Likelihood Estimation of Features in Spatial Point Processes Using <span>V</span>orono<span>ı̈</span> Tessellation.”</span> <em>Journal of the American Statistical Association</em> 92 (440): 1485–93.
</div>
<div id="ref-Azzalini:Menardi:2014" class="csl-entry" role="listitem">
Azzalini, Adelchi, and Giovanna Menardi. 2014. <span>“Clustering via Nonparametric Density Estimation: The <span>R</span> Package <span class="nocase">pdfCluster</span>.”</span> <em>Journal of Statistical Software</em> 57 (11): 1–26. <a href="http://www.jstatsoft.org/v57/i11/">http://www.jstatsoft.org/v57/i11/</a>.
</div>
<div id="ref-Banfield:Raftery:1993" class="csl-entry" role="listitem">
Banfield, J., and Adrian E. Raftery. 1993. <span>“Model-Based <span>G</span>aussian and Non-<span>G</span>aussian Clustering.”</span> <em>Biometrics</em> 49: 803–21.
</div>
<div id="ref-Baudry:etal:2010" class="csl-entry" role="listitem">
Baudry, J. P., A. E. Raftery, G. Celeux, K. Lo, and R. Gottardo. 2010. <span>“Combining Mixture Components for Clustering.”</span> <em>Journal of Computational and Graphical Statistics</em> 19 (2): 332–53.
</div>
<div id="ref-Byers:Raftery:1998" class="csl-entry" role="listitem">
Byers, Simon, and Adrian E Raftery. 1998. <span>“Nearest-Neighbor Clutter Removal for Estimating Features in Spatial Point Processes.”</span> <em>Journal of the American Statistical Association</em> 93 (442): 577–84.
</div>
<div id="ref-Campbell:etal:1997" class="csl-entry" role="listitem">
Campbell, JG, Chris Fraley, Fionn Murtagh, and Adrian E Raftery. 1997. <span>“Linear Flaw Detection in Woven Textiles Using Model-Based Clustering.”</span> <em>Pattern Recognition Letters</em> 18 (14): 1539–48.
</div>
<div id="ref-Campbell:etal:1999" class="csl-entry" role="listitem">
Campbell, Jonathan G, Chris Fraley, D Stanford, Fionn Murtagh, and Adrian E Raftery. 1999. <span>“Model-Based Methods for Textile Fault Detection.”</span> <em>International Journal of Imaging Systems and Technology</em> 10 (4): 339–46.
</div>
<div id="ref-Coretto:Hennig:2016" class="csl-entry" role="listitem">
Coretto, Pietro, and Christian Hennig. 2016. <span>“Robust Improper Maximum Likelihood: <span>T</span>uning, Computation, and a Comparison with Other Methods for Robust <span>G</span>aussian Clustering.”</span> <em>Journal of the American Statistical Association</em> 111 (516): 1648–59.
</div>
<div id="ref-Dasgupta:Raftery:1998" class="csl-entry" role="listitem">
Dasgupta, Abhijit, and Adrian E Raftery. 1998. <span>“Detecting Features in Spatial Point Processes with Clutter via Model-Based Clustering.”</span> <em>Journal of the American Statistical Association</em> 93 (441): 294–302.
</div>
<div id="ref-Dotto:Farcomeni:2019" class="csl-entry" role="listitem">
Dotto, Francesco, and Alessio Farcomeni. 2019. <span>“Robust Inference for Parsimonious Model-Based Clustering.”</span> <em>Journal of Statistical Computation and Simulation</em> 89 (3): 414–42.
</div>
<div id="ref-Fraley:Raftery:2007a" class="csl-entry" role="listitem">
Fraley, Chris, and Adrian E Raftery. 2007. <span>“Bayesian Regularization for Normal Mixture Estimation and Model-Based Clustering.”</span> <em>Journal of Classification</em> 24 (2): 155–81.
</div>
<div id="ref-Fraley:Raftery:1998" class="csl-entry" role="listitem">
Fraley, C., and A. E. Raftery. 1998. <span>“How Many Clusters? <span>W</span>hich Clustering Method? <span>A</span>nswers via Model-Based Cluster Analysis.”</span> <em>The Computer Journal</em> 41: 578–88.
</div>
<div id="ref-Fraley:Raftery:Wehrens:2005" class="csl-entry" role="listitem">
Fraley, C., A. E. Raftery, and R. Wehrens. 2005. <span>“Incremental Model-Based Clustering for Large Datasets with Small Clusters.”</span> <em>Journal of Computational and Graphical Statistics</em> 14 (3): 529–46.
</div>
<div id="ref-GarciaEscudero:etal:2008" class="csl-entry" role="listitem">
Garcı́a-Escudero, Luis A., Alfonso Gordaliza, Carlos Matràn, and Agustin Mayo-Iscar. 2008. <span>“A General Trimming Approach to Robust Cluster Analysis.”</span> <em>Annals of Statistics</em> 36 (3): 1324–45.
</div>
<div id="ref-Rpkg:geometry" class="csl-entry" role="listitem">
Habel, Kai, Raoul Grasman, Robert B. Gramacy, Pavlo Mozharovskyi, and David C. Sterratt. 2022. <em><span class="nocase">geometry</span>: Mesh Generation and Surface Tessellation</em>. <a href="https://CRAN.R-project.org/package=geometry">https://CRAN.R-project.org/package=geometry</a>.
</div>
<div id="ref-Hartigan:1975" class="csl-entry" role="listitem">
Hartigan, J. A. 1975. <em>Clustering Algorithms</em>. New York: John Wiley &amp; Sons.
</div>
<div id="ref-Hennig:2010" class="csl-entry" role="listitem">
Hennig, Christian. 2010. <span>“Methods for Merging <span>G</span>aussian Mixture Components.”</span> <em>Advances in Data Analysis and Classification</em> 4 (1): 3–34.
</div>
<div id="ref-Rpkg:prabclus" class="csl-entry" role="listitem">
Hennig, Christian, and Bernhard Hausdorf. 2020. <em>Prabclus: Functions for Clustering and Testing of Presence-Absence, Abundance and Multilocus Genetic Data</em>. <a href="https://CRAN.R-project.org/package=prabclus">https://CRAN.R-project.org/package=prabclus</a>.
</div>
<div id="ref-Honaker:etal:2011" class="csl-entry" role="listitem">
Honaker, James, Gary King, and Matthew Blackwell. 2011. <span>“<span>Amelia II</span>: A Program for Missing Data.”</span> <em>Journal of Statistical Software</em> 45 (7): 1–47. <a href="http://www.jstatsoft.org/v45/i07/">http://www.jstatsoft.org/v45/i07/</a>.
</div>
<div id="ref-Little:Rubin:2002" class="csl-entry" role="listitem">
Little, Roderick JA, and Donald B Rubin. 2002. <em>Statistical Analysis with Missing Data</em>. 2nd ed. John Wiley &amp; Sons.
</div>
<div id="ref-Rpkg:cluster" class="csl-entry" role="listitem">
Maechler, Martin, Peter Rousseeuw, Anja Struyf, Mia Hubert, and Kurt Hornik. 2022. <em><span class="nocase">cluster</span>: Cluster Analysis Basics and Extensions</em>. <a href="https://CRAN.R-project.org/package=cluster">https://CRAN.R-project.org/package=cluster</a>.
</div>
<div id="ref-McLachlan:Peel:2000" class="csl-entry" role="listitem">
McLachlan, G. J., and D. Peel. 2000. <em>Finite Mixture Models</em>. New York: Wiley.
</div>
<div id="ref-Rpkg:pdfCluster" class="csl-entry" role="listitem">
Menardi, Giovanna, and Adelchi Azzalini. 2022. <em><span class="nocase">pdfCluster</span>: Cluster Analysis via Nonparametric Density Estimation</em>. <a href="https://CRAN.R-project.org/package=pdfCluster">https://CRAN.R-project.org/package=pdfCluster</a>.
</div>
<div id="ref-Peel:McLachlan:2000" class="csl-entry" role="listitem">
Peel, David, and Geoffrey J McLachlan. 2000. <span>“Robust Mixture Modelling Using the <span class="math inline">\(t\)</span> Distribution.”</span> <em>Statistics and Computing</em> 10 (4): 339–48.
</div>
<div id="ref-Punzo:McNicholas:2016" class="csl-entry" role="listitem">
Punzo, Antonio, and Paul D. McNicholas. 2016. <span>“Parsimonious Mixtures of Multivariate Contaminated Normal Distributions.”</span> <em>Biometrical Journal</em> 58 (6): 1506–37. <a href="https://doi.org/10.1002/bimj.201500144">https://doi.org/10.1002/bimj.201500144</a>.
</div>
<div id="ref-Rpkg:MASS" class="csl-entry" role="listitem">
Ripley, Brian. 2022. <em><span>MASS</span>: Support Functions and Datasets for Venables and Ripley’s MASS</em>. <a href="https://CRAN.R-project.org/package=MASS">https://CRAN.R-project.org/package=MASS</a>.
</div>
<div id="ref-Roeder:1990" class="csl-entry" role="listitem">
Roeder, Kathryn. 1990. <span>“Density Estimation with Confidence Sets Exemplified by Superclusters and Voids in the Galaxies.”</span> <em>Journal of the American Statistical Association</em> 85 (411): 617–24.
</div>
<div id="ref-Roeder:Wasserman:1997" class="csl-entry" role="listitem">
Roeder, K., and L. Wasserman. 1997. <span>“Practical <span>B</span>ayesian Density Estimation Using Mixtures of Normals.”</span> <em>Journal of the American Statistical Association</em> 92 (439): 894–902.
</div>
<div id="ref-Schafer:1997" class="csl-entry" role="listitem">
Schafer, Joseph L. 1997. <em>Analysis of Incomplete Multivariate Data</em>. London: Chapman &amp; Hall/CRC.
</div>
<div id="ref-Rpkg:mix" class="csl-entry" role="listitem">
Schafer, Joseph L. 2022. <em><span class="nocase">mix</span>: Estimation/Multiple Imputation for Mixed Categorical and Continuous Data</em>. <a href="https://CRAN.R-project.org/package=mix">https://CRAN.R-project.org/package=mix</a>.
</div>
<div id="ref-Scrucca:2016" class="csl-entry" role="listitem">
Scrucca, Luca. 2016. <span>“Identifying Connected Components in <span>G</span>aussian Finite Mixture Models for Clustering.”</span> <em>Computational Statistics &amp; Data Analysis</em> 93: 5–17. <a href="https://doi.org/10.1016/j.csda.2015.01.006">https://doi.org/10.1016/j.csda.2015.01.006</a>.
</div>
<div id="ref-vanBuuren:2012" class="csl-entry" role="listitem">
van Buuren, Stef. 2012. <em>Flexible Imputation of Missing Data</em>. Chapman &amp; Hall/CRC.
</div>
<div id="ref-vanBuuren:2011" class="csl-entry" role="listitem">
van Buuren, Stef, and Karin Groothuis-Oudshoorn. 2011. <span>“<span class="nocase">mice</span>: Multivariate Imputation by Chained Equations in r.”</span> <em>Journal of Statistical Software</em> 45 (3): 1–67. <a href="http://www.jstatsoft.org/v45/i03/">http://www.jstatsoft.org/v45/i03/</a>.
</div>
<div id="ref-Venables:Ripley:2013" class="csl-entry" role="listitem">
Venables, William N., and Brian D. Ripley. 2013. <em>Modern Applied Statistics with <span>S-PLUS</span></em>. Springer Science; Business Media.
</div>
<div id="ref-Wang:Raftery:2002" class="csl-entry" role="listitem">
Wang, Naisyin, and Adrian E Raftery. 2002. <span>“Nearest Neighbor Variance Estimation <span>(NNVE)</span>: Robust Covariance Estimation via Nearest Neighbor Cleaning (with Discussion).”</span> <em>Journal of the American Statistical Association</em> 97 (460): 994–1019.
</div>
<div id="ref-Rpkg:covRobust" class="csl-entry" role="listitem">
Wang, Naisyin, Adrian Raftery, and Chris Fraley. 2017. <em><span class="nocase">covRobust</span>: Robust Covariance Estimation via Nearest Neighbor Cleaning</em>. <a href="https://CRAN.R-project.org/package=covRobust">https://CRAN.R-project.org/package=covRobust</a>.
</div>
<div id="ref-Wehrens:Buydens:Fraley:Raftery:2004" class="csl-entry" role="listitem">
Wehrens, R., L. M. C. Buydens, C. Fraley, and A. E. Raftery. 2004. <span>“Model-Based Clustering for Image Segmentation and Large Datasets via Sampling.”</span> <em>Journal of Classification</em> 21 (2): 231–53.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/06_graphics.html" class="pagination-link" aria-label="Visualizing Gaussian Mixture Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Visualizing Gaussian Mixture Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/99_references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Model-Based Clustering, Classification, and <br> Density Estimation Using mclust in R</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>