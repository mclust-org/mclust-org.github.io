<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>6&nbsp; Visualizing Gaussian Mixture Models – Model-Based Clustering, Classification, and Density Estimation 
Using mclust in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/07_miscellanea.html" rel="next">
<link href="../chapters/05_dens.html" rel="prev">
<link href="../images/cover.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/06_graphics.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Visualizing Gaussian Mixture Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Model-Based Clustering, Classification, and Density Estimation Using mclust in R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/00_preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Finite Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03_cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model-Based Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mixture-Based Classification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05_dens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model-Based Density Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06_graphics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Visualizing Gaussian Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07_miscellanea.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Miscellanea</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/99_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-display1" id="toc-sec-display1" class="nav-link active" data-scroll-target="#sec-display1"><span class="header-section-number">6.1</span> Displays for Univariate Data</a></li>
  <li><a href="#sec-display2" id="toc-sec-display2" class="nav-link" data-scroll-target="#sec-display2"><span class="header-section-number">6.2</span> Displays for Bivariate Data</a></li>
  <li>
<a href="#sec-displayhd" id="toc-sec-displayhd" class="nav-link" data-scroll-target="#sec-displayhd"><span class="header-section-number">6.3</span> Displays for Higher Dimensional Data</a>
  <ul class="collapse">
<li><a href="#coordinate-projections" id="toc-coordinate-projections" class="nav-link" data-scroll-target="#coordinate-projections"><span class="header-section-number">6.3.1</span> Coordinate Projections</a></li>
  <li><a href="#random-projections" id="toc-random-projections" class="nav-link" data-scroll-target="#random-projections"><span class="header-section-number">6.3.2</span> Random Projections</a></li>
  <li><a href="#sec-crimcoords" id="toc-sec-crimcoords" class="nav-link" data-scroll-target="#sec-crimcoords"><span class="header-section-number">6.3.3</span> Discriminant Coordinate Projections</a></li>
  </ul>
</li>
  <li>
<a href="#sec-displaydr" id="toc-sec-displaydr" class="nav-link" data-scroll-target="#sec-displaydr"><span class="header-section-number">6.4</span> Visualizing Model-Based Clustering and Classification on Projection Subspaces</a>
  <ul class="collapse">
<li><a href="#sec-clustsep" id="toc-sec-clustsep" class="nav-link" data-scroll-target="#sec-clustsep"><span class="header-section-number">6.4.1</span> Projection Subspaces for Visualizing Cluster Separation</a></li>
  <li><a href="#sec-varcov" id="toc-sec-varcov" class="nav-link" data-scroll-target="#sec-varcov"><span class="header-section-number">6.4.2</span> Incorporating Variation in Covariances</a></li>
  <li><a href="#sec-classifdr" id="toc-sec-classifdr" class="nav-link" data-scroll-target="#sec-classifdr"><span class="header-section-number">6.4.3</span> Projection Subspaces for Classification</a></li>
  <li><a href="#relationship-to-other-methods" id="toc-relationship-to-other-methods" class="nav-link" data-scroll-target="#relationship-to-other-methods"><span class="header-section-number">6.4.4</span> Relationship to Other Methods</a></li>
  </ul>
</li>
  <li><a href="#using-ggplot2-with-mclust" id="toc-using-ggplot2-with-mclust" class="nav-link" data-scroll-target="#using-ggplot2-with-mclust"><span class="header-section-number">6.5</span> Using ggplot2 with mclust</a></li>
  <li><a href="#sec-colorblind" id="toc-sec-colorblind" class="nav-link" data-scroll-target="#sec-colorblind"><span class="header-section-number">6.6</span> Using Color-Blind-Friendly Palettes</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-graphics" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Visualizing Gaussian Mixture Models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="hidden">
<p><span class="math display">\[
\DeclareMathOperator{\Real}{\mathbb{R}}
\DeclareMathOperator{\Proj}{\text{P}}
\DeclareMathOperator{\Exp}{\text{E}}
\DeclareMathOperator{\Var}{\text{Var}}
\DeclareMathOperator{\var}{\text{var}}
\DeclareMathOperator{\sd}{\text{sd}}
\DeclareMathOperator{\cov}{\text{cov}}
\DeclareMathOperator{\cor}{\text{cor}}
\DeclareMathOperator{\range}{\text{range}}
\DeclareMathOperator{\rank}{\text{rank}}
\DeclareMathOperator{\ind}{\perp\hspace*{-1.1ex}\perp}
\DeclareMathOperator{\CE}{\text{CE}}
\DeclareMathOperator{\BS}{\text{BS}}
\DeclareMathOperator{\ECM}{\text{ECM}}
\DeclareMathOperator{\BSS}{\text{BSS}}
\DeclareMathOperator{\WSS}{\text{WSS}}
\DeclareMathOperator{\TSS}{\text{TSS}}
\DeclareMathOperator{\BIC}{\text{BIC}}
\DeclareMathOperator{\ICL}{\text{ICL}}
\DeclareMathOperator{\CV}{\text{CV}}
\DeclareMathOperator{\diag}{\text{diag}}
\DeclareMathOperator{\se}{\text{se}}
\DeclareMathOperator{\Cov}{\text{Cov}}
\DeclareMathOperator{\boot}{\text{boot}}
\DeclareMathOperator{\LRTS}{\text{LRTS}}
\DeclareMathOperator{\Model}{\mathcal{M}}
\DeclareMathOperator*{\argmin}{arg\min}
\DeclareMathOperator*{\argmax}{arg\max}
\DeclareMathOperator{\vech}{vech}
\DeclareMathOperator{\tr}{tr}
\]</span></p>
<!-- \definecolor{quarto-callout-note-color}{HTML}{4477AA} -->
</div>
<p>Graphical displays are used extensively in previous chapters for showing clustering, classification, and density estimation. This chapter further discusses visualization methods for model-based clustering by illustrating fine tuning of plots available in <strong>mclust</strong>. In high-dimensional settings, in addition to marginal projections, several methods are presented for visualizing the clustering or classification structure on a subspace of reduced dimension.</p>
<section id="sec-display1" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="sec-display1">
<span class="header-section-number">6.1</span> Displays for Univariate Data</h2>
<p><strong>mclust</strong> models of univariate data can be visualized with <code>mclust1Dplot()</code>. <!-- \index{mclust!\code{mclust1Dplot()}} --></p>
<div id="exm-fish_add_graphs" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.1</strong></span> &nbsp;&nbsp;<strong>Additional graphs for the fish length data</strong></p>
<p>Consider the dataset introduced in <a href="02_mixture.html#exm-fishlength" class="quarto-xref">Example&nbsp;<span>2.1</span></a> on the length (in inches) of 256 snapper fish. The following code fits a four-component varying-variance (<code>"V"</code>) GMM to this data with <code>Mclust()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Snapper"</span>, package <span class="op">=</span> <span class="st">"FSAdata"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="va">Snapper</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">x</span>, G <span class="op">=</span> <span class="fl">4</span>, modelNames <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span>, parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust V (univariate, unequal variance) model with 4 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC   ICL</span></span>
<span><span class="co">##         -489.28 256 11 -1039.6 -1098</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##   1   2   3   4 </span></span>
<span><span class="co">##  26 143  56  31 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixing probabilities:</span></span>
<span><span class="co">##        1        2        3        4 </span></span>
<span><span class="co">## 0.098263 0.542607 0.177391 0.181739 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Means:</span></span>
<span><span class="co">##      1      2      3      4 </span></span>
<span><span class="co">## 3.3631 5.4042 7.5761 8.9021 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variances:</span></span>
<span><span class="co">##        1        2        3        4 </span></span>
<span><span class="co">## 0.073383 0.408370 0.197323 2.839843</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Classification and uncertainty plots for this model can be produced with the following code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mclust1Dplot</span><span class="op">(</span><span class="va">x</span>, what <span class="op">=</span> <span class="st">"classification"</span>, </span>
<span>             parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>, z <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">z</span>,</span>
<span>             xlab <span class="op">=</span> <span class="st">"Fish length"</span><span class="op">)</span></span>
<span><span class="fu">mclust1Dplot</span><span class="op">(</span><span class="va">x</span>, what <span class="op">=</span> <span class="st">"uncertainty"</span>,</span>
<span>             parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>, z <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">z</span>,</span>
<span>             xlab <span class="op">=</span> <span class="st">"Fish length"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-fishery2" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-fishery2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fishery2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-fishery2-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-fishery2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-fishery2-1.png" id="fig-fishery2-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-fishery2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fishery2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fishery2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-fishery2-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-fishery2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-fishery2-2.png" id="fig-fishery2-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-fishery2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fishery2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fishery2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: Classification (a) and uncertainty (b) plots created with<code>mclust1Dplot()</code> for the GMM fit to the fishery data.
</figcaption></figure>
</div>
<p>The resulting plots are shown in <a href="#fig-fishery2" class="quarto-xref">Figure&nbsp;<span>6.1</span></a>. Classification errors and density for <code>Mclust()</code> models can also be displayed with <code>mclust1Dplot()</code>. Additional arguments can be specified for fine tuning, as described in <code>help("mclust1Dplot")</code>. <code>MclustDA()</code> and <code>densityMclust()</code> models can also be vizualized with <code>mclust1Dplot()</code> in the same way as described above.</p>
</div>
</section><section id="sec-display2" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="sec-display2">
<span class="header-section-number">6.2</span> Displays for Bivariate Data</h2>
<p><strong>mclust</strong> models fitted to bivariate data can be visualized with <code>mclust2Dplot()</code> <!-- \index{mclust!\code{mclust2Dplot()}} --> and, for finer details, <code>surfacePlot()</code>. <!-- \index{mclust!\code{surfacePlot()}} --></p>
<div id="exm-faithful_add_graphs" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.2</strong></span> &nbsp;&nbsp;<strong>Additional graphs for the Old Faithful data</strong></p>
<p>In the following code, classification and uncertainty plots are produced for a <code>Mclust()</code> model estimated on the <code>faithful</code> dataset discussed in <a href="03_cluster.html#exm-oldfaithful" class="quarto-xref">Example&nbsp;<span>3.4</span></a>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span><span class="fu">mclust2Dplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">faithful</span>, what <span class="op">=</span> <span class="st">"classification"</span>, </span>
<span>             parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>, z <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="fu">mclust2Dplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">faithful</span>, what <span class="op">=</span> <span class="st">"uncertainty"</span>,</span>
<span>             parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>, z <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-faithful2Dplots1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-faithful2Dplots1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful2Dplots1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful2Dplots1-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful2Dplots1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful2Dplots1-1.png" id="fig-faithful2Dplots1-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful2Dplots1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful2Dplots1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful2Dplots1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful2Dplots1-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful2Dplots1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful2Dplots1-2.png" id="fig-faithful2Dplots1-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful2Dplots1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful2Dplots1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-faithful2Dplots1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: Classification (a) and uncertainty (b) plots created with <code>mclust2Dplot()</code> for the model fitted with <code>Mclust()</code> to the <code>faithful</code> dataset.
</figcaption></figure>
</div>
<p>The resulting plots are shown in <a href="#fig-faithful2Dplots1" class="quarto-xref">Figure&nbsp;<span>6.2</span></a>. In both plots, the ellipses are the multivariate analogs of the standard deviations for each mixture component. In the classification plot, points in different clusters are marked by different symbols and colors. In the uncertainty plot, larger symbols and more opaque shades correspond to higher levels of uncertainty. Data points on the boundaries between the two clusters on the top-right part of the plot are associated with higher values of clustering uncertainty.</p>
<p>Density or uncertainty for <strong>mclust</strong> models of bivariate data can also be displayed using <code>surfacePlot()</code>. <!-- \index{mclust!\code{surfacePlot()}} --> This function invisibly returns the grid coordinates and the corresponding surface values employed for plotting, information that advanced users can use for further processing. For example, <a href="#fig-faithful2Dplots2" class="quarto-xref">Figure&nbsp;<span>6.3</span></a> shows contour, image, perspective, and uncertainty plots for the model fitted to the <code>faithful</code> dataset:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">surfacePlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">faithful</span>, parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>            what <span class="op">=</span> <span class="st">"density"</span>, type <span class="op">=</span> <span class="st">"contour"</span>,</span>
<span>            transformation <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="fu">surfacePlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">faithful</span>, parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>            what <span class="op">=</span> <span class="st">"density"</span>, type <span class="op">=</span> <span class="st">"image"</span><span class="op">)</span></span>
<span><span class="fu">surfacePlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">faithful</span>, parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>            what <span class="op">=</span> <span class="st">"density"</span>, type <span class="op">=</span> <span class="st">"persp"</span><span class="op">)</span></span>
<span><span class="fu">surfacePlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">faithful</span>, parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>            what <span class="op">=</span> <span class="st">"uncertainty"</span>, type <span class="op">=</span> <span class="st">"image"</span>,</span>
<span>            transformation <span class="op">=</span> <span class="st">"sqrt"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-faithful2Dplots2" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-faithful2Dplots2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful2Dplots2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful2Dplots2-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful2Dplots2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful2Dplots2-1.png" id="fig-faithful2Dplots2-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful2Dplots2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful2Dplots2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful2Dplots2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful2Dplots2-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful2Dplots2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful2Dplots2-2.png" id="fig-faithful2Dplots2-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful2Dplots2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful2Dplots2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful2Dplots2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful2Dplots2-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful2Dplots2-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful2Dplots2-3.png" id="fig-faithful2Dplots2-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful2Dplots2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful2Dplots2-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-faithful2Dplots2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-faithful2Dplots2-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-faithful2Dplots2-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-faithful2Dplots2-4.png" id="fig-faithful2Dplots2-4" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-faithful2Dplots2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-faithful2Dplots2-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-faithful2Dplots2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: Density (a–c) and uncertainty (d) surfaces created with <code>surfacePlot()</code> for the <code>faithful</code> dataset. A logarithmic transformation is used for the density plot in panel (a), which is drawn as a contour surface. No transformation is applied to panels (b) and (c) which show, respectively, an image plot of the density surface and a 3D perspective plot. Panel (d) displays the image surface of the square root of the clustering uncertainty.
</figcaption></figure>
</div>
<p>Note that plots in <a href="#fig-faithful2Dplots2" class="quarto-xref">Figure&nbsp;<span>6.3</span></a> are computed over an evenly spaced grid of 200 points (the default) along each axis. More arguments are available for fine tuning; a detailed description can be found via <code>help("surfacePlot")</code>.</p>
</div>
</section><section id="sec-displayhd" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="sec-displayhd">
<span class="header-section-number">6.3</span> Displays for Higher Dimensional Data</h2>
<section id="coordinate-projections" class="level3" data-number="6.3.1"><h3 data-number="6.3.1" class="anchored" data-anchor-id="coordinate-projections">
<span class="header-section-number">6.3.1</span> Coordinate Projections</h3>
<p>Coordinate projections can be plotted in <strong>mclust</strong> with <code>coordProj()</code>. <!-- \index{mclust!\code{coordProj()}} --></p>
<div id="exm-iris_coordproj" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.3</strong></span> &nbsp;&nbsp;<strong>Coordinate projections for the iris data</strong></p>
<p>Consider the best (according to BIC) three-group GMM estimated on the <code>iris</code> dataset described in <a href="03_cluster.html#exm-iris" class="quarto-xref">Example&nbsp;<span>3.13</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"iris"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, G <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></span>
<span><span class="co">## ---------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mclust VEV (ellipsoidal, equal shape) model with 3 components: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC     ICL</span></span>
<span><span class="co">##         -186.07 150 38 -562.55 -566.47</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering table:</span></span>
<span><span class="co">##  1  2  3 </span></span>
<span><span class="co">## 50 45 55</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following code produces projection plots for coordinates 2 and 4 of the iris data (see <a href="#fig-irisCoordProj1" class="quarto-xref">Figure&nbsp;<span>6.4</span></a>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">coordProj</span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, dimens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, what <span class="op">=</span> <span class="st">"classification"</span>,</span>
<span>          parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>, z <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="fu">coordProj</span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, dimens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, what <span class="op">=</span> <span class="st">"uncertainty"</span>,</span>
<span>          parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>, z <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="fu">coordProj</span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, dimens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, what <span class="op">=</span> <span class="st">"error"</span>,</span>
<span>          parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>, z <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">z</span>, truth <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-irisCoordProj1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-irisCoordProj1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisCoordProj1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisCoordProj1-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisCoordProj1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisCoordProj1-1.png" id="fig-irisCoordProj1-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisCoordProj1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisCoordProj1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisCoordProj1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisCoordProj1-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisCoordProj1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisCoordProj1-2.png" id="fig-irisCoordProj1-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisCoordProj1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisCoordProj1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisCoordProj1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisCoordProj1-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisCoordProj1-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisCoordProj1-3.png" id="fig-irisCoordProj1-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisCoordProj1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisCoordProj1-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-irisCoordProj1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: Coordinate projection plots created with <code>coordProj()</code> for the variables <code>Sepal.Width</code> and <code>Petal.Width</code> from the <code>iris</code> dataset. Panel (a) shows the three-group model-based clustering, with the associated uncertainty in panel (b) and the classification errors in panel (c).
</figcaption></figure>
</div>
</div>
</section><section id="random-projections" class="level3" data-number="6.3.2"><h3 data-number="6.3.2" class="anchored" data-anchor-id="random-projections">
<span class="header-section-number">6.3.2</span> Random Projections</h3>
<p>In the previous section, we looked at bivariate marginal coordinate projections that involve selected pairs of variables. Higher dimensional data prove to be much more difficult to visualize. A different approach, discussed in this section, consists of looking at the data from different random perspectives.</p>
<!--
% CF: removed below
% LS: ?

Suppose we want to project your $n \times d$ data matrix $\X$ onto the $p$-dimensional subspace spanned by a random orthogonal basis $\betab$, a matrix of dimension $d \times p$, with $p < d$.
Such a basis can be obtained by computing the QR decomposition of a $d \times p$ matrix $\A$ of values drawn from a standard normal distribution:
$$
\A = \Q\R = \begin{bmatrix} \Q_{1}, \Q_{2}\end{bmatrix}
            \begin{bmatrix} \R_{1} \\ 0 \end{bmatrix} 
   = \Q_1 \R_1,
$$
where $\R_1$ is a $p \times p$ upper triangular matrix, $\0$ is an $(d-p) \times p$ zero matrix, $\Q_1$ is an $d \times p$ matrix, $\Q_2$ is an $d \times (d-p)$ matrix, and both $\Q_1$ and $\Q_2$ have orthonormal columns. The matrix $\betab \equiv \Q_1$ is an orthogonal random basis such that $\betab\T\betab = \I$, and the data projected onto the subspace spanned by $\betab$ can be computed as $\X\betab$.
$$
\A = \Q\R,
$$
where $\R$ is a $p \times p$ upper triangular matrix, and $\Q$ is a $d \times p$ matrix with orthogonal and unit length columns. Then, the matrix $\betab \equiv \Q$ is an orthonormal random basis ($\betab\T\betab = \I$), and the data projected on the subspace spanned by $\betab$ can be computed as $\X\betab$. For more details see @Heiberger:1978.

CF: This is much more complicated than necessary. You can formulate the QR decomposition in a couple of ways, but if you do QR in R, for example, the default for d > p is that Q will be d x p and R p x p. No need for d x d times d x p here. No real need to spell out the factorization in my opinion.
-->
<p>Two-dimensional random projections can be computed and plotted in <strong>mclust</strong> with <code>randProj()</code>. <!-- \index{mclust!\code{randProj()}} --> These projections are obtained by simulating a set of random orthogonal coordinates, each spanning a two-dimensional projection subspace. <strong>mclust</strong> provides a wrapper function <code>randomOrthogonalMatrix()</code> <!-- \index{mclust!\code{randomOrthogonalMatrix()}}  --> for generating orthogonal coordinates from a QR factorization of a matrix whose entries are generated randomly from a normal distribution <span class="citation" data-cites="Heiberger:1978">(<a href="99_references.html#ref-Heiberger:1978" role="doc-biblioref">Heiberger 1978</a>)</span>.</p>
<p>The following code produces a <span class="math inline">\(4 \times 2\)</span> orthogonal matrix <span class="math inline">\(Q\)</span> suitable for projecting the <code>iris</code> data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">## [1] 150</span></span>
<span><span class="va">Q</span> <span class="op">=</span> <span class="fu">randomOrthogonalMatrix</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span>
<span><span class="co">## [1] 4 2</span></span>
<span><span class="va">QTQ</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html">crossprod</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span>           <span class="co"># equivalently t(Q) %*% Q</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/zapsmall.html">zapsmall</a></span><span class="op">(</span><span class="va">QTQ</span><span class="op">)</span>                <span class="co"># 2 x 2 identity matrix</span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]    1    0</span></span>
<span><span class="co">## [2,]    0    1</span></span>
<span><span class="co"># projection of iris data onto coordinates Q</span></span>
<span><span class="va">irisProj</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Q</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For a discussion of methods for generating random orthogonal matrices, see <span class="citation" data-cites="Anderson:Olkin:Underhill:1987">Anderson, Olkin, and Underhill (<a href="99_references.html#ref-Anderson:Olkin:Underhill:1987" role="doc-biblioref">1987</a>)</span>.</p>
<p>The data <span class="math inline">\(\boldsymbol{X}\)</span> can be projected onto a subspace spanned by orthogonal coordinates <span class="math inline">\(\boldsymbol{\beta}\)</span> by computing <span class="math inline">\(\boldsymbol{X}\boldsymbol{\beta}\)</span>. It can be shown that for a given GMM with estimated means <span class="math inline">\(\widehat{\boldsymbol{\mu}}_k\)</span> and covariance matrices <span class="math inline">\(\widehat{\boldsymbol{\Sigma}}_k\)</span> (<span class="math inline">\(k=1,\dots,G\)</span>), the parameters of the Gaussian components on the projection subspace are <span class="math inline">\(\boldsymbol{\beta}{}^{\!\top}\widehat{\boldsymbol{\mu}}_k\)</span> and <span class="math inline">\(\boldsymbol{\beta}{}^{\!\top}\widehat{\boldsymbol{\Sigma}}_k \boldsymbol{\beta}\)</span>, respectively. Finally, note that the number of two-dimensional projections generated by <code>randProj()</code> depends on the number of values provided through the optional argument <code>seeds</code>.</p>
<div id="exm-iris_rndproj" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.4</strong></span> &nbsp;&nbsp;<strong>Random projections for the iris data</strong></p>
<p>Consider again the three-group GMM for the <code>iris</code> dataset from the previous subsection. The following code produces four random projections of the <code>iris</code> data with corresponding cluster ellipses and model classification:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">randProj</span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, seeds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">13</span>,<span class="fl">79</span>,<span class="fl">201</span><span class="op">)</span>, </span>
<span>         what <span class="op">=</span> <span class="st">"classification"</span>,</span>
<span>         parameters <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">parameters</span>, z <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-irisRandProj2" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-irisRandProj2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisRandProj2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisRandProj2-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisRandProj2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisRandProj2-1.png" id="fig-irisRandProj2-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisRandProj2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisRandProj2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisRandProj2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisRandProj2-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisRandProj2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisRandProj2-2.png" id="fig-irisRandProj2-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisRandProj2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisRandProj2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisRandProj2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisRandProj2-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisRandProj2-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisRandProj2-3.png" id="fig-irisRandProj2-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisRandProj2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisRandProj2-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisRandProj2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisRandProj2-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisRandProj2-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisRandProj2-4.png" id="fig-irisRandProj2-4" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisRandProj2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisRandProj2-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-irisRandProj2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.5: Random projection plots, all showing the three-group model-based clustering of the <code>iris</code> dataset. Each plot was created with <code>randProj()</code> with a different seed.
</figcaption></figure>
</div>
<p>The resulting plots are shown in <a href="#fig-irisRandProj2" class="quarto-xref">Figure&nbsp;<span>6.5</span></a>. Since the basis of each projection is random, to make the results reproducible we fixed the seeds using the <code>seeds</code> argument in the <code>randProj()</code> function call. If not provided, each call of <code>randProj()</code> will result in a different projection using a system-generated seed.</p>
</div>
</section><section id="sec-crimcoords" class="level3" data-number="6.3.3"><h3 data-number="6.3.3" class="anchored" data-anchor-id="sec-crimcoords">
<span class="header-section-number">6.3.3</span> Discriminant Coordinate Projections</h3>
<p>Both the coordinate and random projection plots decribed above %are intended to display GMMs in different subspaces, without attempting to select coordinates based on any specific visual criteria. By contrast, <em>discriminant coordinates</em> or <em>crimcoords</em> <!-- \index{discriminant coordinates (crimcoords)} --> <span class="citation" data-cites="Gnanadesikan:1977 Flury:1997">(<a href="99_references.html#ref-Gnanadesikan:1977" role="doc-biblioref">Gnanadesikan 1977</a>; <a href="99_references.html#ref-Flury:1997" role="doc-biblioref">Bernard Flury 1997</a>)</span> are specifically designed to reveal group separation, and they can be used both in the case of known groups and of groups identified by a clustering model or algorithm.</p>
<p>Consider a data matrix <span class="math inline">\(\boldsymbol{X}\)</span> of dimension <span class="math inline">\(n \times d\)</span>, for <span class="math inline">\(n\)</span> observations on <span class="math inline">\(d\)</span> variables, with an associated group structure composed either by <span class="math inline">\(G\)</span> known classes or estimated clusters. Let <span class="math inline">\(\boldsymbol{\bar{x}}\)</span> be the overall sample mean vector, and <span class="math inline">\(\boldsymbol{\bar{x}}_k\)</span> and <span class="math inline">\(\boldsymbol{S}_k\)</span>, respectively, the group-specific sample mean vector and sample covariance matrix on <span class="math inline">\(n_k\)</span> observations (<span class="math inline">\(k = 1, \dots, G\)</span>; <span class="math inline">\(n = \sum_{k=1}^G n_k\)</span>). Then, the <span class="math inline">\(d \times d\)</span> between-groups covariance matrix <span class="math display">\[
\boldsymbol{B}= \frac{1}{G} \sum_{k=1}^G n_k (\boldsymbol{\bar{x}}_k - \boldsymbol{\bar{x}})(\boldsymbol{\bar{x}}_k - \boldsymbol{\bar{x}}){}^{\!\top}
\]</span> represents the group separation, while the <span class="math inline">\(d \times d\)</span> pooled within-groups covariance matrix <span class="math display">\[
\boldsymbol{W}= \frac{1}{n} \sum_{k=1}^G (n_k - 1) \boldsymbol{S}_k.
\]</span> represents the within-group dispersion.</p>
<p>From the point of view of searching for the maximal separation of groups, the optimal projection subspace is given by the set of linear transformations of the original variables that maximizes the ratio of the between-groups covariance to the pooled within-groups covariance. The basis of this projection subspace is spanned by the eigenvectors <span class="math inline">\(\boldsymbol{v}_i\)</span> corresponding to the non-zero eigenvalues of the generalized eigenvalue problem: <span class="math display">\[\begin{align*}
\boldsymbol{B}\boldsymbol{v}_i &amp; = \gamma_i \boldsymbol{W}\boldsymbol{v}_i, \\
\boldsymbol{v}{}^{\!\top}_i \boldsymbol{W}\boldsymbol{v}_j &amp; = 1 \qquad \text{if $i=j$, and $0$ otherwise.}
\end{align*}\]</span></p>
<p>The <em>discriminant coordinates</em> or <em>crimcoords</em> are computed as <span class="math inline">\(\boldsymbol{X}\boldsymbol{V}\)</span>, where <span class="math inline">\(\boldsymbol{V}\equiv [\boldsymbol{v}_1, \dots, \boldsymbol{v}_p]\)</span> is the <span class="math inline">\(d \times p\)</span> matrix of <span class="math inline">\(p = {\min(d,G-1),r}\)</span> eigenvectors, where <span class="math inline">\(r\)</span> is the number of non-zero eigenvalues. The directions of the discriminant subspace spanned by <span class="math inline">\(\boldsymbol{V}\)</span> are in decreasing order of effectiveness in identifying the separation among groups as expressed by the associated eigenvalues, <span class="math inline">\(\gamma_1 \ge \gamma_2 \ge \dots \ge \gamma_p &gt; 0\)</span>.</p>
<p>Alternatively, unbiased-sample estimates may be used for these computatons: <span class="math inline">\(\frac{G}{G-1}\boldsymbol{B}\)</span> for the between-groups covariance and <span class="math inline">\(\frac{n}{n-G}\boldsymbol{W}\)</span> for the within-groups covariance. These would change the eigenvalues and eigenvectors by a constant of proportionality, equal to <span class="math inline">\(n(G-1)/(G(n-G))\)</span> and <span class="math inline">\(\sqrt{n/(n-G)}\)</span>, respectively.</p>
<p>The method described above is implemented in the function <code>crimcoords()</code> <!-- \index{mclust!\code{crimcoords()}}  --> available in <strong>mclust</strong>. This requires the arguments <code>data</code>, a matrix or data frame of observed data, and <code>classification</code>, a vector or a factor giving the groups classification, either known class labels or estimated cluster assignments. Optional arguments are <code>numdir</code>, an integer value specifying the number of directions to return (by default all those corresponding to non-zero eigenvalues), and <code>unbiased</code>, a logical value specifying whether unbiased estimates should be used (by default set to <code>FALSE</code> so that MLE estimates are used). <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> and <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> methods are available to show the estimated projections basis and the corresponding data projection.</p>
<div id="exm-iris_crimcoords" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.5</strong></span> &nbsp;&nbsp;<strong>Discriminant coordinates for the iris data</strong></p>
<p>Discriminant coordinates of the iris data are computed and plotted with the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">crimcoords</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-iris_crimcoords" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-iris_crimcoords-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-iris_crimcoords-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-iris_crimcoords-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.6: Discriminant coordinates or crimcoords projection for the clustering for the 3-group model-based clustering of the <code>iris</code> dataset.
</figcaption></figure>
</div>
</div>
</div>
<p>with the resulting plot shown in <a href="#fig-iris_crimcoords" class="quarto-xref">Figure&nbsp;<span>6.6</span></a>.</p>
</div>
<div id="exm-thyroid_crimcoords" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.6</strong></span> &nbsp;&nbsp;<strong>Discriminant coordinates for the thyroid disease data</strong></p>
<p>Consider the data introduced in <a href="03_cluster.html#exm-thyroid" class="quarto-xref">Example&nbsp;<span>3.2</span></a> from the Thyroid Disease Data from the UCI Repository <span class="citation" data-cites="UCI:dataset">(<a href="99_references.html#ref-UCI:dataset" role="doc-biblioref">Dua and Graff 2017</a>)</span>. We compute the discriminant coordinates with <code>crimcoords()</code> using the thyroid diagnosis as the classification variable, and then print the computed eigenvectors and eigenvalues using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> <!-- \index{mclust!\code{summary.crimcoords()}}  --> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"thyroid"</span>, package <span class="op">=</span> <span class="st">"mclust"</span><span class="op">)</span></span>
<span><span class="va">CRIMCOORDS</span> <span class="op">=</span> <span class="fu">crimcoords</span><span class="op">(</span><span class="va">thyroid</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">thyroid</span><span class="op">$</span><span class="va">Diagnosis</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">CRIMCOORDS</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------- </span></span>
<span><span class="co">## Discriminant coordinates (crimcoords) </span></span>
<span><span class="co">## ------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated basis vectors: </span></span>
<span><span class="co">##      crimcoords1 crimcoords2</span></span>
<span><span class="co">## RT3U   -0.025187  -0.0019885</span></span>
<span><span class="co">## T4      0.307600   0.1042255</span></span>
<span><span class="co">## T3      0.116701   0.4371644</span></span>
<span><span class="co">## TSH    -0.038588   0.1484593</span></span>
<span><span class="co">## DTSH   -0.073398   0.0745668</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##             crimcoords1 crimcoords2</span></span>
<span><span class="co">## Eigenvalues     275.143      52.473</span></span>
<span><span class="co">## Cum. %           83.983     100.000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The associated <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> <!-- \index{mclust!\code{plot.crimcoords()}}  --> method can then be used for plotting the data points projected onto the discriminant coordinates subspace. In the following code we also add a projection of the corresponding group-centroids:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">CRIMCOORDS</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">CRIMCOORDS</span><span class="op">$</span><span class="va">means</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">CRIMCOORDS</span><span class="op">$</span><span class="va">basis</span>, pch <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">thyroid</span><span class="op">$</span><span class="va">Diagnosis</span><span class="op">)</span>, inset <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>       col <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotSymbols"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-thyroid_crimcoords" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-thyroid_crimcoords-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-thyroid_crimcoords-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-thyroid_crimcoords-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.7: Discriminant coordinates or crimcoords projection for the diagnosis classes of the <code>thyroid</code> dataset. Group centroids are represented with the <span class="math inline">\(+\)</span> symbol.
</figcaption></figure>
</div>
</div>
</div>
<p>The resulting plot is shown in <a href="#fig-thyroid_crimcoords" class="quarto-xref">Figure&nbsp;<span>6.7</span></a>. It is interesting to note that patients with normal thyroid function line up along the left arm, while the remaining patients with hyperthyroidism or hypothyroidism line up along the right arm.</p>
</div>
<p>An alternative method for selecting an informative basis of the projection subspace is discussed in <span class="citation" data-cites="Scrucca:Serafini:2019">Scrucca and Serafini (<a href="99_references.html#ref-Scrucca:Serafini:2019" role="doc-biblioref">2019</a>)</span>. They use a projection pursuit approach that maximizes an approximation to the negative entropy for Gaussian mixtures to determine coordinates for display.</p>
</section></section><section id="sec-displaydr" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="sec-displaydr">
<span class="header-section-number">6.4</span> Visualizing Model-Based Clustering and Classification on Projection Subspaces</h2>
<p>When the number of clustering or classification features is larger than two, the marginal or random projections described in <a href="#sec-displayhd" class="quarto-xref"><span>Section 6.3</span></a> are not guaranteed to produce displays that reveal the underlying structure of the data. Discriminant coordinates (<a href="#sec-crimcoords" class="quarto-xref"><span>Section 6.3.3</span></a>) provide an attempt at showing maximal separation of groups without explicitly assuming any specific model.</p>
<p>With the aim of visualizing the clustering structure and geometric characteristics induced by a GMM, <span class="citation" data-cites="Scrucca:2010">Scrucca (<a href="99_references.html#ref-Scrucca:2010" role="doc-biblioref">2010</a>)</span>,Scrucca:2014 proposed a methodology for projecting the data onto subspaces of reduced dimension. These subspaces are spanned by a set of linear combinations of the original variables, called GMMDR directions <!-- \index{GMMDR projection}  --> (“DR” for Dimension Reduction). They are obtained through a procedure that looks for the smallest subspace that captures the clustering information contained in the data. Thus, the goal is to identify those directions where the cluster means <span class="math inline">\(\boldsymbol{\mu}_k\)</span> and/or the cluster covariances <span class="math inline">\(\boldsymbol{\Sigma}_k\)</span> vary as much as possible, provided that each direction is orthogonal to the others in a transformed space. These methods are implemented in the <strong>mclust</strong> functions <code>MclustDR()</code> and <code>MclustDRsubsel()</code>.</p>
<section id="sec-clustsep" class="level3" data-number="6.4.1"><h3 data-number="6.4.1" class="anchored" data-anchor-id="sec-clustsep">
<span class="header-section-number">6.4.1</span> Projection Subspaces for Visualizing Cluster Separation</h3>
<p>The variation among the cluster means is captured by the <span class="math inline">\(d \times d\)</span> matrix <span id="eq-GMMDR_meansVar"><span class="math display">\[
\mathbb{\mathcal{B}}= \sum_{k=1}^G \pi_k (\boldsymbol{\mu}_k - \boldsymbol{\mu})(\boldsymbol{\mu}_k - \boldsymbol{\mu}){}^{\!\top},
\tag{6.1}\]</span></span> where <span class="math inline">\(\boldsymbol{\mu}= \sum_{k=1}^G \pi_k \boldsymbol{\mu}_k\)</span> is the marginal mean vector. The projection subspace associated with this variation is spanned by the eigenvectors <span class="math inline">\(\boldsymbol{v}_i\)</span> corresponding to the non-zero eigenvalues of the following generalized eigenvalue problem: <span id="eq-GMMDR_eigenMeans"><span class="math display">\[
\begin{align}
\mathbb{\mathcal{K}}_{\mu}\boldsymbol{v}_i  &amp;= \gamma_i \boldsymbol{\Sigma}\boldsymbol{v}_i, \\
\boldsymbol{v}{}^{\!\top}_i \boldsymbol{\Sigma}\boldsymbol{v}_j &amp;= 1 \qquad \text{if $i=j$, and $0$ otherwise,} \nonumber
\end{align}
\tag{6.2}\]</span></span> in which <span id="eq-GMMDR_KernMeans"><span class="math display">\[
\mathbb{\mathcal{K}}_{\mu}= \mathbb{\mathcal{B}}\boldsymbol{\Sigma}^{-1} \mathbb{\mathcal{B}}
\tag{6.3}\]</span></span> is the kernel matrix associated with the cluster means, and <span id="eq-GMMDR_margcov"><span class="math display">\[
\boldsymbol{\Sigma}= \frac{1}{n} \sum_{i=1}^{n} (\boldsymbol{x}_i - \boldsymbol{\mu})(\boldsymbol{x}_i - \boldsymbol{\mu}){}^{\!\top}
\tag{6.4}\]</span></span> is the marginal covariance matrix. <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is symmetric positive definite, and <span class="math inline">\(\mathbb{\mathcal{K}}_{\mu}\)</span> is also symmetric with nonnegative eigenvalues, of which <span class="math inline">\(p = \min(d,G-1)\)</span> are non-zero. The GMMDR variables <span class="math inline">\(\boldsymbol{X}\boldsymbol{\beta}\)</span> are the projection of the <span class="math inline">\(n \times d\)</span> matrix <span class="math inline">\(\boldsymbol{X}\)</span> onto the subspace spanned by <span class="math inline">\(\boldsymbol{\beta}\equiv [\boldsymbol{v}_1, \dots, \boldsymbol{v}_p]\)</span>. The basis vectors <span class="math inline">\(\boldsymbol{v}_i\)</span> are orthogonal in the space transformed by <span class="math inline">\(\boldsymbol{\Sigma}\)</span>.</p>
<div id="exm-wine_gmmdr" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.7</strong></span> &nbsp;&nbsp;<strong>Visualizing wine data clustering</strong></p>
<p>In this example, we consider the Italian wines from the package <code>gclus</code> <span class="citation" data-cites="Rpkg:gclus">(<a href="99_references.html#ref-Rpkg:gclus" role="doc-biblioref">Hurley 2019</a>)</span> data previously discussed in <a href="03_cluster.html#exm-cluster_wine" class="quarto-xref">Example&nbsp;<span>3.3</span></a>, where the estimated <code>VVE</code> model with three components was selected by BIC. We first obtain the <code>Mclust()</code> model for this data and the confusion matrix for the resulting classification:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"wine"</span>, package <span class="op">=</span> <span class="st">"gclus"</span><span class="op">)</span></span>
<span><span class="va">Class</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">wine</span><span class="op">$</span><span class="va">Class</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>                labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Barolo"</span>, <span class="st">"Grignolino"</span>, <span class="st">"Barbera"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">wine</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">3</span>, modelNames <span class="op">=</span> <span class="st">"VVE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Class</span>, Cluster <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="co">##             Cluster</span></span>
<span><span class="co">## Class         1  2  3</span></span>
<span><span class="co">##   Barolo     59  0  0</span></span>
<span><span class="co">##   Grignolino  0 69  2</span></span>
<span><span class="co">##   Barbera     0  0 48</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>MclustDR()</code> is then applied to obtain a projection subspace:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">drmod</span> <span class="op">=</span> <span class="fu">MclustDR</span><span class="op">(</span><span class="va">mod</span>, lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">drmod</span><span class="op">)</span></span>
<span><span class="co">## ----------------------------------------------------------------- </span></span>
<span><span class="co">## Dimension reduction for model-based clustering and classification </span></span>
<span><span class="co">## ----------------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixture model type: Mclust (VVE, 3) </span></span>
<span><span class="co">##         </span></span>
<span><span class="co">## Clusters  n</span></span>
<span><span class="co">##        1 59</span></span>
<span><span class="co">##        2 69</span></span>
<span><span class="co">##        3 50</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated basis vectors: </span></span>
<span><span class="co">##                        Dir1        Dir2</span></span>
<span><span class="co">## Alcohol          0.13399009  0.19209123</span></span>
<span><span class="co">## Malic           -0.03723778  0.06424412</span></span>
<span><span class="co">## Ash             -0.01313103  0.62738796</span></span>
<span><span class="co">## Alcalinity      -0.04299147 -0.03715437</span></span>
<span><span class="co">## Magnesium       -0.00053971  0.00051772</span></span>
<span><span class="co">## Phenols         -0.13507235 -0.04687991</span></span>
<span><span class="co">## Flavanoids       0.51323644 -0.13391186</span></span>
<span><span class="co">## Nonflavanoid     0.68462875 -0.61863302</span></span>
<span><span class="co">## Proanthocyanins -0.07506153 -0.04652587</span></span>
<span><span class="co">## Intensity       -0.08855450  0.04877118</span></span>
<span><span class="co">## Hue              0.28941727 -0.39564601</span></span>
<span><span class="co">## OD280            0.36197696 -0.00779361</span></span>
<span><span class="co">## Proline          0.00070724  0.00075867</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                Dir1    Dir2</span></span>
<span><span class="co">## Eigenvalues  1.6189   1.292</span></span>
<span><span class="co">## Cum. %      55.6156 100.000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Setting the tuning parameter <span class="math inline">\(\lambda\)</span> to <span class="math inline">\(1\)</span> (the default in <code>MclustDR()</code>) results in a projection subspace for maximal separation of clusters. Other options that incorporate the variation in covariances are discussed in <a href="#sec-varcov" class="quarto-xref"><span>Section 6.4.2</span></a>.</p>
<p>Recall that the basis from <a href="#eq-GMMDR_eigenMeans" class="quarto-xref">Equation&nbsp;<span>6.2</span></a> consists of <span class="math inline">\(p = \min(d, G-1)\)</span> directions, where <span class="math inline">\(d\)</span> is the number of variables and <span class="math inline">\(G\)</span> the number of mixture components or clusters. In this example, there are <span class="math inline">\(d=13\)</span> features and <span class="math inline">\(G=3\)</span> clusters, so the reduced subspace is two-dimensional. The projected data are shown in <a href="#fig-winedr-1" class="quarto-xref">Figure&nbsp;<span>6.8 (a)</span></a>, obtained with the code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">drmod</span>, what <span class="op">=</span> <span class="st">"contour"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On the same subspace we can also plot the uncertainty boundaries corresponding to the MAP classification (see <a href="#fig-winedr-2" class="quarto-xref">Figure&nbsp;<span>6.8 (b)</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">drmod</span>, what <span class="op">=</span> <span class="st">"boundaries"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-winedr" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-winedr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-winedr" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-winedr-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-winedr-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-winedr-1.png" id="fig-winedr-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-winedr">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-winedr-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-winedr" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-winedr-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-winedr-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-winedr-2.png" id="fig-winedr-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-winedr">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-winedr-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-winedr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.8: Contour plot of estimated mixture densities (a) and uncertainty boundaries (b) projected onto the subspace estimated with <code>MclustDR()</code> for the <code>wine</code> dataset.
</figcaption></figure>
</div>
</div>
<p>Although the GMMDR subspaces discussed in this section are not guaranteed to show cluster separation, they do provide useful clustering information in many cases of practical interest. When there are only two clusters, there is just one basis vector and the projections will be univariate.</p>
</section><section id="sec-varcov" class="level3" data-number="6.4.2"><h3 data-number="6.4.2" class="anchored" data-anchor-id="sec-varcov">
<span class="header-section-number">6.4.2</span> Incorporating Variation in Covariances</h3>
<p>Analogous to the scenario for cluster means discussed in the previous section, the variation among the cluster covariances is captured by the <span class="math inline">\(d \times d\)</span> kernel matrix <span class="math display">\[
\mathbb{\mathcal{K}}_{\Sigma}= \sum_{k=1}^G \pi_k (\boldsymbol{\Sigma}_k - \bar{\boldsymbol{\Sigma}}) \boldsymbol{\Sigma}^{-1} (\boldsymbol{\Sigma}_k - \bar{\boldsymbol{\Sigma}}){}^{\!\top},
\]</span> where <span class="math display">\[
\bar{\boldsymbol{\Sigma}} = \sum_{k=1}^G \pi_k \boldsymbol{\Sigma}_k
\]</span> is the <em>pooled</em> within-cluster covariance matrix, and <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is the marginal covariance matrix in <a href="#eq-GMMDR_margcov" class="quarto-xref">Equation&nbsp;<span>6.4</span></a>.</p>
<p>The variation in both means and variances can then be combined, and the associated projection subspace is spanned by the eigenvectors <span class="math inline">\(\boldsymbol{v}_i\)</span> that solve the generalized eigenvalue problem <span id="eq-GMMDR_eigen"><span class="math display">\[
\begin{align}
\big(\lambda \mathbb{\mathcal{K}}_{\mu}+ (1-\lambda) \mathbb{\mathcal{K}}_{\Sigma}\big) \boldsymbol{v}_i  &amp;= \gamma_i \boldsymbol{\Sigma}\boldsymbol{v}_i, \\
\boldsymbol{v}{}^{\!\top}_i \boldsymbol{\Sigma}\boldsymbol{v}_j &amp;= 1 \qquad \text{if $i=j$, and $0$ otherwise,}
\end{align}
\tag{6.5}\]</span></span> in which <span class="math inline">\(\mathbb{\mathcal{K}}_{\mu}\)</span> is the kernel matrix <a href="#eq-GMMDR_KernMeans" class="quarto-xref">Equation&nbsp;<span>6.3</span></a> associated with the cluster means in <a href="#sec-clustsep" class="quarto-xref"><span>Section 6.4.1</span></a>, and <span class="math inline">\(\lambda \in [0,1]\)</span> is a parameter controlling the relative contributions of the mean and covariance variations <span class="citation" data-cites="Scrucca:2014">(<a href="99_references.html#ref-Scrucca:2014" role="doc-biblioref">Scrucca 2014</a>)</span>.</p>
<p>For larger values of <span class="math inline">\(\lambda\)</span>, the estimated directions will tend to focus on differences in location. For <span class="math inline">\(\lambda = 1\)</span> (the default in <code>MclustDR()</code>), differences in class covariances are ignored, and the most discriminant directions (those that show maximal separation among classes) are recovered (<a href="#sec-clustsep" class="quarto-xref"><span>Section 6.4.1</span></a>). For <span class="math inline">\(\lambda = 0.5\)</span>, the two types of information are equally weighted <span class="citation" data-cites="Scrucca:2010">(<a href="99_references.html#ref-Scrucca:2010" role="doc-biblioref">Scrucca 2010</a>)</span>. When <span class="math inline">\(\lambda &lt; 1\)</span>, the GMMDR variables <span class="math inline">\(\boldsymbol{X}\boldsymbol{\beta}\)</span> are the projection of the <span class="math inline">\(n \times d\)</span> matrix <span class="math inline">\(\boldsymbol{X}\)</span> onto the subspace spanned by <span class="math inline">\(\boldsymbol{\beta}\equiv [\boldsymbol{v}_1, \dots, \boldsymbol{v}_d]\)</span>, which has the same dimension as the data, regardless of the number of GMM components. Note that each generalized eigenvalue <span class="math inline">\(\gamma_i\)</span> is the sum of contributions from both the means and the variances: <span class="math display">\[
\gamma_i  = \gamma_i \boldsymbol{v}_i{}^{\!\top}\boldsymbol{\Sigma}\boldsymbol{v}_i = \lambda \boldsymbol{v}_i{}^{\!\top}\mathbb{\mathcal{K}}_{\mu}\boldsymbol{v}_i +
(1-\lambda) \boldsymbol{v}_i{}^{\!\top}\mathbb{\mathcal{K}}_{\Sigma}\boldsymbol{v}_i, ~~ i = 1, \dots, d.
\]</span></p>
<div id="exm-iris_gmmdr" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.8</strong></span> &nbsp;&nbsp;<strong>Visualizing iris data clustering</strong></p>
<p>As an example of the above methodology, consider again the three-group model for the <code>iris</code> dataset described in <a href="#sec-displayhd" class="quarto-xref"><span>Section 6.3</span></a>. Once a GMM model has been fitted, the subspace estimated by <code>MclustDR()</code> can be used for plots that attempt to capture most of the clustering structure:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, G <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">drmod</span> <span class="op">=</span> <span class="fu">MclustDR</span><span class="op">(</span><span class="va">mod</span>, lambda <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">drmod</span><span class="op">)</span></span>
<span><span class="co">## ----------------------------------------------------------------- </span></span>
<span><span class="co">## Dimension reduction for model-based clustering and classification </span></span>
<span><span class="co">## ----------------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixture model type: Mclust (VEV, 3) </span></span>
<span><span class="co">##         </span></span>
<span><span class="co">## Clusters  n</span></span>
<span><span class="co">##        1 50</span></span>
<span><span class="co">##        2 45</span></span>
<span><span class="co">##        3 55</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated basis vectors: </span></span>
<span><span class="co">##                  Dir1      Dir2     Dir3     Dir4</span></span>
<span><span class="co">## Sepal.Length  0.14546 -0.220270  0.65191 -0.43651</span></span>
<span><span class="co">## Sepal.Width   0.52097  0.097857  0.25527  0.57873</span></span>
<span><span class="co">## Petal.Length -0.62095 -0.293850 -0.44704  0.46137</span></span>
<span><span class="co">## Petal.Width  -0.56732  0.924963  0.55678 -0.51153</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 Dir1     Dir2      Dir3       Dir4</span></span>
<span><span class="co">## Eigenvalues  0.94861  0.62354  0.074295   0.032765</span></span>
<span><span class="co">## Cum. %      56.49126 93.62436 98.048774 100.000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The basis vectors spanning the reduced subspace are available through the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method for <code>MclustDR()</code>. These basis vectors are expressed as linear combinations of the original features, ordered by importance via the associated generalized eigenvalues <a href="#eq-GMMDR_eigen" class="quarto-xref">Equation&nbsp;<span>6.5</span></a>. In this case the first two directions account for most of the clustering structure. A plot of the eigenvalues, shown in <a href="#fig-irisdr3" class="quarto-xref">Figure&nbsp;<span>6.9</span></a>, is obtained with the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">drmod</span>, what <span class="op">=</span> <span class="st">"evalues"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-irisdr3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-irisdr3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisdr3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-irisdr3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.9: Plot of generalized eigenvalues from <code>MclustDR()</code> and the corresponding contributions from means and variances for the 3-group model-based clustering of the <code>iris</code> dataset.
</figcaption></figure>
</div>
</div>
</div>
<p>According to the previous discussion on the contributions to the generalized eigenvalues, we would expect to see a separation among the groups along the first two directions only, with the first associated with differences in location, and the second associated with differences in spread. This is confirmed by a scatterplot matrix of data projected onto the estimated subspace (see <a href="#fig-irisdr4" class="quarto-xref">Figure&nbsp;<span>6.10</span></a>) obtained as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">drmod</span>, what <span class="op">=</span> <span class="st">"pairs"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-irisdr4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-irisdr4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisdr4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-irisdr4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.10: The <code>iris</code> data projected onto the principal eigenvectors from <code>MclustDR()</code>. The colors and symbols correspond to the 3-group model-based clustering.
</figcaption></figure>
</div>
</div>
</div>
<p>As already mentioned, the last two directions appear negligible in this example. This may be further investigated by applying the greedy subset selection step proposed in <span class="citation" data-cites="Scrucca:2010">Scrucca (<a href="99_references.html#ref-Scrucca:2010" role="doc-biblioref">2010, sec. 3</a>)</span> that applies the subset selection method of <span class="citation" data-cites="Raftery:Dean:2006">Raftery and Dean (<a href="99_references.html#ref-Raftery:Dean:2006" role="doc-biblioref">2006</a>)</span> to prune the subset of GMMDR features: <!-- \index{mclust!\code{MclustDRsubsel()}} --></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sdrmod</span> <span class="op">=</span> <span class="fu">MclustDRsubsel</span><span class="op">(</span><span class="va">drmod</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cycle 1 ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Variable Model G     BIC BIC.dif</span></span>
<span><span class="co">## 1     Dir1     E 3 -374.60 187.035</span></span>
<span><span class="co">## 2     Dir2   EEI 4 -315.66  45.242</span></span>
<span><span class="co">## 3     Dir3   VVE 3 -395.01  37.666</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cycle 2 ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Variable Model G     BIC BIC.dif</span></span>
<span><span class="co">## 1     Dir1     E 3 -354.64 186.167</span></span>
<span><span class="co">## 2     Dir2   VVI 3 -294.07  47.343</span></span>
<span><span class="co">## 3     Dir3   VVE 3 -389.47  21.632</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sdrmod</span><span class="op">)</span></span>
<span><span class="co">## ----------------------------------------------------------------- </span></span>
<span><span class="co">## Dimension reduction for model-based clustering and classification </span></span>
<span><span class="co">## ----------------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixture model type: Mclust (VVE, 3) </span></span>
<span><span class="co">##         </span></span>
<span><span class="co">## Clusters  n</span></span>
<span><span class="co">##        1 50</span></span>
<span><span class="co">##        2 49</span></span>
<span><span class="co">##        3 51</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated basis vectors: </span></span>
<span><span class="co">##                  Dir1     Dir2     Dir3</span></span>
<span><span class="co">## Sepal.Length  0.10835 -0.18789  0.71035</span></span>
<span><span class="co">## Sepal.Width   0.54164  0.10527  0.25902</span></span>
<span><span class="co">## Petal.Length -0.65930 -0.30454 -0.43979</span></span>
<span><span class="co">## Petal.Width  -0.51010  0.92783  0.48465</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 Dir1     Dir2      Dir3</span></span>
<span><span class="co">## Eigenvalues  0.94257  0.64868   0.03395</span></span>
<span><span class="co">## Cum. %      57.99696 97.91101 100.00000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The subset selection chooses three directions and essentially the first three previously obtained:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/zapsmall.html">zapsmall</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">drmod</span><span class="op">$</span><span class="va">dir</span>, <span class="va">sdrmod</span><span class="op">$</span><span class="va">dir</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">##         Dir1    Dir2    Dir3</span></span>
<span><span class="co">## Dir1 0.99975 0.00020 0.00006</span></span>
<span><span class="co">## Dir2 0.00021 0.99537 0.00443</span></span>
<span><span class="co">## Dir3 0.00004 0.00444 0.99552</span></span>
<span><span class="co">## Dir4 0.00000 0.00000 0.00000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the following plots, we use the default argument <code>dimens = c(1, 2)</code> to project onto the first two GMMDR directions, which are of most interest for visualizing the clustering structure:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sdrmod</span>, what <span class="op">=</span> <span class="st">"contour"</span>, nlevels <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sdrmod</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sdrmod</span>, what <span class="op">=</span> <span class="st">"boundaries"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first command draws a bivariate contour plot of the mixture component densities, the second command draws the classification boundaries based on the MAP principle, while the last command draws a scatterplot showing uncertainty boundaries (panels (a), (b), and (c) in <a href="#fig-irisdr5" class="quarto-xref">Figure&nbsp;<span>6.11</span></a>).</p>
<div id="fig-irisdr5" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-irisdr5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisdr5" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisdr5-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisdr5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisdr5-1.png" id="fig-irisdr5-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisdr5">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisdr5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisdr5" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisdr5-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisdr5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisdr5-2.png" id="fig-irisdr5-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisdr5">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisdr5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisdr5" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisdr5-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisdr5-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisdr5-3.png" id="fig-irisdr5-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisdr5">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisdr5-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-irisdr5" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-irisdr5-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-irisdr5-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-irisdr5-4.png" id="fig-irisdr5-4" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-irisdr5">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-irisdr5-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-irisdr5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.11: Contour plot of mixture densities for each cluster (a), classification regions (b), and uncertainty boundaries (c) drawn on the first two GMMDR directions of the projection subspace estimated with <code>MclustDRsubsel()</code> for the 3-group model-based clustering of the <code>iris</code> dataset. Panel (d) shows the conditional densities along the first GMMDR direction.
</figcaption></figure>
</div>
<p>We can also produce a plot of the densities conditional on the estimated cluster membership for the first GMMDR direction as follows (panel (d) in <a href="#fig-irisdr5" class="quarto-xref">Figure&nbsp;<span>6.11</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sdrmod</span>, what <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Other plots can be obtained via the argument <code>what</code>, and fine tuning for some parameters is also available; see <code>help("plot.MclustDR")</code> for a comprehensive list and examples.</p>
</div>
</section><section id="sec-classifdr" class="level3" data-number="6.4.3"><h3 data-number="6.4.3" class="anchored" data-anchor-id="sec-classifdr">
<span class="header-section-number">6.4.3</span> Projection Subspaces for Classification</h3>
<p>The approach discussed in the previous sections for clustering has been further extended to the case of supervised classification <span class="citation" data-cites="Scrucca:2014">(<a href="99_references.html#ref-Scrucca:2014" role="doc-biblioref">Scrucca 2014</a>)</span>. In this scenario, the fact that classes are known and that they can be made up of one or more mixture components must be taken into account.</p>
<div id="exm-banknote" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.9</strong></span> &nbsp;&nbsp;<strong>Visualizing Swiss banknote classification</strong></p>
<p>The <code>banknote</code> dataset containing six physical measurements of a sample of Swiss Franc bills is given in Tables 1.1 and 1.2 of <span class="citation" data-cites="Flury:Riedwyl:1988">Bernhard Flury and Riedwyl (<a href="99_references.html#ref-Flury:Riedwyl:1988" role="doc-biblioref">1988</a>)</span>. One hundred banknotes were classified as genuine and 100 as counterfeits.</p>
<p>We fit a <code>MclustDA()</code> classification model to this data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"banknote"</span>, package <span class="op">=</span> <span class="st">"mclust"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu">MclustDA</span><span class="op">(</span>data <span class="op">=</span> <span class="va">banknote</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, class <span class="op">=</span> <span class="va">banknote</span><span class="op">$</span><span class="va">Status</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------ </span></span>
<span><span class="co">## Gaussian finite mixture model for classification </span></span>
<span><span class="co">## ------------------------------------------------ </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MclustDA model summary: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  log-likelihood   n df     BIC</span></span>
<span><span class="co">##         -646.08 200 67 -1647.1</span></span>
<span><span class="co">##              </span></span>
<span><span class="co">## Classes         n  % Model G</span></span>
<span><span class="co">##   counterfeit 100 50   EVE 2</span></span>
<span><span class="co">##   genuine     100 50   XXX 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Training confusion matrix:</span></span>
<span><span class="co">##              Predicted</span></span>
<span><span class="co">## Class         counterfeit genuine</span></span>
<span><span class="co">##   counterfeit         100       0</span></span>
<span><span class="co">##   genuine               0     100</span></span>
<span><span class="co">## Classification error = 0 </span></span>
<span><span class="co">## Brier score          = 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then apply <code>MclustDR()</code> to obtain a projection subspace:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">drmod</span> <span class="op">=</span> <span class="fu">MclustDR</span><span class="op">(</span><span class="va">mod</span>, lambda <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">drmod</span><span class="op">)</span></span>
<span><span class="co">## ----------------------------------------------------------------- </span></span>
<span><span class="co">## Dimension reduction for model-based clustering and classification </span></span>
<span><span class="co">## ----------------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixture model type: MclustDA </span></span>
<span><span class="co">##              </span></span>
<span><span class="co">## Classes         n Model G</span></span>
<span><span class="co">##   counterfeit 100   EVE 2</span></span>
<span><span class="co">##   genuine     100   XXX 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated basis vectors: </span></span>
<span><span class="co">##              Dir1      Dir2      Dir3      Dir4       Dir5      Dir6</span></span>
<span><span class="co">## Length   -0.10139 -0.328225 -0.797068  0.033629 -0.3174275  0.085062</span></span>
<span><span class="co">## Left     -0.21718 -0.305014  0.303111  0.893349  0.3700659 -0.565410</span></span>
<span><span class="co">## Right     0.29222 -0.018401  0.495891 -0.407413 -0.8612986  0.480799</span></span>
<span><span class="co">## Bottom    0.57591  0.445352 -0.120173  0.034595  0.0043174 -0.078640</span></span>
<span><span class="co">## Top       0.57542  0.385535 -0.100865  0.103623  0.1359128  0.625902</span></span>
<span><span class="co">## Diagonal -0.44089  0.672250  0.047784  0.151252 -0.0443255  0.209691</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 Dir1     Dir2     Dir3     Dir4      Dir5       Dir6</span></span>
<span><span class="co">## Eigenvalues  0.87242  0.55373  0.48546  0.13291  0.053075   0.027273</span></span>
<span><span class="co">## Cum. %      41.05755 67.11689 89.96377 96.21866 98.716489 100.000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A plot of the generalized eigenvalues associated with the estimated directions is obtained using:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">drmod</span>, what <span class="op">=</span> <span class="st">"evalues"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-banknote1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-banknote1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-banknote1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-banknote1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.12: Plot of generalized eigenvalues from <code>MclustDR()</code> applied to a classification model for the <code>banknote</code> data.
</figcaption></figure>
</div>
</div>
</div>
<p>The graph in <a href="#fig-banknote1" class="quarto-xref">Figure&nbsp;<span>6.12</span></a> suggests that the first two directions mainly contain information on class separation, with the remaining dimensions showing differences in variances.</p>
<p>A pairs plot of the data points projected along these directions seems to suggest that a further reduction could be achieved by selecting a subset of them (see <a href="#fig-banknote2" class="quarto-xref">Figure&nbsp;<span>6.13</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">drmod</span>, what <span class="op">=</span> <span class="st">"pairs"</span>, lower.panel <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">clPairsLegend</span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.4</span>, class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">drmod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span>, </span>
<span>              col <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>              pch <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotSymbols"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>              title <span class="op">=</span> <span class="st">"Swiss banknote data"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-banknote2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-banknote2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-banknote2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-banknote2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.13: Pairs plot of points projected onto the directions estimated with <code>MclustDR()</code> for the <code>banknote</code> dataset.
</figcaption></figure>
</div>
</div>
</div>
<p>This option can be investigated by applying the subset selection procedure described in <span class="citation" data-cites="Scrucca:2010">Scrucca (<a href="99_references.html#ref-Scrucca:2010" role="doc-biblioref">2010</a>)</span> with the code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sdrmod</span> <span class="op">=</span> <span class="fu">MclustDRsubsel</span><span class="op">(</span><span class="va">drmod</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cycle 1 ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Variable   Model   G     BIC BIC.dif</span></span>
<span><span class="co">## 1     Dir1     E|X 2|1 -527.10  206.74</span></span>
<span><span class="co">## 2     Dir2 EEE|XXX 2|1 -667.69  192.65</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cycle 2 ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Variable   Model   G     BIC BIC.dif</span></span>
<span><span class="co">## 1     Dir1     E|X 2|1 -528.93  204.88</span></span>
<span><span class="co">## 2     Dir2 EEE|XXX 2|1 -667.66  194.51</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sdrmod</span><span class="op">)</span></span>
<span><span class="co">## ----------------------------------------------------------------- </span></span>
<span><span class="co">## Dimension reduction for model-based clustering and classification </span></span>
<span><span class="co">## ----------------------------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixture model type: MclustDA </span></span>
<span><span class="co">##              </span></span>
<span><span class="co">## Classes         n Model G</span></span>
<span><span class="co">##   counterfeit 100   EEE 2</span></span>
<span><span class="co">##   genuine     100   XXX 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated basis vectors: </span></span>
<span><span class="co">##              Dir1      Dir2</span></span>
<span><span class="co">## Length   -0.10552 -0.328204</span></span>
<span><span class="co">## Left     -0.22054 -0.304765</span></span>
<span><span class="co">## Right     0.29083 -0.018957</span></span>
<span><span class="co">## Bottom    0.57981  0.444505</span></span>
<span><span class="co">## Top       0.57850  0.384658</span></span>
<span><span class="co">## Diagonal -0.42989  0.673420</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 Dir1      Dir2</span></span>
<span><span class="co">## Eigenvalues  0.85929   0.53687</span></span>
<span><span class="co">## Cum. %      61.54666 100.00000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The subset selection procedure identifies only two directions as being important, essentially the first two directions previously obtained:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/zapsmall.html">zapsmall</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">drmod</span><span class="op">$</span><span class="va">dir</span>, <span class="va">sdrmod</span><span class="op">$</span><span class="va">dir</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">##         Dir1    Dir2</span></span>
<span><span class="co">## Dir1 0.99997 0.00003</span></span>
<span><span class="co">## Dir2 0.00003 0.99997</span></span>
<span><span class="co">## Dir3 0.00000 0.00000</span></span>
<span><span class="co">## Dir4 0.00000 0.00000</span></span>
<span><span class="co">## Dir5 0.00000 0.00000</span></span>
<span><span class="co">## Dir6 0.00000 0.00000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Summary plots can then be obtained on the 2-dimensional estimated subspace as follows:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sdrmod</span>, what <span class="op">=</span> <span class="st">"contour"</span>, nlevels <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sdrmod</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-banknote3" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-banknote3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-banknote3" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-banknote3-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-banknote3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-banknote3-1.png" id="fig-banknote3-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-banknote3">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-banknote3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-banknote3" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-banknote3-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-banknote3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-banknote3-2.png" id="fig-banknote3-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-banknote3">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-banknote3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-banknote3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.14: Contour plot of mixture densities for each class (a) and MAP classification regions (b) drawn on the projection subspace estimated with <code>MclustDRsubsel()</code> for the <code>banknote</code> dataset.
</figcaption></figure>
</div>
<p>These plots show, respectively, a contour plot of the mixture component densities for each class, and the classification regions based on the MAP principle (see <a href="#fig-banknote3" class="quarto-xref">Figure&nbsp;<span>6.14</span></a>). The group of counterfeit banknotes is clearly composed of two distinct subgroups, whereas the genuine banknotes appear as a homogeneous group with the presence of an outlying note.</p>
</div>
</section><section id="relationship-to-other-methods" class="level3" data-number="6.4.4"><h3 data-number="6.4.4" class="anchored" data-anchor-id="relationship-to-other-methods">
<span class="header-section-number">6.4.4</span> Relationship to Other Methods</h3>
<p>Approaches analogous to projection subspaces have been proposed for the cases of finite mixtures of multivariate <span class="math inline">\(t\)</span> distributions <span class="citation" data-cites="Morris:McNicholas:Scrucca:2013">(<a href="99_references.html#ref-Morris:McNicholas:Scrucca:2013" role="doc-biblioref">Morris, McNicholas, and Scrucca 2013</a>)</span>, mixtures of shifted asymmetric Laplace distributions <span class="citation" data-cites="Morris:McNicholas:2013">(<a href="99_references.html#ref-Morris:McNicholas:2013" role="doc-biblioref">Morris and McNicholas 2013</a>)</span>, and generalized hyperbolic mixtures <span class="citation" data-cites="Morris:McNicholas:2016">(<a href="99_references.html#ref-Morris:McNicholas:2016" role="doc-biblioref">Morris and McNicholas 2016</a>)</span>.</p>
<p>The <code>MclustDR()</code> directions, obtained using the generalized eigen-decompositions discussed in <a href="#sec-clustsep" class="quarto-xref"><span>Section 6.4.1</span></a> and in <a href="#sec-varcov" class="quarto-xref"><span>Section 6.4.2</span></a> for the specific case <span class="math inline">\(\lambda = 1\)</span> in <a href="#eq-GMMDR_eigen" class="quarto-xref">Equation&nbsp;<span>6.5</span></a>, are essentially equivalent to the discriminant coordinates or crimcoords described in <a href="#sec-crimcoords" class="quarto-xref"><span>Section 6.3.3</span></a> for GMMs with one mixture component per group. Within <strong>mclust</strong>, this applies to <code>Mclust()</code> clustering models, <code>EDDA</code> classification models, and <code>MclustDA</code> classification models with one component (but possibly different covariance structures) per class.</p>
</section></section><section id="using-ggplot2-with-mclust" class="level2" data-number="6.5"><h2 data-number="6.5" class="anchored" data-anchor-id="using-ggplot2-with-mclust">
<span class="header-section-number">6.5</span> Using ggplot2 with mclust</h2>
<p>All of the plots produced by <strong>mclust</strong> and discussed so far use the base plotting system in R. There are historical reasons for this, but it also helps achieve one of the main goals of the package, namely to provide simple, fast, accurate, and nice-looking plots without introducing further dependencies on other packages.</p>
<p><strong>ggplot2</strong> <!-- \index{ggplot2} --> is a popular R package for data visualization based on the <em>Grammar of Graphics</em> <span class="citation" data-cites="Wilkinson:2005">(<a href="99_references.html#ref-Wilkinson:2005" role="doc-biblioref">Wilkinson 2005</a>)</span>. The <strong>ggplot2</strong> package facilitates creation of production-quality statistical graphics. For a comprehensive introduction, see <span class="citation" data-cites="Wickham:2016">Wickham (<a href="99_references.html#ref-Wickham:2016" role="doc-biblioref">2016</a>)</span>. Experienced R users can easily produce <strong>ggplot2</strong> plots using the information contained in the objects returned by <strong>mclust</strong> functions, by collecting them in a data frame and then (gg)plotting them using a suitable plot</p>
<div id="exm-iris_cluster" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.10</strong></span> &nbsp;&nbsp;<strong>ggplot2 graphs of Old Faithful data clustering</strong></p>
<p>As a first example, consider the following code which produces the usual classification plot (see <a href="#fig-ggplot_faithful" class="quarto-xref">Figure&nbsp;<span>6.15</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span><span class="va">DF</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">data</span>, cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">DF</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">eruptions</span>, y <span class="op">=</span> <span class="va">waiting</span>, </span>
<span>               colour <span class="op">=</span> <span class="va">cluster</span>, shape <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggplot_faithful" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ggplot_faithful-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ggplot_faithful-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot_faithful-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.15: Scatterplot of the <code>faithful</code> data with points marked according to the GMM clusters identified by <code>Mclust</code>.
</figcaption></figure>
</div>
</div>
</div>
<p>A more complex example involves plotting the table of BIC values (see <a href="#fig-ggplot_faithful_bic" class="quarto-xref">Figure&nbsp;<span>6.16</span></a>). In this case, we need to convert the object into a <code>data.frame</code> (or a <code>tibble</code> in <em>tidyverse</em> — see <span class="citation" data-cites="Wickham&amp;tidyverse2019">Wickham et al. (<a href="99_references.html#ref-Wickham&amp;tidyverse2019" role="doc-biblioref">2019</a>)</span>) by reshaping it from the “wide” to the “long” format. The latter step can be accomplished in several ways; here, we use the <strong>tidyr</strong> R package <span class="citation" data-cites="Rpkg:tidyr">(<a href="99_references.html#ref-Rpkg:tidyr" role="doc-biblioref">Wickham and Henry 2022</a>)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyr.tidyverse.org">"tidyr"</a></span><span class="op">)</span></span>
<span><span class="va">DF</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">BIC</span><span class="op">[</span><span class="op">]</span>, G <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">DF</span> <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">DF</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">14</span>, names_to <span class="op">=</span> <span class="st">"Model"</span>, values_to <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span>
<span><span class="va">DF</span><span class="op">$</span><span class="va">Model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">Model</span>, levels <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"emModelNames"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">DF</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">G</span>, y <span class="op">=</span> <span class="va">BIC</span>, colour <span class="op">=</span> <span class="va">Model</span>, shape <span class="op">=</span> <span class="va">Model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"bicPlotSymbols"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"bicPlotColors"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">G</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Number of mixture components"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggplot_faithful_bic" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ggplot_faithful_bic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ggplot_faithful_bic-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot_faithful_bic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.16: BIC traces for the GMMs estimated for the <code>faithful</code> data.
</figcaption></figure>
</div>
</div>
</div>
<p>As another example, we may draw a <em>latent profiles plot</em> of estimated means for each variable by cluster membership. Consider the following clustering model for the <code>iris</code> data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, G <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A latent profiles plot can be obtained by extracting the component means, reshaping it in a “long” format, and then drawing the desired plot shown in <a href="#fig-ggplot_iris_latent_profile" class="quarto-xref">Figure&nbsp;<span>6.17</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">means</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Profile <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">mod</span><span class="op">$</span><span class="va">G</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">means</span> <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">means</span>, cols <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, </span>
<span>                      names_to <span class="op">=</span> <span class="st">"Variable"</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">"Mean"</span><span class="op">)</span></span>
<span><span class="va">means</span><span class="op">$</span><span class="va">Profile</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">means</span><span class="op">$</span><span class="va">Profile</span><span class="op">)</span></span>
<span><span class="va">means</span><span class="op">$</span><span class="va">Variable</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">means</span><span class="op">$</span><span class="va">Variable</span>, </span>
<span>                         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">means</span></span>
<span><span class="co">## # A tibble: 12 × 3</span></span>
<span><span class="co">##    Profile Variable      Mean</span></span>
<span><span class="co">##    &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">##  1 1       Sepal.Length 5.01 </span></span>
<span><span class="co">##  2 1       Sepal.Width  3.43 </span></span>
<span><span class="co">##  3 1       Petal.Length 1.46 </span></span>
<span><span class="co">##  4 1       Petal.Width  0.246</span></span>
<span><span class="co">##  5 2       Sepal.Length 5.92 </span></span>
<span><span class="co">##  6 2       Sepal.Width  2.78 </span></span>
<span><span class="co">##  7 2       Petal.Length 4.20 </span></span>
<span><span class="co">##  8 2       Petal.Width  1.30 </span></span>
<span><span class="co">##  9 3       Sepal.Length 6.55 </span></span>
<span><span class="co">## 10 3       Sepal.Width  2.95 </span></span>
<span><span class="co">## 11 3       Petal.Length 5.48 </span></span>
<span><span class="co">## 12 3       Petal.Width  1.99</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">means</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Variable</span>, <span class="va">Mean</span>, group <span class="op">=</span> <span class="va">Profile</span>, </span>
<span>                  shape <span class="op">=</span> <span class="va">Profile</span>, color <span class="op">=</span> <span class="va">Profile</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Latent profiles means"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggplot_iris_latent_profile" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ggplot_iris_latent_profile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ggplot_iris_latent_profile-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot_iris_latent_profile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.17: Latent profiles plot for the (<code>VEV</code>,3) model estimated for the <code>iris</code> data.
</figcaption></figure>
</div>
</div>
</div>
<p>Note that for a plot like the one in <a href="#fig-ggplot_iris_latent_profile" class="quarto-xref">Figure&nbsp;<span>6.17</span></a> to make sense, all variables must be expressed in the same unit of measurement (as in the example above), or else they must be scaled to a common unit, for instance by a preliminary standardization. Ordering of variables along the <span class="math inline">\(x\)</span>-axis is arbitrary, so a user must carefully choose the most appropriate order for the data under study.</p>
</div>
<div id="exm-iris_classif" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.11</strong></span> &nbsp;&nbsp;<strong>ggplot2 graphs of iris data classification</strong></p>
<p>The plotting facilities of <strong>ggplot2</strong> can be used with any <strong>mclust</strong> model. For instance, the following code estimates a classification model for the <code>iris</code> data, extracts the first two GMMDR directions using the methodology described in <a href="#sec-displaydr" class="quarto-xref"><span>Section 6.4</span></a>, and then produces a two-dimensional scatterplot with added convex hulls for the various iris classes:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">damod</span> <span class="op">=</span> <span class="fu">MclustDA</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span><span class="va">drmod</span> <span class="op">=</span> <span class="fu">MclustDR</span><span class="op">(</span><span class="va">damod</span><span class="op">)</span></span>
<span><span class="va">DF1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">drmod</span><span class="op">$</span><span class="va">dir</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, class <span class="op">=</span> <span class="va">damod</span><span class="op">$</span><span class="va">class</span><span class="op">)</span></span>
<span><span class="va">DF2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span><span class="op">(</span><span class="va">DF1</span>, <span class="va">DF1</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, </span>
<span>                           <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DF1</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dir1</span>, y <span class="op">=</span> <span class="va">Dir2</span>, color <span class="op">=</span> <span class="va">class</span>, shape <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DF2</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dir1</span>, y <span class="op">=</span> <span class="va">Dir2</span>, fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span>, </span>
<span>               alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotSymbols"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggplot_iris_chull" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ggplot_iris_chull-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ggplot_iris_chull-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot_iris_chull-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.18: Scatterplot of the first two GMMDR directions with added convex hulls for the <code>iris</code> data classes.
</figcaption></figure>
</div>
</div>
</div>
<p>The resulting plot is shown in <a href="#fig-ggplot_iris_chull" class="quarto-xref">Figure&nbsp;<span>6.18</span></a>. Notice that in the code above we created two different data frames, one used for plotting points and one containing the vertices of the convex hull, the latter computed using the <code><a href="https://rdrr.io/r/grDevices/chull.html">chull()</a></code> function in base R.</p>
</div>
<div id="exm-iris_dens" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.12</strong></span> &nbsp;&nbsp;<strong>ggplot2 graph of density estimate of the waiting time from the Old Faithful data</strong></p>
<p>Now consider the case of plotting a univariate density estimate obtained via <code>densityMclust()</code>. The following code draws a histogram of waiting times from the <code>faithful</code> data frame, then adds the estimated density. The latter is obtained by first creating a data frame <code>x</code> of equispaced grid points and the corresponding densities computed using the <code>predict</code> method associated with the <code>densityMclust</code> object. The resulting data frame is then used in <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> to draw the density estimate.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">densityMclust</span><span class="op">(</span><span class="va">faithful</span><span class="op">$</span><span class="va">waiting</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/extendrange.html">extendrange</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">$</span><span class="va">waiting</span>, f <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span>, newdata <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">waiting</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">15</span>, </span>
<span>                 fill <span class="op">=</span> <span class="st">"slategray3"</span>, colour <span class="op">=</span> <span class="st">"grey92"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pred</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">density</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggplot_faithful_density" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ggplot_faithful_density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ggplot_faithful_density-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot_faithful_density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.19: Plot of histogram and density estimated by <code>densityMclust()</code> for the waiting time of the <code>faithful</code> data.
</figcaption></figure>
</div>
</div>
</div>
</div>
<div id="exm-hemophilia_boot" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.13</strong></span> &nbsp;&nbsp;<strong>ggplot2 graphs of bootstrap distributions for the hemophilia data</strong></p>
<p>A final example involves “faceting”, an efficient technique for presenting information in panels conditioning on one or more variables. Consider the bootstrap procedure discussed in <a href="03_cluster.html#exm-hemophilia" class="quarto-xref">Example&nbsp;<span>3.7</span></a>, where the <code>MclustBootstrap()</code> function is applied to the two-component <code>VVV</code> model for the hemophilia data from the <strong>rrcov</strong> package <span class="citation" data-cites="Rpkg:rrcov">(<a href="99_references.html#ref-Rpkg:rrcov" role="doc-biblioref">Todorov 2022</a>)</span>. Using the information returned and stored in <code>boot</code>, a <strong>ggplot2</strong> plot of the bootstrap distribution for the mixing proportions can be obtained as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"hemophilia"</span>, package <span class="op">=</span> <span class="st">"rrcov"</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="va">hemophilia</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">X</span>, G <span class="op">=</span> <span class="fl">2</span>, modelName <span class="op">=</span> <span class="st">"VVV"</span><span class="op">)</span></span>
<span><span class="va">boot</span> <span class="op">=</span> <span class="fu">MclustBootstrap</span><span class="op">(</span><span class="va">mod</span>, nboot <span class="op">=</span> <span class="fl">999</span>, type <span class="op">=</span> <span class="st">"bs"</span><span class="op">)</span></span>
<span><span class="va">DF</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>mixcomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">boot</span><span class="op">$</span><span class="va">G</span>, each <span class="op">=</span> <span class="va">boot</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>, </span>
<span>                pro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">boot</span><span class="op">$</span><span class="va">pro</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">DF</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pro</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">15</span>, </span>
<span>                 fill <span class="op">=</span> <span class="st">"slategray3"</span>, colour <span class="op">=</span> <span class="st">"grey92"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">mixcomp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Mixing proportions"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Density of bootstrap distribution"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggplot_hemophilia_boot1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ggplot_hemophilia_boot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ggplot_hemophilia_boot1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot_hemophilia_boot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.20: Bootstrap distribution for the mixture proportions of (<code>VVV</code>,2) model fitted to the <code>hemophilia</code> data.
</figcaption></figure>
</div>
</div>
</div>
<p>The resulting graph is shown in <a href="#fig-ggplot_hemophilia_boot1" class="quarto-xref">Figure&nbsp;<span>6.20</span></a>. Note that the code above uses <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code> to obtain a panel for each of the bootstrap distributions.</p>
<p>The same function can also be used for conditioning on more than one variable. For instance, the following code produces <a href="#fig-ggplot_hemophilia_boot2" class="quarto-xref">Figure&nbsp;<span>6.21</span></a> showing the bootstrap distribution conditioning on both the mixture components (along the rows) and the variables (along the columns):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DF</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"mixcomp"</span>  <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             <span class="st">"variable"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">boot</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                              each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">boot</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>             <span class="st">"mean"</span>     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">boot</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"mixcomp"</span>  <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             <span class="st">"variable"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">boot</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span>, , <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                              each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">boot</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>             <span class="st">"mean"</span>     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">boot</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span>, , <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">DF</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                  fill <span class="op">=</span> <span class="st">"slategray3"</span>, colour <span class="op">=</span> <span class="st">"grey92"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">mixcomp</span> <span class="op">~</span> <span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Means of mixture"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Density of bootstrap distribution"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggplot_hemophilia_boot2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ggplot_hemophilia_boot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-ggplot_hemophilia_boot2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot_hemophilia_boot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.21: Bootstrap distribution for the mixture component means of (<code>VVV</code>,2) model fitted to the <code>hemophilia</code> data.
</figcaption></figure>
</div>
</div>
</div>
<p>As there are a great many possible options for customizing plots (such as themes and aesthetics), each user may want to experiment to get a suitable plot.</p>
</div>
</section><section id="sec-colorblind" class="level2" data-number="6.6"><h2 data-number="6.6" class="anchored" data-anchor-id="sec-colorblind">
<span class="header-section-number">6.6</span> Using Color-Blind-Friendly Palettes</h2>
<p>Most of the plots produced by <strong>mclust</strong> use colors that by default are defined by the following options:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mclust.options</span><span class="op">(</span><span class="st">"bicPlotColors"</span><span class="op">)</span></span>
<span><span class="co">##       EII       VII       EEI       EVI       VEI       VVI       EEE </span></span>
<span><span class="co">##    "gray"   "black" "#218B21" "#41884F" "#508476" "#58819C" "#597DC3" </span></span>
<span><span class="co">##       VEE       EVE       VVE       EEV       VEV       EVV       VVV </span></span>
<span><span class="co">## "#5178EA" "#716EE7" "#9B60B8" "#B2508B" "#C03F60" "#C82A36" "#CC0000" </span></span>
<span><span class="co">##         E         V </span></span>
<span><span class="co">##    "gray"   "black"</span></span>
<span><span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span></span>
<span><span class="co">##  [1] "dodgerblue2"    "red3"           "green3"         "slateblue"     </span></span>
<span><span class="co">##  [5] "darkorange"     "skyblue1"       "violetred4"     "forestgreen"   </span></span>
<span><span class="co">##  [9] "steelblue4"     "slategrey"      "brown"          "black"         </span></span>
<span><span class="co">## [13] "darkseagreen"   "darkgoldenrod3" "olivedrab"      "royalblue"     </span></span>
<span><span class="co">## [17] "tomato4"        "cyan2"          "springgreen2"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first option controls the colors to be used for plotting the BIC, ICL, and similar curves, whereas the second option is used to assign colors associated with clusters or classes when plotting data. These colors have been chosen to facilitate visual interpretation of the plots. However, for color-blind individuals, plots with these default colors may be problematic.</p>
<p>Starting with R version 4.0, the function <code><a href="https://rdrr.io/r/grDevices/palette.html">palette.colors()</a></code> can be used for retrieving colors from some pre-defined palettes. <!-- \index{using color-blind-friendly palette} --> For instance</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette.colors</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Okabe-Ito"</span><span class="op">)</span></span>
<span><span class="co">## [1] "#000000" "#E69F00" "#56B4E9" "#009E73" "#F0E442" "#0072B2"</span></span>
<span><span class="co">## [7] "#D55E00" "#CC79A7" "#999999"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>returns a color-blind-friendly palette proposed by <span class="citation" data-cites="Okabe:Ito:2008">Okabe and Ito (<a href="99_references.html#ref-Okabe:Ito:2008" role="doc-biblioref">2008</a>)</span> for individuals suffering from protanopia or deuteranopia, the two most common forms of inherited color blindness; see also <span class="citation" data-cites="Wong:2011">Wong (<a href="99_references.html#ref-Wong:2011" role="doc-biblioref">2011</a>)</span>.</p>
<div id="exm-iris_color_blind" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.14</strong></span> &nbsp;&nbsp;<strong>Using color-blind-friendly palette in mclust for the iris data</strong></p>
<p>A palette suitable for color vision deficiencies can thus be defined and used as the default in <strong>mclust</strong> with the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get and save default palettes</span></span>
<span><span class="va">bicPlotColors</span> <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"bicPlotColors"</span><span class="op">)</span></span>
<span><span class="va">classPlotColors</span> <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span><span class="op">)</span></span>
<span><span class="co"># set Okabe-Ito palette for use in mclust</span></span>
<span><span class="va">bicPlotColors_Okabe_Ito</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette.colors</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Okabe-Ito"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">bicPlotColors_Okabe_Ito</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">bicPlotColors</span><span class="op">)</span></span>
<span><span class="va">classPlotColorsWong</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette.colors</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Okabe-Ito"</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">mclust.options</span><span class="op">(</span><span class="st">"bicPlotColors"</span> <span class="op">=</span> <span class="va">bicPlotColors_Okabe_Ito</span><span class="op">)</span></span>
<span><span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span> <span class="op">=</span> <span class="va">classPlotColorsWong</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All of the plots subsequently produced by <strong>mclust</strong> functions will use this palette. For instance, the following code produces the plots in <a href="#fig-cbPalette" class="quarto-xref">Figure&nbsp;<span>6.22</span></a>.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu">Mclust</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cbPalette" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-cbPalette-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cbPalette" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cbPalette-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-cbPalette-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-cbPalette-1.png" id="fig-cbPalette-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-cbPalette">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cbPalette-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cbPalette" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cbPalette-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="100%">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-cbPalette-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/fig-cbPalette-2.png" id="fig-cbPalette-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:100.0%" data-ref-parent="fig-cbPalette">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cbPalette-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cbPalette-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.22: <strong>mclust</strong> plots with a color-blind-friendly palette.
</figcaption></figure>
</div>
<p>To restore the default <strong>mclust</strong> palettes use:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mclust.options</span><span class="op">(</span><span class="st">"bicPlotColors"</span> <span class="op">=</span> <span class="va">bicPlotColors</span><span class="op">)</span></span>
<span><span class="fu">mclust.options</span><span class="op">(</span><span class="st">"classPlotColors"</span> <span class="op">=</span> <span class="va">classPlotColors</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>For more advanced treatment of color issues, the package <strong>colorspace</strong> <span class="citation" data-cites="Zeileis:etal:2020 Rpkg:colorspace">(<a href="99_references.html#ref-Zeileis:etal:2020" role="doc-biblioref">Zeileis et al. 2020</a>; <a href="99_references.html#ref-Rpkg:colorspace" role="doc-biblioref">Ihaka et al. 2022</a>)</span> is available for manipulating and assessing colors and palettes in R.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Anderson:Olkin:Underhill:1987" class="csl-entry" role="listitem">
Anderson, T. W., I. Olkin, and L. G. Underhill. 1987. <span>“Generation of Random Orthogonal Matrices.”</span> <em>SIAM Journal on Scientific and Statistical Computing</em> 8 (4): 625–29.
</div>
<div id="ref-UCI:dataset" class="csl-entry" role="listitem">
Dua, Dheeru, and Casey Graff. 2017. <span>“<span>UCI</span> <span>Machine</span> <span>Learning</span> <span>Repository</span>.”</span> University of California, Irvine, School of Information; Computer Sciences. <a href="http://archive.ics.uci.edu/ml">http://archive.ics.uci.edu/ml</a>.
</div>
<div id="ref-Flury:1997" class="csl-entry" role="listitem">
Flury, Bernard. 1997. <em>A First Course in Multivariate Statistics</em>. New York: Springer.
</div>
<div id="ref-Flury:Riedwyl:1988" class="csl-entry" role="listitem">
Flury, Bernhard, and Hans Riedwyl. 1988. <em>Multivariate Statistics: A Practical Approach</em>. Chapman &amp; Hall Ltd.
</div>
<div id="ref-Gnanadesikan:1977" class="csl-entry" role="listitem">
Gnanadesikan, R. 1977. <em>Methods for Statistical Data Analysis of Multivariate Observations</em>. New York: John Wiley &amp; Sons.
</div>
<div id="ref-Heiberger:1978" class="csl-entry" role="listitem">
Heiberger, Richard M. 1978. <span>“Algorithm <span>AS</span> 127: Generation of Random Orthogonal Matrices.”</span> <em>Journal of the Royal Statistical Society. Series C (Applied Statistics)</em> 27 (2): 199–206.
</div>
<div id="ref-Rpkg:gclus" class="csl-entry" role="listitem">
Hurley, Catherine. 2019. <em><span class="nocase">gclus</span>: Clustering Graphics</em>. <a href="https://CRAN.R-project.org/package=gclus">https://CRAN.R-project.org/package=gclus</a>.
</div>
<div id="ref-Rpkg:colorspace" class="csl-entry" role="listitem">
Ihaka, Ross, Paul Murrell, Kurt Hornik, Jason C. Fisher, Reto Stauffer, Claus O. Wilke, Claire D. McWhite, and Achim Zeileis. 2022. <em>Colorspace: A Toolbox for Manipulating and Assessing Colors and Palettes</em>. <a href="https://doi.org/10.18637/jss.v096.i01">https://doi.org/10.18637/jss.v096.i01</a>.
</div>
<div id="ref-Morris:McNicholas:2013" class="csl-entry" role="listitem">
Morris, Katherine, and Paul D. McNicholas. 2013. <span>“Dimension Reduction for Model-Based Clustering via Mixtures of Shifted Asymmetric <span>Laplace</span> Distributions.”</span> <em>Statistics &amp; Probability Letters</em> 83 (9): 2088–93. https://doi.org/<a href="http://dx.doi.org/10.1016/j.spl.2013.04.011">http://dx.doi.org/10.1016/j.spl.2013.04.011</a>.
</div>
<div id="ref-Morris:McNicholas:2016" class="csl-entry" role="listitem">
———. 2016. <span>“Clustering, Classification, Discriminant Analysis, and Dimension Reduction via Generalized Hyperbolic Mixtures.”</span> <em>Computational Statistics &amp; Data Analysis</em> 97: 133–50. https://doi.org/<a href="http://dx.doi.org/10.1016/j.csda.2015.10.008">http://dx.doi.org/10.1016/j.csda.2015.10.008</a>.
</div>
<div id="ref-Morris:McNicholas:Scrucca:2013" class="csl-entry" role="listitem">
Morris, Katherine, PaulD. McNicholas, and Luca Scrucca. 2013. <span>“Dimension Reduction for Model-Based Clustering via Mixtures of Multivariate t-Distributions.”</span> <em>Advances in Data Analysis and Classification</em> 7 (3): 321–38. <a href="https://doi.org/10.1007/s11634-013-0137-3">https://doi.org/10.1007/s11634-013-0137-3</a>.
</div>
<div id="ref-Okabe:Ito:2008" class="csl-entry" role="listitem">
Okabe, Masataka, and Kei Ito. 2008. <span>“Color Universal Design (<span>CUD</span>) - How to Make Figures and Presentations That Are Friendly to Colorblind People.”</span> <em>J* Fly: Data Depository for Drosophila Researchers</em>. <a href="https://jfly.uni-koeln.de/color/">https://jfly.uni-koeln.de/color/</a>.
</div>
<div id="ref-Raftery:Dean:2006" class="csl-entry" role="listitem">
Raftery, Adrian E., and N. Dean. 2006. <span>“Variable Selection for Model-Based Clustering.”</span> <em>Journal of the American Statistical Association</em> 101 (473): 168–78.
</div>
<div id="ref-Scrucca:2010" class="csl-entry" role="listitem">
Scrucca, Luca. 2010. <span>“Dimension Reduction for Model-Based Clustering.”</span> <em>Statistics and Computing</em> 20 (4): 471–84. <a href="https://doi.org/10.1007/s11222-009-9138-7">https://doi.org/10.1007/s11222-009-9138-7</a>.
</div>
<div id="ref-Scrucca:2014" class="csl-entry" role="listitem">
———. 2014. <span>“Graphical Tools for Model-Based Mixture Discriminant Analysis.”</span> <em>Advances in Data Analysis and Classification</em> 8 (2): 147–65. <a href="https://doi.org/10.1007/s11634-013-0147-1">https://doi.org/10.1007/s11634-013-0147-1</a>.
</div>
<div id="ref-Scrucca:Serafini:2019" class="csl-entry" role="listitem">
Scrucca, Luca, and Alessio Serafini. 2019. <span>“Projection Pursuit Based on <span>G</span>aussian Mixtures and Evolutionary Algorithms.”</span> <em>Journal of Computational and Graphical Statistics</em> 28 (4): 847–60. <a href="https://doi.org/10.1080/10618600.2019.1598871">https://doi.org/10.1080/10618600.2019.1598871</a>.
</div>
<div id="ref-Rpkg:rrcov" class="csl-entry" role="listitem">
Todorov, Valentin. 2022. <em><span class="nocase">rrcov</span>: Scalable Robust Estimators with High Breakdown Point</em>. <a href="https://CRAN.R-project.org/package=rrcov">https://CRAN.R-project.org/package=rrcov</a>.
</div>
<div id="ref-Wickham:2016" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. 2nd ed. New York: Springer-Verlag. <a href="http://ggplot2.org">http://ggplot2.org</a>.
</div>
<div id="ref-Wickham&amp;tidyverse2019" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain Francois, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-Rpkg:tidyr" class="csl-entry" role="listitem">
Wickham, Hadley, and Lionel Henry. 2022. <em><span class="nocase">tidyr</span>: Tidy Messy Data</em>. <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.
</div>
<div id="ref-Wilkinson:2005" class="csl-entry" role="listitem">
Wilkinson, Leland. 2005. <em>The Grammar of Graphics</em>. New York: Springer-Verlag. <a href="https://doi.org/10.1007/0-387-28695-0">https://doi.org/10.1007/0-387-28695-0</a>.
</div>
<div id="ref-Wong:2011" class="csl-entry" role="listitem">
Wong, Bang. 2011. <span>“Points of View: Color Blindness.”</span> <em>Nature Methods</em> 8 (441). <a href="https://doi.org/0.1038/nmeth.1618">https://doi.org/0.1038/nmeth.1618</a>.
</div>
<div id="ref-Zeileis:etal:2020" class="csl-entry" role="listitem">
Zeileis, Achim, Jason C. Fisher, Kurt Hornik, Ross Ihaka, Claire D. McWhite, Paul Murrell, Reto Stauffer, and Claus O. Wilke. 2020. <span>“<span class="nocase">colorspace</span>: A Toolbox for Manipulating and Assessing Colors and Palettes.”</span> <em>Journal of Statistical Software</em> 96 (1): 1–49. <a href="https://doi.org/10.18637/jss.v096.i01">https://doi.org/10.18637/jss.v096.i01</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/05_dens.html" class="pagination-link" aria-label="Model-Based Density Estimation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model-Based Density Estimation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/07_miscellanea.html" class="pagination-link" aria-label="Miscellanea">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Miscellanea</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Model-Based Clustering, Classification, and <br> Density Estimation Using mclust in R</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>